<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>KnowledgeFlowApp.java</title>
    <link rel="stylesheet" type="text/css" href="../../css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700" rel="stylesheet">
</head>
<body>

<div class="container">
    <div id="code_area" class="container_0">
<div>1&emsp;&emsp;/*</div>
<div>2&emsp;&emsp;&nbsp; *   This program is free software: you can redistribute it and/or modify</div>
<div>3&emsp;&emsp;&nbsp; *   it under the terms of the GNU General Public License as published by</div>
<div>4&emsp;&emsp;&nbsp; *   the Free Software Foundation, either version 3 of the License, or</div>
<div>5&emsp;&emsp;&nbsp; *   (at your option) any later version.</div>
<div>6&emsp;&emsp;&nbsp; *</div>
<div>7&emsp;&emsp;&nbsp; *   This program is distributed in the hope that it will be useful,</div>
<div>8&emsp;&emsp;&nbsp; *   but WITHOUT ANY WARRANTY; without even the implied warranty of</div>
<div>9&emsp;&emsp;&nbsp; *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</div>
<div>10&emsp;&emsp;&nbsp; *   GNU General Public License for more details.</div>
<div>11&emsp;&emsp;&nbsp; *</div>
<div>12&emsp;&emsp;&nbsp; *   You should have received a copy of the GNU General Public License</div>
<div>13&emsp;&emsp;&nbsp; *   along with this program.  If not, see &#60;http://www.gnu.org/licenses/>.</div>
<div>14&emsp;&emsp;&nbsp; */</div>
<div>15&emsp;&emsp;</div>
<div>16&emsp;&emsp;/*</div>
<div>17&emsp;&emsp;&nbsp; *    KnowledgeFlowApp.java</div>
<div>18&emsp;&emsp;&nbsp; *    Copyright (C) 2005-2012 University of Waikato, Hamilton, New Zealand</div>
<div>19&emsp;&emsp;&nbsp; *</div>
<div>20&emsp;&emsp;&nbsp; */</div>
<div>21&emsp;&emsp;</div>
<div>22&emsp;&emsp;package weka.gui.beans;</div>
<div>23&emsp;&emsp;</div>
<div>24&emsp;&emsp;import weka.core.Attribute;</div>
<div>25&emsp;&emsp;import weka.core.Copyright;</div>
<div>26&emsp;&emsp;import weka.core.Environment;</div>
<div>27&emsp;&emsp;import weka.core.EnvironmentHandler;</div>
<div>28&emsp;&emsp;import weka.core.Instances;</div>
<div>29&emsp;&emsp;import weka.core.Memory;</div>
<div>30&emsp;&emsp;import weka.core.PluginManager;</div>
<div>31&emsp;&emsp;import weka.core.SerializedObject;</div>
<div>32&emsp;&emsp;import weka.core.Utils;</div>
<div>33&emsp;&emsp;import weka.core.WekaEnumeration;</div>
<div>34&emsp;&emsp;import weka.core.WekaPackageClassLoaderManager;</div>
<div>35&emsp;&emsp;import weka.core.WekaPackageManager;</div>
<div>36&emsp;&emsp;import weka.core.converters.FileSourcedConverter;</div>
<div>37&emsp;&emsp;import weka.core.xml.KOML;</div>
<div>38&emsp;&emsp;import weka.core.xml.XStream;</div>
<div>39&emsp;&emsp;import weka.gui.AttributeSelectionPanel;</div>
<div>40&emsp;&emsp;import weka.gui.ExtensionFileFilter;</div>
<div>41&emsp;&emsp;import weka.gui.GenericObjectEditor;</div>
<div>42&emsp;&emsp;import weka.gui.GenericPropertiesCreator;</div>
<div>43&emsp;&emsp;import weka.gui.HierarchyPropertyParser;</div>
<div>44&emsp;&emsp;import weka.gui.LookAndFeel;</div>
<div>45&emsp;&emsp;import weka.gui.beans.xml.XMLBeans;</div>
<div>46&emsp;&emsp;import weka.gui.visualize.PrintablePanel;</div>
<div>47&emsp;&emsp;</div>
<div>48&emsp;&emsp;import javax.swing.AbstractAction;</div>
<div>49&emsp;&emsp;import javax.swing.AbstractButton;</div>
<div>50&emsp;&emsp;import javax.swing.Action;</div>
<div>51&emsp;&emsp;import javax.swing.BorderFactory;</div>
<div>52&emsp;&emsp;import javax.swing.ButtonGroup;</div>
<div>53&emsp;&emsp;import javax.swing.Icon;</div>
<div>54&emsp;&emsp;import javax.swing.ImageIcon;</div>
<div>55&emsp;&emsp;import javax.swing.JButton;</div>
<div>56&emsp;&emsp;import javax.swing.JCheckBox;</div>
<div>57&emsp;&emsp;import javax.swing.JComponent;</div>
<div>58&emsp;&emsp;import javax.swing.JDialog;</div>
<div>59&emsp;&emsp;import javax.swing.JFileChooser;</div>
<div>60&emsp;&emsp;import javax.swing.JFrame;</div>
<div>61&emsp;&emsp;import javax.swing.JLabel;</div>
<div>62&emsp;&emsp;import javax.swing.JOptionPane;</div>
<div>63&emsp;&emsp;import javax.swing.JPanel;</div>
<div>64&emsp;&emsp;import javax.swing.JScrollPane;</div>
<div>65&emsp;&emsp;import javax.swing.JSplitPane;</div>
<div>66&emsp;&emsp;import javax.swing.JTabbedPane;</div>
<div>67&emsp;&emsp;import javax.swing.JTextArea;</div>
<div>68&emsp;&emsp;import javax.swing.JTextField;</div>
<div>69&emsp;&emsp;import javax.swing.JToggleButton;</div>
<div>70&emsp;&emsp;import javax.swing.JToolBar;</div>
<div>71&emsp;&emsp;import javax.swing.JTree;</div>
<div>72&emsp;&emsp;import javax.swing.JWindow;</div>
<div>73&emsp;&emsp;import javax.swing.KeyStroke;</div>
<div>74&emsp;&emsp;import javax.swing.event.ChangeEvent;</div>
<div>75&emsp;&emsp;import javax.swing.event.ChangeListener;</div>
<div>76&emsp;&emsp;import javax.swing.filechooser.FileFilter;</div>
<div>77&emsp;&emsp;import javax.swing.plaf.basic.BasicButtonUI;</div>
<div>78&emsp;&emsp;import javax.swing.tree.DefaultMutableTreeNode;</div>
<div>79&emsp;&emsp;import javax.swing.tree.DefaultTreeCellRenderer;</div>
<div>80&emsp;&emsp;import javax.swing.tree.DefaultTreeModel;</div>
<div>81&emsp;&emsp;import javax.swing.tree.DefaultTreeSelectionModel;</div>
<div>82&emsp;&emsp;import javax.swing.tree.MutableTreeNode;</div>
<div>83&emsp;&emsp;import javax.swing.tree.TreeNode;</div>
<div>84&emsp;&emsp;import javax.swing.tree.TreePath;</div>
<div>85&emsp;&emsp;import javax.swing.tree.TreeSelectionModel;</div>
<div>86&emsp;&emsp;import java.awt.BasicStroke;</div>
<div>87&emsp;&emsp;import java.awt.BorderLayout;</div>
<div>88&emsp;&emsp;import java.awt.Color;</div>
<div>89&emsp;&emsp;import java.awt.Component;</div>
<div>90&emsp;&emsp;import java.awt.Cursor;</div>
<div>91&emsp;&emsp;import java.awt.Dialog.ModalityType;</div>
<div>92&emsp;&emsp;import java.awt.Dimension;</div>
<div>93&emsp;&emsp;import java.awt.FlowLayout;</div>
<div>94&emsp;&emsp;import java.awt.Font;</div>
<div>95&emsp;&emsp;import java.awt.FontMetrics;</div>
<div>96&emsp;&emsp;import java.awt.Graphics;</div>
<div>97&emsp;&emsp;import java.awt.Graphics2D;</div>
<div>98&emsp;&emsp;import java.awt.GridLayout;</div>
<div>99&emsp;&emsp;import java.awt.Image;</div>
<div>100&emsp;&emsp;import java.awt.Menu;</div>
<div>101&emsp;&emsp;import java.awt.MenuItem;</div>
<div>102&emsp;&emsp;import java.awt.Point;</div>
<div>103&emsp;&emsp;import java.awt.PopupMenu;</div>
<div>104&emsp;&emsp;import java.awt.Rectangle;</div>
<div>105&emsp;&emsp;import java.awt.RenderingHints;</div>
<div>106&emsp;&emsp;import java.awt.Toolkit;</div>
<div>107&emsp;&emsp;import java.awt.event.ActionEvent;</div>
<div>108&emsp;&emsp;import java.awt.event.ActionListener;</div>
<div>109&emsp;&emsp;import java.awt.event.InputEvent;</div>
<div>110&emsp;&emsp;import java.awt.event.KeyAdapter;</div>
<div>111&emsp;&emsp;import java.awt.event.KeyEvent;</div>
<div>112&emsp;&emsp;import java.awt.event.MouseAdapter;</div>
<div>113&emsp;&emsp;import java.awt.event.MouseEvent;</div>
<div>114&emsp;&emsp;import java.awt.event.MouseMotionAdapter;</div>
<div>115&emsp;&emsp;import java.awt.image.BufferedImage;</div>
<div>116&emsp;&emsp;import java.beans.BeanInfo;</div>
<div>117&emsp;&emsp;import java.beans.Customizer;</div>
<div>118&emsp;&emsp;import java.beans.EventSetDescriptor;</div>
<div>119&emsp;&emsp;import java.beans.IntrospectionException;</div>
<div>120&emsp;&emsp;import java.beans.Introspector;</div>
<div>121&emsp;&emsp;import java.beans.PropertyChangeEvent;</div>
<div>122&emsp;&emsp;import java.beans.PropertyChangeListener;</div>
<div>123&emsp;&emsp;import java.beans.beancontext.BeanContextChild;</div>
<div>124&emsp;&emsp;import java.beans.beancontext.BeanContextSupport;</div>
<div>125&emsp;&emsp;import java.io.BufferedWriter;</div>
<div>126&emsp;&emsp;import java.io.File;</div>
<div>127&emsp;&emsp;import java.io.FileInputStream;</div>
<div>128&emsp;&emsp;import java.io.FileOutputStream;</div>
<div>129&emsp;&emsp;import java.io.FileWriter;</div>
<div>130&emsp;&emsp;import java.io.IOException;</div>
<div>131&emsp;&emsp;import java.io.InputStream;</div>
<div>132&emsp;&emsp;import java.io.InputStreamReader;</div>
<div>133&emsp;&emsp;import java.io.LineNumberReader;</div>
<div>134&emsp;&emsp;import java.io.ObjectInputStream;</div>
<div>135&emsp;&emsp;import java.io.ObjectOutputStream;</div>
<div>136&emsp;&emsp;import java.io.OutputStream;</div>
<div>137&emsp;&emsp;import java.io.OutputStreamWriter;</div>
<div>138&emsp;&emsp;import java.io.Reader;</div>
<div>139&emsp;&emsp;import java.io.Serializable;</div>
<div>140&emsp;&emsp;import java.lang.annotation.Annotation;</div>
<div>141&emsp;&emsp;import java.text.SimpleDateFormat;</div>
<div>142&emsp;&emsp;import java.util.ArrayList;</div>
<div>143&emsp;&emsp;import java.util.Date;</div>
<div>144&emsp;&emsp;import java.util.Enumeration;</div>
<div>145&emsp;&emsp;import java.util.HashMap;</div>
<div>146&emsp;&emsp;import java.util.Hashtable;</div>
<div>147&emsp;&emsp;import java.util.Iterator;</div>
<div>148&emsp;&emsp;import java.util.LinkedHashMap;</div>
<div>149&emsp;&emsp;import java.util.List;</div>
<div>150&emsp;&emsp;import java.util.Map;</div>
<div>151&emsp;&emsp;import java.util.Properties;</div>
<div>152&emsp;&emsp;import java.util.SortedSet;</div>
<div>153&emsp;&emsp;import java.util.Stack;</div>
<div>154&emsp;&emsp;import java.util.StringTokenizer;</div>
<div>155&emsp;&emsp;import java.util.TreeMap;</div>
<div>156&emsp;&emsp;import java.util.TreeSet;</div>
<div>157&emsp;&emsp;import java.util.Vector;</div>
<div>158&emsp;&emsp;</div>
<div>159&emsp;&emsp;/**</div>
<div>160&emsp;&emsp;&nbsp; * Main GUI class for the KnowledgeFlow. Modifications to allow interoperability</div>
<div>161&emsp;&emsp;&nbsp; * with swt provided by Davide Zerbetto (davide dot zerbetto at eng dot it).</div>
<div>162&emsp;&emsp;&nbsp; * </div>
<div>163&emsp;&emsp;&nbsp; * @author Mark Hall</div>
<div>164&emsp;&emsp;&nbsp; * @version $Revision: 13477 $</div>
<div>165&emsp;&emsp;&nbsp; * @since 1.0</div>
<div>166&emsp;&emsp;&nbsp; * @see JPanel</div>
<div>167&emsp;&emsp;&nbsp; * @see PropertyChangeListener</div>
<div>168&emsp;&emsp;&nbsp; */</div>
<div>169&emsp;&emsp;public class KnowledgeFlowApp extends JPanel implements PropertyChangeListener,</div>
<div>170&emsp;&emsp;&nbsp;&nbsp;  BeanCustomizer.ModifyListener {</div>
<div>171&emsp;&emsp;</div>
<div>172&emsp;&emsp;&nbsp;&nbsp;  /** for serialization */</div>
<div>173&emsp;&emsp;&nbsp;&nbsp;  private static final long serialVersionUID = -7064906770289728431L;</div>
<div>174&emsp;&emsp;</div>
<div>175&emsp;&emsp;&nbsp;&nbsp;  /** Map of all plugin perspectives */</div>
<div>176&emsp;&emsp;&nbsp;&nbsp;  protected Map&#60;String, String> m_pluginPerspectiveLookup =</div>
<div>177&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    new HashMap&#60;String, String>();</div>
<div>178&emsp;&emsp;</div>
<div>179&emsp;&emsp;&nbsp;&nbsp;  /** Those perspectives that have been instantiated */</div>
<div>180&emsp;&emsp;&nbsp;&nbsp;  protected Map&#60;String, KFPerspective> m_perspectiveCache =</div>
<div>181&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    new HashMap&#60;String, KFPerspective>();</div>
<div>182&emsp;&emsp;</div>
<div>183&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>184&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Holds the details needed to construct button bars for various supported</div>
<div>185&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * classes of weka algorithms/tools</div>
<div>186&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>187&emsp;&emsp;&nbsp;&nbsp;  private static Vector&#60;Vector&#60;?>> TOOLBARS = new Vector&#60;Vector&#60;?>>();</div>
<div>188&emsp;&emsp;</div>
<div>189&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>190&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Add a plugin bean props file</div>
<div>191&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * </div>
<div>192&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param beanPropsFile the plugin properties to add</div>
<div>193&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @throws Exception if a problem occurs</div>
<div>194&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>195&emsp;&emsp;&nbsp;&nbsp;  public static void addToPluginBeanProps(File beanPropsFile) throws Exception {</div>
<div>196&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    BeansProperties.addToPluginBeanProps(beanPropsFile);</div>
<div>197&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>198&emsp;&emsp;</div>
<div>199&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>200&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Remove a plugin bean props file</div>
<div>201&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * </div>
<div>202&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param beanPropsFile the plugin properties to remove</div>
<div>203&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @throws Exception if a problem occurs</div>
<div>204&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>205&emsp;&emsp;&nbsp;&nbsp;  public static void removeFromPluginBeanProps(File beanPropsFile)</div>
<div>206&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    throws Exception {</div>
<div>207&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    BeansProperties.removeFromPluginBeanProps(beanPropsFile);</div>
<div>208&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>209&emsp;&emsp;</div>
<div>210&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>211&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Loads KnowledgeFlow properties and any plugins (adds jars to the classpath)</div>
<div>212&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>213&emsp;&emsp;&nbsp;&nbsp;  public static synchronized void loadProperties() {</div>
<div>214&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    BeansProperties.loadProperties();</div>
<div>215&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>216&emsp;&emsp;</div>
<div>217&emsp;&emsp;&nbsp;&nbsp;  public static void reInitialize() {</div>
<div>218&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    loadProperties();</div>
<div>219&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    init();</div>
<div>220&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>221&emsp;&emsp;</div>
<div>222&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>223&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Initializes the temporary files necessary to construct the toolbars from.</div>
<div>224&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>225&emsp;&emsp;&nbsp;&nbsp;  private static void init() {</div>
<div>226&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    weka.core.logging.Logger.log(weka.core.logging.Logger.Level.INFO,</div>
<div>227&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      "[KnowledgeFlow] Initializing KF...");</div>
<div>228&emsp;&emsp;</div>
<div>229&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // suppress these benign warnings when loading/deserializing XML flows</div>
<div style="background-color:limegreen;">230&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>    if (!XMLBeans.SUPPRESS_PROPERTY_WARNINGS.contains("visual.iconPath")) {&nbsp;&#8594; [PRUNE, CHECKERROR, DEBUG, FOLDS, NOCHECKCAPABILITIES]</b></div>
<div>231&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      XMLBeans.SUPPRESS_PROPERTY_WARNINGS.add("visual.iconPath");</div>
<div>232&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>233&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (!XMLBeans.SUPPRESS_PROPERTY_WARNINGS</div>
<div style="background-color:limegreen;">234&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>      .contains("visual.animatedIconPath")) {&nbsp;&#8594; [PRUNE, CHECKERROR, FOLDS, NOCHECKCAPABILITIES]</b></div>
<div>235&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      XMLBeans.SUPPRESS_PROPERTY_WARNINGS.add("visual.animatedIconPath");</div>
<div>236&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>237&emsp;&emsp;</div>
<div>238&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>239&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      TOOLBARS = new Vector&#60;Vector&#60;?>>();</div>
<div>240&emsp;&emsp;</div>
<div>241&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      TreeMap&#60;Integer, Object> wrapList = new TreeMap&#60;Integer, Object>();</div>
<div>242&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Properties GEOProps = GenericPropertiesCreator</div>
<div>243&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .getGlobalOutputProperties();</div>
<div>244&emsp;&emsp;</div>
<div style="background-color:limegreen;">245&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>      if (GEOProps == null) {&nbsp;&#8594; [OPTIMIZATIONS, BATCHSIZE, NUMDECIMAL, PRUNE, SEED, CHECKERROR, MINNO, DEBUG, FOLDS, NOCHECKCAPABILITIES]</b></div>
<div>246&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        GenericPropertiesCreator creator = new GenericPropertiesCreator();</div>
<div>247&emsp;&emsp;</div>
<div style="background-color:limegreen;">248&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>        if (creator.useDynamic()) {&nbsp;&#8594; [OPTIMIZATIONS, NUMDECIMAL, PRUNE, SEED, CHECKERROR, MINNO, DEBUG, FOLDS, NOCHECKCAPABILITIES]</b></div>
<div>249&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          creator.execute(false);</div>
<div>250&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /*</div>
<div>251&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * now process the keys in the GenericObjectEditor.props. For each key</div>
<div>252&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * that has an entry in the Beans.props associating it with a bean</div>
<div>253&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * component a button tool bar will be created</div>
<div>254&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>255&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          GEOProps = creator.getOutputProperties();</div>
<div>256&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else {</div>
<div>257&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // Read the static information from the GenericObjectEditor.props</div>
<div>258&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          GEOProps = Utils.readProperties("weka/gui/GenericObjectEditor.props");</div>
<div>259&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>260&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>261&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Enumeration&#60;?> en = GEOProps.propertyNames();</div>
<div style="background-color:limegreen;">262&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>      while (en.hasMoreElements()) {&nbsp;&#8594; [PRUNE, CHECKERROR]</b></div>
<div>263&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String geoKey = (String) en.nextElement();</div>
<div>264&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // System.err.println("GEOKey " + geoKey);</div>
<div>265&emsp;&emsp;</div>
<div>266&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // try to match this key with one in the Beans.props file</div>
<div>267&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String beanCompName = BeansProperties.BEAN_PROPERTIES</div>
<div>268&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getProperty(geoKey);</div>
<div style="background-color:limegreen;">269&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>        if (beanCompName != null) {&nbsp;&#8594; [PRUNE, CHECKERROR]</b></div>
<div>270&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // add details necessary to construct a button bar for this class</div>
<div>271&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // of algorithms</div>
<div>272&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Vector&#60;Object> newV = new Vector&#60;Object>();</div>
<div>273&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // check for a naming alias for this toolbar</div>
<div>274&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String toolBarNameAlias = BeansProperties.BEAN_PROPERTIES</div>
<div>275&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getProperty(geoKey + ".alias");</div>
<div>276&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String toolBarName = (toolBarNameAlias != null) ? toolBarNameAlias</div>
<div>277&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            : geoKey.substring(geoKey.lastIndexOf('.') + 1, geoKey.length());</div>
<div>278&emsp;&emsp;</div>
<div>279&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // look for toolbar ordering information for this wrapper type</div>
<div>280&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String order = BeansProperties.BEAN_PROPERTIES.getProperty(geoKey</div>
<div>281&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + ".order");</div>
<div>282&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Integer intOrder = (order != null) ? new Integer(order)</div>
<div>283&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            : new Integer(0);</div>
<div>284&emsp;&emsp;</div>
<div>285&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // Name for the toolbar (name of weka algorithm class)</div>
<div>286&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          newV.addElement(toolBarName);</div>
<div>287&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // Name of bean capable of handling this class of algorithm</div>
<div>288&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          newV.addElement(beanCompName);</div>
<div>289&emsp;&emsp;</div>
<div>290&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // add the root package for this key</div>
<div>291&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String rootPackage = geoKey.substring(0, geoKey.lastIndexOf('.'));</div>
<div>292&emsp;&emsp;</div>
<div>293&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          newV.addElement(rootPackage);</div>
<div>294&emsp;&emsp;</div>
<div>295&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // All the weka algorithms of this class of algorithm</div>
<div>296&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String wekaAlgs = GEOProps.getProperty(geoKey);</div>
<div>297&emsp;&emsp;</div>
<div>298&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Hashtable&#60;String, String> roots = GenericObjectEditor</div>
<div>299&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .sortClassesByRoot(wekaAlgs);</div>
<div>300&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Hashtable&#60;String, HierarchyPropertyParser> hpps =</div>
<div>301&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            new Hashtable&#60;String, HierarchyPropertyParser>();</div>
<div>302&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Enumeration&#60;String> enm = roots.keys();</div>
<div>303&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          while (enm.hasMoreElements()) {</div>
<div>304&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            String root = enm.nextElement();</div>
<div>305&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            String classes = roots.get(root);</div>
<div>306&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            weka.gui.HierarchyPropertyParser hpp =</div>
<div>307&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              new weka.gui.HierarchyPropertyParser();</div>
<div>308&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            hpp.build(classes, ", ");</div>
<div>309&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // System.err.println(hpp.showTree());</div>
<div>310&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            hpps.put(root, hpp);</div>
<div>311&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>312&emsp;&emsp;</div>
<div>313&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // ------ test the HierarchyPropertyParser</div>
<div>314&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /*</div>
<div>315&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * weka.gui.HierarchyPropertyParser hpp = new</div>
<div>316&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * weka.gui.HierarchyPropertyParser(); hpp.build(wekaAlgs, ", ");</div>
<div>317&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>318&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * System.err.println(hpp.showTree());</div>
<div>319&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>320&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // ----- end test the HierarchyPropertyParser</div>
<div>321&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // newV.addElement(hpp); // add the hierarchical property parser</div>
<div>322&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          newV.addElement(hpps); // add the hierarchical property parser</div>
<div>323&emsp;&emsp;</div>
<div>324&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          StringTokenizer st = new StringTokenizer(wekaAlgs, ", ");</div>
<div>325&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          while (st.hasMoreTokens()) {</div>
<div>326&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            String current = st.nextToken().trim();</div>
<div>327&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            newV.addElement(current);</div>
<div>328&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>329&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          wrapList.put(intOrder, newV);</div>
<div>330&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // TOOLBARS.addElement(newV);</div>
<div>331&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>332&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>333&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Iterator&#60;Integer> keysetIt = wrapList.keySet().iterator();</div>
<div style="background-color:limegreen;">334&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>      while (keysetIt.hasNext()) {&nbsp;&#8594; [PRUNE, CHECKERROR]</b></div>
<div>335&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Integer key = keysetIt.next();</div>
<div>336&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @SuppressWarnings("unchecked")</div>
<div>337&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;Object> newV = (Vector&#60;Object>) wrapList.get(key);</div>
<div style="background-color:limegreen;">338&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>        if (newV != null) {&nbsp;&#8594; [PRUNE, CHECKERROR]</b></div>
<div>339&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          TOOLBARS.addElement(newV);</div>
<div>340&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>341&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>342&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>343&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JOptionPane.showMessageDialog(null,</div>
<div>344&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        "Could not read a configuration file for the generic objecte editor"</div>
<div>345&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + ". An example file is included with the Weka distribution.\n"</div>
<div>346&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "This file should be named \"GenericObjectEditor.props\" and\n"</div>
<div>347&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "should be placed either in your user home (which is set\n"</div>
<div>348&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "to \"" + System.getProperties().getProperty("user.home") + "\")\n"</div>
<div>349&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "or the directory that java was started from\n", "KnowledgeFlow",</div>
<div>350&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        JOptionPane.ERROR_MESSAGE);</div>
<div>351&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>352&emsp;&emsp;</div>
<div>353&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>354&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String standardToolBarNames = BeansProperties.BEAN_PROPERTIES</div>
<div>355&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .getProperty("weka.gui.beans.KnowledgeFlow.standardToolBars");</div>
<div>356&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      StringTokenizer st = new StringTokenizer(standardToolBarNames, ", ");</div>
<div style="background-color:limegreen;">357&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>      while (st.hasMoreTokens()) {&nbsp;&#8594; [PRUNE, CHECKERROR, FOLDS]</b></div>
<div>358&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String tempBarName = st.nextToken().trim();</div>
<div>359&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // construct details for this toolbar</div>
<div>360&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;String> newV = new Vector&#60;String>();</div>
<div>361&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // add the name of the toolbar</div>
<div>362&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        newV.addElement(tempBarName);</div>
<div>363&emsp;&emsp;</div>
<div>364&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // indicate that this is a standard toolbar (no wrapper bean)</div>
<div>365&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        newV.addElement("null");</div>
<div>366&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String toolBarContents = BeansProperties.BEAN_PROPERTIES</div>
<div>367&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getProperty("weka.gui.beans.KnowledgeFlow." + tempBarName);</div>
<div>368&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        StringTokenizer st2 = new StringTokenizer(toolBarContents, ", ");</div>
<div>369&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        while (st2.hasMoreTokens()) {</div>
<div>370&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String tempBeanName = st2.nextToken().trim();</div>
<div>371&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          newV.addElement(tempBeanName);</div>
<div>372&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>373&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        TOOLBARS.addElement(newV);</div>
<div>374&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>375&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>376&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JOptionPane.showMessageDialog(null, ex.getMessage(), "KnowledgeFlow",</div>
<div>377&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        JOptionPane.ERROR_MESSAGE);</div>
<div>378&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>379&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>380&emsp;&emsp;</div>
<div>381&emsp;&emsp;&nbsp;&nbsp;  protected class BeanIconRenderer extends DefaultTreeCellRenderer {</div>
<div>382&emsp;&emsp;</div>
<div>383&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** Added ID to avoid warning. */</div>
<div>384&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private static final long serialVersionUID = -4488876734500244945L;</div>
<div>385&emsp;&emsp;</div>
<div>386&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>387&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public Component getTreeCellRendererComponent(JTree tree, Object value,</div>
<div>388&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      boolean sel, boolean expanded, boolean leaf, int row, boolean hasFocus) {</div>
<div>389&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      super.getTreeCellRendererComponent(tree, value, sel, expanded, leaf, row,</div>
<div>390&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        hasFocus);</div>
<div>391&emsp;&emsp;</div>
<div>392&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (leaf) {</div>
<div>393&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Object userO = ((DefaultMutableTreeNode) value).getUserObject();</div>
<div>394&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (userO instanceof JTreeLeafDetails) {</div>
<div>395&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Icon i = ((JTreeLeafDetails) userO).getIcon();</div>
<div>396&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (i != null) {</div>
<div>397&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            setIcon(i);</div>
<div>398&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>399&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>400&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>401&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return this;</div>
<div>402&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>403&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>404&emsp;&emsp;</div>
<div>405&emsp;&emsp;&nbsp;&nbsp;  protected class InvisibleNode extends DefaultMutableTreeNode {</div>
<div>406&emsp;&emsp;</div>
<div>407&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>408&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>409&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>410&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private static final long serialVersionUID = -9064396835384819887L;</div>
<div>411&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected boolean m_isVisible;</div>
<div>412&emsp;&emsp;</div>
<div>413&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public InvisibleNode() {</div>
<div>414&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      this(null);</div>
<div>415&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>416&emsp;&emsp;</div>
<div>417&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public InvisibleNode(Object userObject) {</div>
<div>418&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      this(userObject, true, true);</div>
<div>419&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>420&emsp;&emsp;</div>
<div>421&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public InvisibleNode(Object userObject, boolean allowsChildren,</div>
<div>422&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      boolean isVisible) {</div>
<div>423&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      super(userObject, allowsChildren);</div>
<div>424&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      this.m_isVisible = isVisible;</div>
<div>425&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>426&emsp;&emsp;</div>
<div>427&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public TreeNode getChildAt(int index, boolean filterIsActive) {</div>
<div>428&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (!filterIsActive) {</div>
<div>429&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return super.getChildAt(index);</div>
<div>430&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>431&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (children == null) {</div>
<div>432&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        throw new ArrayIndexOutOfBoundsException("node has no children");</div>
<div>433&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>434&emsp;&emsp;</div>
<div>435&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      int realIndex = -1;</div>
<div>436&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      int visibleIndex = -1;</div>
<div>437&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @SuppressWarnings("unchecked")</div>
<div>438&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Enumeration&#60;InvisibleNode> e = new WekaEnumeration&#60;InvisibleNode>(</div>
<div>439&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        children);</div>
<div>440&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      while (e.hasMoreElements()) {</div>
<div>441&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        InvisibleNode node = e.nextElement();</div>
<div>442&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (node.isVisible()) {</div>
<div>443&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          visibleIndex++;</div>
<div>444&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>445&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        realIndex++;</div>
<div>446&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (visibleIndex == index) {</div>
<div>447&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          return (TreeNode) children.elementAt(realIndex);</div>
<div>448&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>449&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>450&emsp;&emsp;</div>
<div>451&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      throw new ArrayIndexOutOfBoundsException("index unmatched");</div>
<div>452&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>453&emsp;&emsp;</div>
<div>454&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public int getChildCount(boolean filterIsActive) {</div>
<div>455&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (!filterIsActive) {</div>
<div>456&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return super.getChildCount();</div>
<div>457&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>458&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (children == null) {</div>
<div>459&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return 0;</div>
<div>460&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>461&emsp;&emsp;</div>
<div>462&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      int count = 0;</div>
<div>463&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @SuppressWarnings("unchecked")</div>
<div>464&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Enumeration&#60;InvisibleNode> e = new WekaEnumeration&#60;InvisibleNode>(</div>
<div>465&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        children);</div>
<div>466&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      while (e.hasMoreElements()) {</div>
<div>467&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        InvisibleNode node = e.nextElement();</div>
<div>468&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (node.isVisible()) {</div>
<div>469&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          count++;</div>
<div>470&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>471&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>472&emsp;&emsp;</div>
<div>473&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return count;</div>
<div>474&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>475&emsp;&emsp;</div>
<div>476&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void setVisible(boolean visible) {</div>
<div>477&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      this.m_isVisible = visible;</div>
<div>478&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>479&emsp;&emsp;</div>
<div>480&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public boolean isVisible() {</div>
<div>481&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return m_isVisible;</div>
<div>482&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>483&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>484&emsp;&emsp;</div>
<div>485&emsp;&emsp;&nbsp;&nbsp;  protected class InvisibleTreeModel extends DefaultTreeModel {</div>
<div>486&emsp;&emsp;</div>
<div>487&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>488&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>489&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>490&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private static final long serialVersionUID = 6940101211275068260L;</div>
<div>491&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected boolean m_filterIsActive;</div>
<div>492&emsp;&emsp;</div>
<div>493&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public InvisibleTreeModel(TreeNode root) {</div>
<div>494&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      this(root, false);</div>
<div>495&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>496&emsp;&emsp;</div>
<div>497&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public InvisibleTreeModel(TreeNode root, boolean asksAllowsChildren) {</div>
<div>498&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      this(root, false, false);</div>
<div>499&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>500&emsp;&emsp;</div>
<div>501&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public InvisibleTreeModel(TreeNode root, boolean asksAllowsChildren,</div>
<div>502&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      boolean filterIsActive) {</div>
<div>503&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      super(root, asksAllowsChildren);</div>
<div>504&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      this.m_filterIsActive = filterIsActive;</div>
<div>505&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>506&emsp;&emsp;</div>
<div>507&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void activateFilter(boolean newValue) {</div>
<div>508&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_filterIsActive = newValue;</div>
<div>509&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>510&emsp;&emsp;</div>
<div>511&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public boolean isActivatedFilter() {</div>
<div>512&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return m_filterIsActive;</div>
<div>513&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>514&emsp;&emsp;</div>
<div>515&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>516&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public Object getChild(Object parent, int index) {</div>
<div>517&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_filterIsActive) {</div>
<div>518&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (parent instanceof InvisibleNode) {</div>
<div>519&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          return ((InvisibleNode) parent).getChildAt(index, m_filterIsActive);</div>
<div>520&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>521&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>522&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return ((TreeNode) parent).getChildAt(index);</div>
<div>523&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>524&emsp;&emsp;</div>
<div>525&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>526&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public int getChildCount(Object parent) {</div>
<div>527&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_filterIsActive) {</div>
<div>528&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (parent instanceof InvisibleNode) {</div>
<div>529&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          return ((InvisibleNode) parent).getChildCount(m_filterIsActive);</div>
<div>530&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>531&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>532&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return ((TreeNode) parent).getChildCount();</div>
<div>533&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>534&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>535&emsp;&emsp;</div>
<div>536&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>537&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Inner class for encapsulating information about a bean that is represented</div>
<div>538&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * at a leaf in the JTree.</div>
<div>539&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>540&emsp;&emsp;&nbsp;&nbsp;  protected class JTreeLeafDetails implements Serializable {</div>
<div>541&emsp;&emsp;</div>
<div>542&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>543&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * For serialization</div>
<div>544&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>545&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private static final long serialVersionUID = 6197221540272931626L;</div>
<div>546&emsp;&emsp;</div>
<div>547&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** fully qualified bean name */</div>
<div>548&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected String m_fullyQualifiedCompName = "";</div>
<div>549&emsp;&emsp;</div>
<div>550&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>551&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * the label (usually derived from the qualified name or wrapped algorithm)</div>
<div>552&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * for the leaf</div>
<div>553&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>554&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected String m_leafLabel = "";</div>
<div>555&emsp;&emsp;</div>
<div>556&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** the fully qualified wrapped weka algorithm name */</div>
<div>557&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected String m_wekaAlgoName = "";</div>
<div>558&emsp;&emsp;</div>
<div>559&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** icon to display at the leaf (scaled appropriately) */</div>
<div>560&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected transient Icon m_scaledIcon = null;</div>
<div>561&emsp;&emsp;</div>
<div>562&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** XML serialized MetaBean (if this is a user component) */</div>
<div>563&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // protected StringBuffer m_metaBean = null;</div>
<div>564&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected Vector&#60;Object> m_metaBean = null;</div>
<div>565&emsp;&emsp;</div>
<div>566&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** true if this is a MetaBean (user component) */</div>
<div>567&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected boolean m_isMeta = false;</div>
<div>568&emsp;&emsp;</div>
<div>569&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** tool tip text to display */</div>
<div>570&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected String m_toolTipText = null;</div>
<div>571&emsp;&emsp;</div>
<div>572&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>573&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Constructor.</div>
<div>574&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>575&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param fullName flully qualified name of the bean</div>
<div>576&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param icon icon for the bean</div>
<div>577&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>578&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected JTreeLeafDetails(String fullName, Icon icon) {</div>
<div>579&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      this(fullName, "", icon);</div>
<div>580&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>581&emsp;&emsp;</div>
<div>582&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>583&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Constructor</div>
<div>584&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>585&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param name fully qualified name of the bean</div>
<div>586&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param serializedMeta empty string or XML serialized MetaBean if this</div>
<div>587&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *          leaf represents a "user" component</div>
<div>588&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>589&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param icon icon for the bean</div>
<div>590&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>591&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected JTreeLeafDetails(String name, Vector&#60;Object> serializedMeta,</div>
<div>592&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Icon icon) {</div>
<div>593&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      this(name, "", icon);</div>
<div>594&emsp;&emsp;</div>
<div>595&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_isMeta = isMeta;</div>
<div>596&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_metaBean = serializedMeta;</div>
<div>597&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_isMeta = true;</div>
<div>598&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_toolTipText = "Hold down shift and click to remove";</div>
<div>599&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>600&emsp;&emsp;</div>
<div>601&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>602&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Constructor</div>
<div>603&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>604&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param fullName fully qualified name of the bean</div>
<div>605&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param wekaAlgoName fully qualified name of the encapsulated (wrapped)</div>
<div>606&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *          weka algorithm, or null if this bean does not wrap a Weka</div>
<div>607&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *          algorithm</div>
<div>608&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>609&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param icon icon for the bean</div>
<div>610&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>611&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected JTreeLeafDetails(String fullName, String wekaAlgoName, Icon icon) {</div>
<div>612&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_fullyQualifiedCompName = fullName;</div>
<div>613&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_wekaAlgoName = wekaAlgoName;</div>
<div>614&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_leafLabel = (wekaAlgoName.length() > 0) ? wekaAlgoName</div>
<div>615&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        : m_fullyQualifiedCompName;</div>
<div>616&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_leafLabel.lastIndexOf('.') > 0) {</div>
<div>617&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_leafLabel = m_leafLabel.substring(m_leafLabel.lastIndexOf('.') + 1,</div>
<div>618&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_leafLabel.length());</div>
<div>619&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>620&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_scaledIcon = icon;</div>
<div>621&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>622&emsp;&emsp;</div>
<div>623&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>624&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Get the tool tip for this leaf</div>
<div>625&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>626&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return the tool tip</div>
<div>627&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>628&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected String getToolTipText() {</div>
<div>629&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return m_toolTipText;</div>
<div>630&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>631&emsp;&emsp;</div>
<div>632&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected void setToolTipText(String tipText) {</div>
<div>633&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_toolTipText = tipText;</div>
<div>634&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>635&emsp;&emsp;</div>
<div>636&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>637&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Returns the leaf label</div>
<div>638&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>639&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return the leaf label</div>
<div>640&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>641&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>642&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public String toString() {</div>
<div>643&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return m_leafLabel;</div>
<div>644&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>645&emsp;&emsp;</div>
<div>646&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>647&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Gets the icon for this bean</div>
<div>648&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>649&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return the icon for this bean</div>
<div>650&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>651&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected Icon getIcon() {</div>
<div>652&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return m_scaledIcon;</div>
<div>653&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>654&emsp;&emsp;</div>
<div>655&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>656&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Set the icon to use for this bean</div>
<div>657&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>658&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param icon the icon to use</div>
<div>659&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>660&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected void setIcon(Icon icon) {</div>
<div>661&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_scaledIcon = icon;</div>
<div>662&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>663&emsp;&emsp;</div>
<div>664&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>665&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Returns true if this leaf represents a wrapped Weka algorithm (i.e.</div>
<div>666&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * filter, classifier, clusterer etc.).</div>
<div>667&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>668&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return true if this leaf represents a wrapped algorithm</div>
<div>669&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>670&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected boolean isWrappedAlgorithm() {</div>
<div>671&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return (m_wekaAlgoName != null && m_wekaAlgoName.length() > 0);</div>
<div>672&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>673&emsp;&emsp;</div>
<div>674&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>675&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Returns true if this leaf represents a MetaBean (i.e. "user" component)</div>
<div>676&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>677&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return true if this leaf represents a MetaBean</div>
<div>678&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>679&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected boolean isMetaBean() {</div>
<div>680&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return (m_metaBean != null);</div>
<div>681&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // return (m_wekaAlgoName.length() == 0);</div>
<div>682&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // return m_isMeta;</div>
<div>683&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>684&emsp;&emsp;</div>
<div>685&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>686&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Gets the XML serialized MetaBean and associated information (icon,</div>
<div>687&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * displayname)</div>
<div>688&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>689&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return the XML serialized MetaBean as a 3-element Vector containing</div>
<div>690&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *         display name serialized bean and icon</div>
<div>691&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>692&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected Vector&#60;Object> getMetaBean() {</div>
<div>693&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return m_metaBean;</div>
<div>694&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>695&emsp;&emsp;</div>
<div>696&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>697&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * "Instantiates" the bean represented by this leaf.</div>
<div>698&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>699&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected void instantiateBean() {</div>
<div>700&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      try {</div>
<div>701&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (isMetaBean()) {</div>
<div>702&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // MetaBean copy = copyMetaBean(m_metaBean, false);</div>
<div>703&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // copy.addPropertyChangeListenersSubFlow(KnowledgeFlowApp.this);</div>
<div>704&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_toolBarBean = m_metaBean.get(1);</div>
<div>705&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else {</div>
<div>706&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_toolBarBean = WekaPackageClassLoaderManager.objectForName(m_fullyQualifiedCompName);</div>
<div>707&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          //m_toolBarBean = Beans.instantiate(KnowledgeFlowApp.this.getClass()</div>
<div>708&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           // .getClassLoader(), m_fullyQualifiedCompName);</div>
<div>709&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (isWrappedAlgorithm()) {</div>
<div>710&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Object algo = WekaPackageClassLoaderManager.objectForName(m_wekaAlgoName);</div>
<div>711&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            //Object algo = Beans.instantiate(KnowledgeFlowApp.this.getClass()</div>
<div>712&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            //  .getClassLoader(), m_wekaAlgoName);</div>
<div>713&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((WekaWrapper) m_toolBarBean).setWrappedAlgorithm(algo);</div>
<div>714&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>715&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>716&emsp;&emsp;</div>
<div>717&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KnowledgeFlowApp.this.setCursor(Cursor</div>
<div>718&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));</div>
<div>719&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mode = ADDING;</div>
<div>720&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_pasteB.setEnabled(false);</div>
<div>721&emsp;&emsp;</div>
<div>722&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } catch (Exception ex) {</div>
<div>723&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        System.err</div>
<div>724&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .println("Problem instantiating bean \"" + m_fullyQualifiedCompName</div>
<div>725&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + "\" (JTreeLeafDetails.instantiateBean()");</div>
<div>726&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ex.printStackTrace();</div>
<div>727&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>728&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>729&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>730&emsp;&emsp;</div>
<div>731&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>732&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Used for displaying the bean components and their visible connections</div>
<div>733&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>734&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @author &#60;a href="mailto:mhall@cs.waikato.ac.nz">Mark Hall&#60;/a></div>
<div>735&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @version $Revision: 13477 $</div>
<div>736&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @since 1.0</div>
<div>737&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @see PrintablePanel</div>
<div>738&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>739&emsp;&emsp;&nbsp;&nbsp;  protected class BeanLayout extends PrintablePanel {</div>
<div>740&emsp;&emsp;</div>
<div>741&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** for serialization */</div>
<div>742&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private static final long serialVersionUID = -146377012429662757L;</div>
<div>743&emsp;&emsp;</div>
<div>744&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>745&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void paintComponent(Graphics gx) {</div>
<div>746&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      double lz = m_layoutZoom / 100.0;</div>
<div>747&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ((Graphics2D) gx).scale(lz, lz);</div>
<div>748&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_layoutZoom &#60; 100) {</div>
<div>749&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((Graphics2D) gx).setStroke(new BasicStroke(2));</div>
<div>750&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>751&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      super.paintComponent(gx);</div>
<div>752&emsp;&emsp;</div>
<div>753&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ((Graphics2D) gx).setRenderingHint(RenderingHints.KEY_ANTIALIASING,</div>
<div>754&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        RenderingHints.VALUE_ANTIALIAS_ON);</div>
<div>755&emsp;&emsp;</div>
<div>756&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ((Graphics2D) gx).setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING,</div>
<div>757&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        RenderingHints.VALUE_TEXT_ANTIALIAS_GASP);</div>
<div>758&emsp;&emsp;</div>
<div>759&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance.paintLabels(gx, m_mainKFPerspective.getCurrentTabIndex());</div>
<div>760&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanConnection.paintConnections(gx,</div>
<div>761&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex());</div>
<div>762&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // BeanInstance.paintConnections(gx);</div>
<div>763&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_mode == CONNECTING) {</div>
<div>764&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        gx.drawLine(m_startX, m_startY, m_oldX, m_oldY);</div>
<div>765&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } else if (m_mode == SELECTING) {</div>
<div>766&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        gx.drawRect((m_startX &#60; m_oldX) ? m_startX : m_oldX,</div>
<div>767&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          (m_startY &#60; m_oldY) ? m_startY : m_oldY, Math.abs(m_oldX - m_startX),</div>
<div>768&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Math.abs(m_oldY - m_startY));</div>
<div>769&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>770&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>771&emsp;&emsp;</div>
<div>772&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>773&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void doLayout() {</div>
<div>774&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      super.doLayout();</div>
<div>775&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Object> comps = BeanInstance.getBeanInstances(m_mainKFPerspective</div>
<div>776&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .getCurrentTabIndex());</div>
<div>777&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; comps.size(); i++) {</div>
<div>778&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeanInstance bi = (BeanInstance) comps.elementAt(i);</div>
<div>779&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        JComponent c = (JComponent) bi.getBean();</div>
<div>780&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Dimension d = c.getPreferredSize();</div>
<div>781&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        c.setBounds(bi.getX(), bi.getY(), d.width, d.height);</div>
<div>782&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        c.revalidate();</div>
<div>783&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>784&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>785&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>786&emsp;&emsp;</div>
<div>787&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>788&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Interface for perspectives.</div>
<div>789&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>790&emsp;&emsp;&nbsp;&nbsp;  public static interface KFPerspective {</div>
<div>791&emsp;&emsp;</div>
<div>792&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>793&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Set instances (if the perspective accepts them)</div>
<div>794&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>795&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param insts the instances</div>
<div>796&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>797&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    void setInstances(Instances insts) throws Exception;</div>
<div>798&emsp;&emsp;</div>
<div>799&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>800&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Returns true if this perspective accepts instances</div>
<div>801&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>802&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return true if this perspective can accept instances</div>
<div>803&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>804&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean acceptsInstances();</div>
<div>805&emsp;&emsp;</div>
<div>806&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>807&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Get the title of this perspective</div>
<div>808&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>809&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return the title of this perspective</div>
<div>810&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>811&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    String getPerspectiveTitle();</div>
<div>812&emsp;&emsp;</div>
<div>813&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>814&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Get the tool tip text for this perspective.</div>
<div>815&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>816&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return the tool tip text for this perspective</div>
<div>817&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>818&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    String getPerspectiveTipText();</div>
<div>819&emsp;&emsp;</div>
<div>820&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>821&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Get the icon for this perspective.</div>
<div>822&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>823&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return the Icon for this perspective (or null if the perspective does</div>
<div>824&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *         not have an icon)</div>
<div>825&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>826&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Icon getPerspectiveIcon();</div>
<div>827&emsp;&emsp;</div>
<div>828&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>829&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Set active status of this perspective. True indicates that this</div>
<div>830&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * perspective is the visible active perspective in the KnowledgeFlow</div>
<div>831&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>832&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param active true if this perspective is the active one</div>
<div>833&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>834&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    void setActive(boolean active);</div>
<div>835&emsp;&emsp;</div>
<div>836&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>837&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Set whether this perspective is "loaded" - i.e. whether or not the user</div>
<div>838&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * has opted to have it available in the perspective toolbar. The</div>
<div>839&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * perspective can make the decision as to allocating or freeing resources</div>
<div>840&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * on the basis of this.</div>
<div>841&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>842&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param loaded true if the perspective is available in the perspective</div>
<div>843&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *          toolbar of the KnowledgeFlow</div>
<div>844&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>845&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    void setLoaded(boolean loaded);</div>
<div>846&emsp;&emsp;</div>
<div>847&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>848&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Set a reference to the main KnowledgeFlow perspective - i.e. the</div>
<div>849&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * perspective that manages flow layouts.</div>
<div>850&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>851&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param main the main KnowledgeFlow perspective.</div>
<div>852&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>853&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    void setMainKFPerspective(KnowledgeFlowApp.MainKFPerspective main);</div>
<div>854&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>855&emsp;&emsp;</div>
<div>856&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>857&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Main Knowledge Flow perspective</div>
<div>858&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>859&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>860&emsp;&emsp;&nbsp;&nbsp;  public class MainKFPerspective extends JPanel implements KFPerspective {</div>
<div>861&emsp;&emsp;</div>
<div>862&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>863&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>864&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>865&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private static final long serialVersionUID = 7666381888012259527L;</div>
<div>866&emsp;&emsp;</div>
<div>867&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** Holds the tabs of the perspective */</div>
<div>868&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected JTabbedPane m_flowTabs = new JTabbedPane();</div>
<div>869&emsp;&emsp;</div>
<div>870&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** List of layouts - one for each tab */</div>
<div>871&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected List&#60;BeanLayout> m_beanLayouts = new ArrayList&#60;BeanLayout>();</div>
<div>872&emsp;&emsp;</div>
<div>873&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** List of zoom settings - one for each tab */</div>
<div>874&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected List&#60;Integer> m_zoomSettings = new ArrayList&#60;Integer>();</div>
<div>875&emsp;&emsp;</div>
<div>876&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** List of log panels - one for each tab */</div>
<div>877&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected List&#60;KFLogPanel> m_logPanels = new ArrayList&#60;KFLogPanel>();</div>
<div>878&emsp;&emsp;</div>
<div>879&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** List of environment variable settings - one for each tab */</div>
<div>880&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected List&#60;Environment> m_environmentSettings =</div>
<div>881&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      new ArrayList&#60;Environment>();</div>
<div>882&emsp;&emsp;</div>
<div>883&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** List of flow file paths - one for each tab */</div>
<div>884&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected List&#60;File> m_filePaths = new ArrayList&#60;File>();</div>
<div>885&emsp;&emsp;</div>
<div>886&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** Keeps track of which tabs have been edited but not saved */</div>
<div>887&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected List&#60;Boolean> m_editedList = new ArrayList&#60;Boolean>();</div>
<div>888&emsp;&emsp;</div>
<div>889&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** Keeps track of which tabs have flows that are executing */</div>
<div>890&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected List&#60;Boolean> m_executingList = new ArrayList&#60;Boolean>();</div>
<div>891&emsp;&emsp;</div>
<div>892&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** Keeps track of the threads used for execution */</div>
<div>893&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected List&#60;RunThread> m_executionThreads = new ArrayList&#60;RunThread>();</div>
<div>894&emsp;&emsp;</div>
<div>895&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** Keeps track of any highlighted beans on the canvas for a tab */</div>
<div>896&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected List&#60;Vector&#60;Object>> m_selectedBeans =</div>
<div>897&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      new ArrayList&#60;Vector&#60;Object>>();</div>
<div>898&emsp;&emsp;</div>
<div>899&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /** Keeps track of the undo buffers for each tab */</div>
<div>900&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected List&#60;Stack&#60;File>> m_undoBufferList = new ArrayList&#60;Stack&#60;File>>();</div>
<div>901&emsp;&emsp;</div>
<div>902&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    protected Map&#60;String, DefaultMutableTreeNode> m_nodeTextIndex =</div>
<div>903&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      new LinkedHashMap&#60;String, DefaultMutableTreeNode>();</div>
<div>904&emsp;&emsp;</div>
<div>905&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>906&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void setActive(boolean active) {</div>
<div>907&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // nothing to do here</div>
<div>908&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>909&emsp;&emsp;</div>
<div>910&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>911&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void setLoaded(boolean loaded) {</div>
<div>912&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // we are always loaded and part of the set of perspectives</div>
<div>913&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>914&emsp;&emsp;</div>
<div>915&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>916&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void setMainKFPerspective(MainKFPerspective main) {</div>
<div>917&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // we don't need this :-)</div>
<div>918&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>919&emsp;&emsp;</div>
<div>920&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public JTabbedPane getTabbedPane() {</div>
<div>921&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return m_flowTabs;</div>
<div>922&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>923&emsp;&emsp;</div>
<div>924&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized int getNumTabs() {</div>
<div>925&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return m_flowTabs.getTabCount();</div>
<div>926&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>927&emsp;&emsp;</div>
<div>928&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized String getTabTitle(int index) {</div>
<div>929&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>930&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_flowTabs.getTitleAt(index);</div>
<div>931&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>932&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>933&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>934&emsp;&emsp;</div>
<div>935&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized int getCurrentTabIndex() {</div>
<div>936&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return m_flowTabs.getSelectedIndex();</div>
<div>937&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>938&emsp;&emsp;</div>
<div>939&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized KFLogPanel getCurrentLogPanel() {</div>
<div>940&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getCurrentTabIndex() >= 0) {</div>
<div>941&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_logPanels.get(getCurrentTabIndex());</div>
<div>942&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>943&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>944&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>945&emsp;&emsp;</div>
<div>946&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized KFLogPanel getLogPanel(int index) {</div>
<div>947&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index >= 0 && index &#60; m_logPanels.size()) {</div>
<div>948&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_logPanels.get(index);</div>
<div>949&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>950&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>951&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>952&emsp;&emsp;</div>
<div>953&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized BeanLayout getCurrentBeanLayout() {</div>
<div>954&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getCurrentTabIndex() >= 0) {</div>
<div>955&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_beanLayouts.get(getCurrentTabIndex());</div>
<div>956&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>957&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>958&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>959&emsp;&emsp;</div>
<div>960&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized BeanLayout getBeanLayout(int index) {</div>
<div>961&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index >= 0 && index &#60; m_logPanels.size()) {</div>
<div>962&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_beanLayouts.get(getCurrentTabIndex());</div>
<div>963&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>964&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>965&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>966&emsp;&emsp;</div>
<div>967&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized int getCurrentZoomSetting() {</div>
<div>968&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getCurrentTabIndex() >= 0) {</div>
<div>969&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_zoomSettings.get(getCurrentTabIndex()).intValue();</div>
<div>970&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>971&emsp;&emsp;</div>
<div>972&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // no scaling</div>
<div>973&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return 100;</div>
<div>974&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>975&emsp;&emsp;</div>
<div>976&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized int getZoomSetting(int index) {</div>
<div>977&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index >= 0 && index &#60; m_zoomSettings.size()) {</div>
<div>978&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_zoomSettings.get(index);</div>
<div>979&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>980&emsp;&emsp;</div>
<div>981&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // no scaling</div>
<div>982&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return 100;</div>
<div>983&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>984&emsp;&emsp;</div>
<div>985&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setCurrentZoomSetting(int z) {</div>
<div>986&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>987&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setZoomSetting(getCurrentTabIndex(), z);</div>
<div>988&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>989&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>990&emsp;&emsp;</div>
<div>991&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setZoomSetting(int index, int z) {</div>
<div>992&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>993&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomSettings.set(index, new Integer(z));</div>
<div>994&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>995&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>996&emsp;&emsp;</div>
<div>997&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setActiveTab(int index) {</div>
<div>998&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>999&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_flowTabs.setSelectedIndex(index);</div>
<div>1000&emsp;&emsp;</div>
<div>1001&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // set the log and layout to the ones belonging to this tab</div>
<div>1002&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_logPanel = m_logPanels.get(index);</div>
<div>1003&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_beanLayout = m_beanLayouts.get(index);</div>
<div>1004&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_layoutZoom = m_zoomSettings.get(index);</div>
<div>1005&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_flowEnvironment = m_environmentSettings.get(index);</div>
<div>1006&emsp;&emsp;</div>
<div>1007&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveB.setEnabled(!getExecuting());</div>
<div>1008&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveBB.setEnabled(!getExecuting());</div>
<div>1009&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_playB.setEnabled(!getExecuting());</div>
<div>1010&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_playBB.setEnabled(!getExecuting());</div>
<div>1011&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveB.setEnabled(!getExecuting());</div>
<div>1012&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveBB.setEnabled(!getExecuting());</div>
<div>1013&emsp;&emsp;</div>
<div>1014&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomOutB.setEnabled(!getExecuting());</div>
<div>1015&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomInB.setEnabled(!getExecuting());</div>
<div>1016&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_layoutZoom == 50) {</div>
<div>1017&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_zoomOutB.setEnabled(false);</div>
<div>1018&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1019&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_layoutZoom == 200) {</div>
<div>1020&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_zoomInB.setEnabled(false);</div>
<div>1021&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1022&emsp;&emsp;</div>
<div>1023&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_groupB.setEnabled(false);</div>
<div>1024&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (getSelectedBeans().size() > 0 && !getExecuting()) {</div>
<div>1025&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // Able to group selected subflow?</div>
<div>1026&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final Vector&#60;Object> selected = m_mainKFPerspective</div>
<div>1027&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getSelectedBeans();</div>
<div>1028&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // check if sub flow is valid</div>
<div>1029&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final Vector&#60;Object> inputs = BeanConnection.inputs(selected,</div>
<div>1030&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.getCurrentTabIndex());</div>
<div>1031&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final Vector&#60;Object> outputs = BeanConnection.outputs(selected,</div>
<div>1032&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.getCurrentTabIndex());</div>
<div>1033&emsp;&emsp;</div>
<div>1034&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (groupable(selected, inputs, outputs)) {</div>
<div>1035&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_groupB.setEnabled(true);</div>
<div>1036&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1037&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1038&emsp;&emsp;</div>
<div>1039&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_cutB.setEnabled(getSelectedBeans().size() > 0 && !getExecuting());</div>
<div>1040&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_copyB.setEnabled(getSelectedBeans().size() > 0 && !getExecuting());</div>
<div>1041&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_deleteB.setEnabled(getSelectedBeans().size() > 0 && !getExecuting());</div>
<div>1042&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_selectAllB.setEnabled(BeanInstance.getBeanInstances(</div>
<div>1043&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          getCurrentTabIndex()).size() > 0</div>
<div>1044&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          && !getExecuting());</div>
<div>1045&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_pasteB</div>
<div>1046&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .setEnabled((m_pasteBuffer != null && m_pasteBuffer.length() > 0)</div>
<div>1047&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            && !getExecuting());</div>
<div>1048&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_stopB.setEnabled(getExecuting());</div>
<div>1049&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_undoB.setEnabled(!getExecuting() && getUndoBuffer().size() > 0);</div>
<div>1050&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1051&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1052&emsp;&emsp;</div>
<div>1053&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setExecuting(boolean executing) {</div>
<div>1054&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1055&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setExecuting(getCurrentTabIndex(), executing);</div>
<div>1056&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1057&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1058&emsp;&emsp;</div>
<div>1059&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setExecuting(int index, boolean executing) {</div>
<div>1060&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1061&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_executingList.set(index, new Boolean(executing));</div>
<div>1062&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((CloseableTabTitle) m_flowTabs.getTabComponentAt(index))</div>
<div>1063&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .setButtonEnabled(!executing);</div>
<div>1064&emsp;&emsp;</div>
<div>1065&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveB.setEnabled(!getExecuting());</div>
<div>1066&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveBB.setEnabled(!getExecuting());</div>
<div>1067&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_playB.setEnabled(!getExecuting());</div>
<div>1068&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_playBB.setEnabled(!getExecuting());</div>
<div>1069&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_stopB.setEnabled(getExecuting());</div>
<div>1070&emsp;&emsp;</div>
<div>1071&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_groupB.setEnabled(false);</div>
<div>1072&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (getSelectedBeans().size() > 0 && !getExecuting()) {</div>
<div>1073&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // Able to group selected subflow?</div>
<div>1074&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final Vector&#60;Object> selected = m_mainKFPerspective</div>
<div>1075&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getSelectedBeans();</div>
<div>1076&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // check if sub flow is valid</div>
<div>1077&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final Vector&#60;Object> inputs = BeanConnection.inputs(selected,</div>
<div>1078&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.getCurrentTabIndex());</div>
<div>1079&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final Vector&#60;Object> outputs = BeanConnection.outputs(selected,</div>
<div>1080&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.getCurrentTabIndex());</div>
<div>1081&emsp;&emsp;</div>
<div>1082&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (groupable(selected, inputs, outputs)) {</div>
<div>1083&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_groupB.setEnabled(true);</div>
<div>1084&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1085&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1086&emsp;&emsp;</div>
<div>1087&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_cutB.setEnabled(getSelectedBeans().size() > 0 && !getExecuting());</div>
<div>1088&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_deleteB.setEnabled(getSelectedBeans().size() > 0 && !getExecuting());</div>
<div>1089&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_selectAllB.setEnabled(BeanInstance.getBeanInstances(</div>
<div>1090&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          getCurrentTabIndex()).size() > 0</div>
<div>1091&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          && !getExecuting());</div>
<div>1092&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_copyB.setEnabled(getSelectedBeans().size() > 0 && !getExecuting());</div>
<div>1093&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_pasteB</div>
<div>1094&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .setEnabled((m_pasteBuffer != null && m_pasteBuffer.length() > 0)</div>
<div>1095&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            && !getExecuting());</div>
<div>1096&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_undoB.setEnabled(!getExecuting() && getUndoBuffer().size() > 0);</div>
<div>1097&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1098&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1099&emsp;&emsp;</div>
<div>1100&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized boolean getExecuting() {</div>
<div>1101&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return getExecuting(getCurrentTabIndex());</div>
<div>1102&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1103&emsp;&emsp;</div>
<div>1104&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized boolean getExecuting(int index) {</div>
<div>1105&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1106&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_executingList.get(index);</div>
<div>1107&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1108&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return false;</div>
<div>1109&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1110&emsp;&emsp;</div>
<div>1111&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setExecutionThread(RunThread execution) {</div>
<div>1112&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1113&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setExecutionThread(getCurrentTabIndex(), execution);</div>
<div>1114&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1115&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1116&emsp;&emsp;</div>
<div>1117&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setExecutionThread(int index, RunThread execution) {</div>
<div>1118&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1119&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_executionThreads.set(index, execution);</div>
<div>1120&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1121&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1122&emsp;&emsp;</div>
<div>1123&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized RunThread getExecutionThread() {</div>
<div>1124&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return getExecutionThread(getCurrentTabIndex());</div>
<div>1125&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1126&emsp;&emsp;</div>
<div>1127&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized RunThread getExecutionThread(int index) {</div>
<div>1128&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1129&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_executionThreads.get(index);</div>
<div>1130&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1131&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>1132&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1133&emsp;&emsp;</div>
<div>1134&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized File getFlowFile() {</div>
<div>1135&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1136&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return getFlowFile(getCurrentTabIndex());</div>
<div>1137&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1138&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>1139&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1140&emsp;&emsp;</div>
<div>1141&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized File getFlowFile(int index) {</div>
<div>1142&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index >= 0 && index &#60; getNumTabs()) {</div>
<div>1143&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_filePaths.get(index);</div>
<div>1144&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1145&emsp;&emsp;</div>
<div>1146&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>1147&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1148&emsp;&emsp;</div>
<div>1149&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setFlowFile(File flowFile) {</div>
<div>1150&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1151&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setFlowFile(getCurrentTabIndex(), flowFile);</div>
<div>1152&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1153&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1154&emsp;&emsp;</div>
<div>1155&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setFlowFile(int index, File flowFile) {</div>
<div>1156&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1157&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_filePaths.set(index, flowFile);</div>
<div>1158&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1159&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1160&emsp;&emsp;</div>
<div>1161&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setTabTitle(String title) {</div>
<div>1162&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1163&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setTabTitle(getCurrentTabIndex(), title);</div>
<div>1164&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1165&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1166&emsp;&emsp;</div>
<div>1167&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setTabTitle(int index, String title) {</div>
<div>1168&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1169&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_flowTabs.setTitleAt(index, title);</div>
<div>1170&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((CloseableTabTitle) m_flowTabs.getTabComponentAt(index)).revalidate();</div>
<div>1171&emsp;&emsp;</div>
<div>1172&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1173&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1174&emsp;&emsp;</div>
<div>1175&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setEditedStatus(boolean status) {</div>
<div>1176&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1177&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int current = getCurrentTabIndex();</div>
<div>1178&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setEditedStatus(current, status);</div>
<div>1179&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1180&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1181&emsp;&emsp;</div>
<div>1182&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setEditedStatus(int index, boolean status) {</div>
<div>1183&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1184&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Boolean newStatus = new Boolean(status);</div>
<div>1185&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_editedList.set(index, newStatus);</div>
<div>1186&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((CloseableTabTitle) m_flowTabs.getTabComponentAt(index))</div>
<div>1187&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .setBold(status);</div>
<div>1188&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1189&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1190&emsp;&emsp;</div>
<div>1191&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>1192&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Get the edited status of the currently selected tab. Returns false if</div>
<div>1193&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * there are no tabs</div>
<div>1194&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>1195&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return the edited status of the currently selected tab or false if there</div>
<div>1196&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *         are no tabs</div>
<div>1197&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>1198&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized boolean getEditedStatus() {</div>
<div>1199&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() &#60;= 0) {</div>
<div>1200&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return false;</div>
<div>1201&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1202&emsp;&emsp;</div>
<div>1203&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return getEditedStatus(getCurrentTabIndex());</div>
<div>1204&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1205&emsp;&emsp;</div>
<div>1206&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>1207&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Get the edited status of the tab at the supplied index. Returns false if</div>
<div>1208&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * the index is out of bounds or there are no tabs</div>
<div>1209&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>1210&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @param index the index of the tab to check</div>
<div>1211&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * @return the edited status of the tab</div>
<div>1212&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>1213&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized boolean getEditedStatus(int index) {</div>
<div>1214&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1215&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_editedList.get(index);</div>
<div>1216&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1217&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return false;</div>
<div>1218&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1219&emsp;&emsp;</div>
<div>1220&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setUndoBuffer(Stack&#60;File> buffer) {</div>
<div>1221&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1222&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setUndoBuffer(getCurrentTabIndex(), buffer);</div>
<div>1223&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1224&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1225&emsp;&emsp;</div>
<div>1226&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setUndoBuffer(int index, Stack&#60;File> buffer) {</div>
<div>1227&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1228&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_undoBufferList.set(index, buffer);</div>
<div>1229&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1230&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1231&emsp;&emsp;</div>
<div>1232&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized Stack&#60;File> getUndoBuffer() {</div>
<div>1233&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1234&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return getUndoBuffer(getCurrentTabIndex());</div>
<div>1235&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1236&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>1237&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1238&emsp;&emsp;</div>
<div>1239&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized Stack&#60;File> getUndoBuffer(int index) {</div>
<div>1240&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index >= 0 && index &#60; getNumTabs()) {</div>
<div>1241&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_undoBufferList.get(index);</div>
<div>1242&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1243&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>1244&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1245&emsp;&emsp;</div>
<div>1246&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized Vector&#60;Object> getSelectedBeans() {</div>
<div>1247&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1248&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return getSelectedBeans(getCurrentTabIndex());</div>
<div>1249&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1250&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>1251&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1252&emsp;&emsp;</div>
<div>1253&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized Vector&#60;Object> getSelectedBeans(int index) {</div>
<div>1254&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1255&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_selectedBeans.get(index);</div>
<div>1256&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1257&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>1258&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1259&emsp;&emsp;</div>
<div>1260&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setSelectedBeans(Vector&#60;Object> beans) {</div>
<div>1261&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1262&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setSelectedBeans(getCurrentTabIndex(), beans);</div>
<div>1263&emsp;&emsp;</div>
<div>1264&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_groupB.setEnabled(false);</div>
<div>1265&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (getSelectedBeans().size() > 0 && !getExecuting()) {</div>
<div>1266&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // Able to group selected subflow?</div>
<div>1267&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final Vector&#60;Object> selected = m_mainKFPerspective</div>
<div>1268&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getSelectedBeans();</div>
<div>1269&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // check if sub flow is valid</div>
<div>1270&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final Vector&#60;Object> inputs = BeanConnection.inputs(selected,</div>
<div>1271&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.getCurrentTabIndex());</div>
<div>1272&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final Vector&#60;Object> outputs = BeanConnection.outputs(selected,</div>
<div>1273&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.getCurrentTabIndex());</div>
<div>1274&emsp;&emsp;</div>
<div>1275&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (groupable(selected, inputs, outputs)) {</div>
<div>1276&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_groupB.setEnabled(true);</div>
<div>1277&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1278&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1279&emsp;&emsp;</div>
<div>1280&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_cutB.setEnabled(getSelectedBeans().size() > 0 && !getExecuting());</div>
<div>1281&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_copyB.setEnabled(getSelectedBeans().size() > 0 && !getExecuting());</div>
<div>1282&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_deleteB.setEnabled(getSelectedBeans().size() > 0 && !getExecuting());</div>
<div>1283&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1284&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1285&emsp;&emsp;</div>
<div>1286&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void setSelectedBeans(int index, Vector&#60;Object> beans) {</div>
<div>1287&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1288&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // turn turn off any set ones</div>
<div>1289&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; m_selectedBeans.get(index).size(); i++) {</div>
<div>1290&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          BeanInstance temp = (BeanInstance) m_selectedBeans.get(index)</div>
<div>1291&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .elementAt(i);</div>
<div>1292&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (temp.getBean() instanceof Visible) {</div>
<div>1293&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((Visible) temp.getBean()).getVisual().setDisplayConnectors(false);</div>
<div>1294&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } else if (temp.getBean() instanceof Note) {</div>
<div>1295&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((Note) temp.getBean()).setHighlighted(false);</div>
<div>1296&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1297&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1298&emsp;&emsp;</div>
<div>1299&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_selectedBeans.set(index, beans);</div>
<div>1300&emsp;&emsp;</div>
<div>1301&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // highlight any new ones</div>
<div>1302&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>1303&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          BeanInstance temp = (BeanInstance) beans.elementAt(i);</div>
<div>1304&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (temp.getBean() instanceof Visible) {</div>
<div>1305&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((Visible) temp.getBean()).getVisual().setDisplayConnectors(true);</div>
<div>1306&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } else if (temp.getBean() instanceof Note) {</div>
<div>1307&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((Note) temp.getBean()).setHighlighted(true);</div>
<div>1308&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1309&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1310&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1311&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1312&emsp;&emsp;</div>
<div>1313&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized Environment getEnvironmentSettings() {</div>
<div>1314&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getNumTabs() > 0) {</div>
<div>1315&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return getEnvironmentSettings(getCurrentTabIndex());</div>
<div>1316&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1317&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>1318&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1319&emsp;&emsp;</div>
<div>1320&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized Environment getEnvironmentSettings(int index) {</div>
<div>1321&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index &#60; getNumTabs() && index >= 0) {</div>
<div>1322&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return m_environmentSettings.get(index);</div>
<div>1323&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1324&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return null;</div>
<div>1325&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1326&emsp;&emsp;</div>
<div>1327&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>1328&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void setInstances(Instances insts) {</div>
<div>1329&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // nothing to do as we don't process externally supplied instances</div>
<div>1330&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1331&emsp;&emsp;</div>
<div>1332&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>1333&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public boolean acceptsInstances() {</div>
<div>1334&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // not needed</div>
<div>1335&emsp;&emsp;</div>
<div>1336&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return false;</div>
<div>1337&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1338&emsp;&emsp;</div>
<div>1339&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>1340&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Get the title of this perspective</div>
<div>1341&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>1342&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>1343&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public String getPerspectiveTitle() {</div>
<div>1344&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return "Data mining processes";</div>
<div>1345&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1346&emsp;&emsp;</div>
<div>1347&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>1348&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Get the tool tip text for this perspective</div>
<div>1349&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>1350&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>1351&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public String getPerspectiveTipText() {</div>
<div>1352&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return "Knowledge Flow processes";</div>
<div>1353&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1354&emsp;&emsp;</div>
<div>1355&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>1356&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Get the icon for this perspective</div>
<div>1357&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>1358&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>1359&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public Icon getPerspectiveIcon() {</div>
<div>1360&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Image wekaI = loadImage("weka/gui/weka_icon_new.png");</div>
<div>1361&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ImageIcon icon = new ImageIcon(wekaI);</div>
<div>1362&emsp;&emsp;</div>
<div>1363&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      double width = icon.getIconWidth();</div>
<div>1364&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      double height = icon.getIconHeight();</div>
<div>1365&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      width *= 0.035;</div>
<div>1366&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      height *= 0.035;</div>
<div>1367&emsp;&emsp;</div>
<div>1368&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      wekaI = wekaI.getScaledInstance((int) width, (int) height,</div>
<div>1369&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Image.SCALE_SMOOTH);</div>
<div>1370&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      icon = new ImageIcon(wekaI);</div>
<div>1371&emsp;&emsp;</div>
<div>1372&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return icon;</div>
<div>1373&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>1374&emsp;&emsp;</div>
<div>1375&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @SuppressWarnings("unchecked")</div>
<div>1376&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private void setUpToolsAndJTree() {</div>
<div>1377&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JPanel toolBarPanel = new JPanel();</div>
<div>1378&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      toolBarPanel.setLayout(new BorderLayout());</div>
<div>1379&emsp;&emsp;</div>
<div>1380&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // modifications by Zerbetto</div>
<div>1381&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // first construct the toolbar for saving, loading etc</div>
<div>1382&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_showFileMenu) {</div>
<div>1383&emsp;&emsp;</div>
<div>1384&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // set up an action for closing the curren tab</div>
<div>1385&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action closeAction = new AbstractAction("Close") {</div>
<div>1386&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1387&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1388&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1389&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = 4762166880144590384L;</div>
<div>1390&emsp;&emsp;</div>
<div>1391&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1392&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1393&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (m_mainKFPerspective.getCurrentTabIndex() >= 0) {</div>
<div>1394&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mainKFPerspective.removeTab(getCurrentTabIndex());</div>
<div>1395&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>1396&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1397&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1398&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke closeKey = KeyStroke.getKeyStroke(KeyEvent.VK_W,</div>
<div>1399&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1400&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("Close", closeAction);</div>
<div>1401&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1402&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(closeKey, "Close");</div>
<div>1403&emsp;&emsp;</div>
<div>1404&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        JToolBar fixedTools = new JToolBar();</div>
<div>1405&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.setOrientation(JToolBar.HORIZONTAL);</div>
<div>1406&emsp;&emsp;</div>
<div>1407&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_groupB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1408&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "bricks.png")));</div>
<div>1409&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_groupB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1410&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_groupB.setToolTipText("Group selected (Ctrl+Z)");</div>
<div>1411&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_cutB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1412&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "cut.png")));</div>
<div>1413&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_cutB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1414&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_cutB.setToolTipText("Cut selected (Ctrl+X)");</div>
<div>1415&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_copyB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1416&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "page_copy.png")));</div>
<div>1417&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_copyB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1418&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_copyB.setToolTipText("Copy selected (Ctrl+C)");</div>
<div>1419&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_pasteB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1420&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "paste_plain.png")));</div>
<div>1421&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_pasteB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1422&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_pasteB.setToolTipText("Paste from clipboard (Ctrl+V)");</div>
<div>1423&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_deleteB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1424&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "delete.png")));</div>
<div>1425&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_deleteB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1426&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_deleteB.setToolTipText("Delete selected (DEL)");</div>
<div>1427&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_snapToGridB = new JToggleButton(new ImageIcon(</div>
<div>1428&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          loadImage(BeanVisual.ICON_PATH + "shape_handles.png")));</div>
<div>1429&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // m_snapToGridB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1430&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_snapToGridB.setToolTipText("Snap to grid (Ctrl+G)");</div>
<div>1431&emsp;&emsp;</div>
<div>1432&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1433&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "disk.png")));</div>
<div>1434&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1435&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveB.setToolTipText("Save layout (Ctrl+S)");</div>
<div>1436&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveBB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1437&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "disk_multiple.png")));</div>
<div>1438&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveBB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1439&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveBB.setToolTipText("Save layout with new name");</div>
<div>1440&emsp;&emsp;</div>
<div>1441&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_loadB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1442&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "folder_add.png")));</div>
<div>1443&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_loadB.setToolTipText("Open (Ctrl+O)");</div>
<div>1444&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_loadB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1445&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_newB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1446&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "page_add.png")));</div>
<div>1447&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_newB.setToolTipText("New layout (Ctrl+N)");</div>
<div>1448&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_newB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1449&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_newB.setEnabled(getAllowMultipleTabs());</div>
<div>1450&emsp;&emsp;</div>
<div>1451&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_helpB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1452&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "help.png")));</div>
<div>1453&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_helpB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1454&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_helpB.setToolTipText("Display help (Ctrl+H)");</div>
<div>1455&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_togglePerspectivesB = new JButton(new ImageIcon(</div>
<div>1456&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          loadImage(BeanVisual.ICON_PATH + "cog_go.png")));</div>
<div>1457&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_togglePerspectivesB.setBorder(BorderFactory.createEmptyBorder(0, 8,</div>
<div>1458&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          0, 0));</div>
<div>1459&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_togglePerspectivesB</div>
<div>1460&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .setToolTipText("Show/hide perspectives toolbar (Ctrl+P)");</div>
<div>1461&emsp;&emsp;</div>
<div>1462&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_templatesB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1463&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "application_view_tile.png")));</div>
<div>1464&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_templatesB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1465&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_templatesB.setToolTipText("Load a template layout");</div>
<div>1466&emsp;&emsp;</div>
<div>1467&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_noteB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1468&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "note_add.png")));</div>
<div>1469&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_noteB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1470&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_noteB.setToolTipText("Add a note to the layout (Ctrl+I)");</div>
<div>1471&emsp;&emsp;</div>
<div>1472&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_selectAllB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1473&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "shape_group.png")));</div>
<div>1474&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_selectAllB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1475&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_selectAllB.setToolTipText("Select all (Ctrl+A)");</div>
<div>1476&emsp;&emsp;</div>
<div>1477&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomInB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1478&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "zoom_in.png")));</div>
<div>1479&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomInB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1480&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomInB.setToolTipText("Zoom in (Ctrl++)");</div>
<div>1481&emsp;&emsp;</div>
<div>1482&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomOutB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1483&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "zoom_out.png")));</div>
<div>1484&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomOutB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1485&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomOutB.setToolTipText("Zoom out (Ctrl+-)");</div>
<div>1486&emsp;&emsp;</div>
<div>1487&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_undoB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1488&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "arrow_undo.png")));</div>
<div>1489&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_undoB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>1490&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_undoB.setToolTipText("Undo (Ctrl+U)");</div>
<div>1491&emsp;&emsp;</div>
<div>1492&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_zoomInB);</div>
<div>1493&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_zoomOutB);</div>
<div>1494&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.addSeparator();</div>
<div>1495&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_selectAllB);</div>
<div>1496&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_groupB);</div>
<div>1497&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_cutB);</div>
<div>1498&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_copyB);</div>
<div>1499&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_deleteB);</div>
<div>1500&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_pasteB);</div>
<div>1501&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_undoB);</div>
<div>1502&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_noteB);</div>
<div>1503&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.addSeparator();</div>
<div>1504&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_snapToGridB);</div>
<div>1505&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.addSeparator();</div>
<div>1506&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_newB);</div>
<div>1507&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_saveB);</div>
<div>1508&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_saveBB);</div>
<div>1509&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_loadB);</div>
<div>1510&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_templatesB);</div>
<div>1511&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.addSeparator();</div>
<div>1512&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_togglePerspectivesB);</div>
<div>1513&emsp;&emsp;</div>
<div>1514&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.add(m_helpB);</div>
<div>1515&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Dimension d = m_undoB.getPreferredSize();</div>
<div>1516&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Dimension d2 = fixedTools.getMinimumSize();</div>
<div>1517&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Dimension d3 = new Dimension(d2.width, d.height + 4);</div>
<div>1518&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.setPreferredSize(d3);</div>
<div>1519&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.setMaximumSize(d3);</div>
<div>1520&emsp;&emsp;</div>
<div>1521&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action saveAction = new AbstractAction("Save") {</div>
<div>1522&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1523&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1524&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1525&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = 5182044142154404706L;</div>
<div>1526&emsp;&emsp;</div>
<div>1527&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1528&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1529&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (m_mainKFPerspective.getCurrentTabIndex() >= 0) {</div>
<div>1530&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              saveLayout(m_mainKFPerspective.getCurrentTabIndex(), false);</div>
<div>1531&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>1532&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1533&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1534&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke saveKey = KeyStroke.getKeyStroke(KeyEvent.VK_S,</div>
<div>1535&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1536&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("Save", saveAction);</div>
<div>1537&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1538&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(saveKey, "Save");</div>
<div>1539&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveB.addActionListener(new ActionListener() {</div>
<div>1540&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1541&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1542&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            saveAction.actionPerformed(e);</div>
<div>1543&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1544&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1545&emsp;&emsp;</div>
<div>1546&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveBB.addActionListener(new ActionListener() {</div>
<div>1547&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1548&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1549&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            saveLayout(m_mainKFPerspective.getCurrentTabIndex(), true);</div>
<div>1550&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1551&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1552&emsp;&emsp;</div>
<div>1553&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action openAction = new AbstractAction("Open") {</div>
<div>1554&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1555&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1556&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1557&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = -5106547209818805444L;</div>
<div>1558&emsp;&emsp;</div>
<div>1559&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1560&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1561&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_flowEnvironment = new Environment();</div>
<div>1562&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            loadLayout();</div>
<div>1563&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1564&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1565&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke openKey = KeyStroke.getKeyStroke(KeyEvent.VK_O,</div>
<div>1566&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1567&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("Open", openAction);</div>
<div>1568&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1569&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(openKey, "Open");</div>
<div>1570&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_loadB.addActionListener(new ActionListener() {</div>
<div>1571&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1572&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1573&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            openAction.actionPerformed(e);</div>
<div>1574&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1575&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1576&emsp;&emsp;</div>
<div>1577&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action newAction = new AbstractAction("New") {</div>
<div>1578&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1579&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1580&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1581&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = 8002244400334262966L;</div>
<div>1582&emsp;&emsp;</div>
<div>1583&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1584&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1585&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            clearLayout();</div>
<div>1586&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1587&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1588&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke newKey = KeyStroke.getKeyStroke(KeyEvent.VK_N,</div>
<div>1589&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1590&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("New", newAction);</div>
<div>1591&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1592&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(newKey, "New");</div>
<div>1593&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_newB.addActionListener(new ActionListener() {</div>
<div>1594&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1595&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent ae) {</div>
<div>1596&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            newAction.actionPerformed(ae);</div>
<div>1597&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1598&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1599&emsp;&emsp;</div>
<div>1600&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action selectAllAction = new AbstractAction("SelectAll") {</div>
<div>1601&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1602&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1603&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1604&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = -8086754050844707658L;</div>
<div>1605&emsp;&emsp;</div>
<div>1606&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1607&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1608&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (BeanInstance.getBeanInstances(</div>
<div>1609&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mainKFPerspective.getCurrentTabIndex()).size() > 0) {</div>
<div>1610&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // select all beans</div>
<div>1611&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              Vector&#60;Object> allBeans = BeanInstance</div>
<div>1612&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                .getBeanInstances(m_mainKFPerspective.getCurrentTabIndex());</div>
<div>1613&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              Vector&#60;Object> newSelected = new Vector&#60;Object>();</div>
<div>1614&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              for (int i = 0; i &#60; allBeans.size(); i++) {</div>
<div>1615&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                newSelected.add(allBeans.get(i));</div>
<div>1616&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>1617&emsp;&emsp;</div>
<div>1618&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // toggle</div>
<div>1619&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (newSelected.size() == m_mainKFPerspective.getSelectedBeans()</div>
<div>1620&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                .size()) {</div>
<div>1621&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // unselect all beans</div>
<div>1622&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                m_mainKFPerspective.setSelectedBeans(new Vector&#60;Object>());</div>
<div>1623&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>1624&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // select all beans</div>
<div>1625&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                m_mainKFPerspective.setSelectedBeans(newSelected);</div>
<div>1626&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>1627&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>1628&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            revalidate();</div>
<div>1629&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            repaint();</div>
<div>1630&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            notifyIsDirty();</div>
<div>1631&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1632&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1633&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke selectAllKey = KeyStroke.getKeyStroke(KeyEvent.VK_A,</div>
<div>1634&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1635&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("SelectAll", selectAllAction);</div>
<div>1636&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1637&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(selectAllKey, "SelectAll");</div>
<div>1638&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_selectAllB.addActionListener(new ActionListener() {</div>
<div>1639&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1640&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1641&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            selectAllAction.actionPerformed(e);</div>
<div>1642&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1643&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1644&emsp;&emsp;</div>
<div>1645&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action zoomInAction = new AbstractAction("ZoomIn") {</div>
<div>1646&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1647&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1648&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1649&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = 1348383794897269484L;</div>
<div>1650&emsp;&emsp;</div>
<div>1651&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1652&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1653&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_layoutZoom += 25;</div>
<div>1654&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_zoomOutB.setEnabled(true);</div>
<div>1655&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (m_layoutZoom >= 200) {</div>
<div>1656&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_layoutZoom = 200;</div>
<div>1657&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_zoomInB.setEnabled(false);</div>
<div>1658&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>1659&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.setCurrentZoomSetting(m_layoutZoom);</div>
<div>1660&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            revalidate();</div>
<div>1661&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            repaint();</div>
<div>1662&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            notifyIsDirty();</div>
<div>1663&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1664&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1665&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke zoomInKey = KeyStroke.getKeyStroke(KeyEvent.VK_EQUALS,</div>
<div>1666&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1667&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("ZoomIn", zoomInAction);</div>
<div>1668&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1669&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(zoomInKey, "ZoomIn");</div>
<div>1670&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomInB.addActionListener(new ActionListener() {</div>
<div>1671&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1672&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1673&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            zoomInAction.actionPerformed(e);</div>
<div>1674&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1675&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1676&emsp;&emsp;</div>
<div>1677&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action zoomOutAction = new AbstractAction("ZoomOut") {</div>
<div>1678&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1679&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1680&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1681&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = -1120096894263455918L;</div>
<div>1682&emsp;&emsp;</div>
<div>1683&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1684&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1685&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_layoutZoom -= 25;</div>
<div>1686&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_zoomInB.setEnabled(true);</div>
<div>1687&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (m_layoutZoom &#60;= 50) {</div>
<div>1688&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_layoutZoom = 50;</div>
<div>1689&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_zoomOutB.setEnabled(false);</div>
<div>1690&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>1691&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.setCurrentZoomSetting(m_layoutZoom);</div>
<div>1692&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            revalidate();</div>
<div>1693&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            repaint();</div>
<div>1694&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            notifyIsDirty();</div>
<div>1695&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1696&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1697&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke zoomOutKey = KeyStroke.getKeyStroke(KeyEvent.VK_MINUS,</div>
<div>1698&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1699&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("ZoomOut", zoomOutAction);</div>
<div>1700&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1701&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(zoomOutKey, "ZoomOut");</div>
<div>1702&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_zoomOutB.addActionListener(new ActionListener() {</div>
<div>1703&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1704&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1705&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            zoomOutAction.actionPerformed(e);</div>
<div>1706&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1707&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1708&emsp;&emsp;</div>
<div>1709&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action groupAction = new AbstractAction("Group") {</div>
<div>1710&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1711&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1712&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1713&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = -5752742619180091435L;</div>
<div>1714&emsp;&emsp;</div>
<div>1715&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1716&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1717&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            final Vector&#60;Object> selected = m_mainKFPerspective</div>
<div>1718&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .getSelectedBeans();</div>
<div>1719&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            final Vector&#60;Object> inputs = BeanConnection.inputs(selected,</div>
<div>1720&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mainKFPerspective.getCurrentTabIndex());</div>
<div>1721&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            final Vector&#60;Object> outputs = BeanConnection.outputs(selected,</div>
<div>1722&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mainKFPerspective.getCurrentTabIndex());</div>
<div>1723&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            groupSubFlow(selected, inputs, outputs);</div>
<div>1724&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1725&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1726&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke groupKey = KeyStroke.getKeyStroke(KeyEvent.VK_Z,</div>
<div>1727&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1728&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("Group", groupAction);</div>
<div>1729&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1730&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(groupKey, "Group");</div>
<div>1731&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_groupB.addActionListener(new ActionListener() {</div>
<div>1732&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1733&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1734&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            groupAction.actionPerformed(e);</div>
<div>1735&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1736&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1737&emsp;&emsp;</div>
<div>1738&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action cutAction = new AbstractAction("Cut") {</div>
<div>1739&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1740&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1741&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1742&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = -4955878102742013040L;</div>
<div>1743&emsp;&emsp;</div>
<div>1744&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1745&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1746&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // only delete if our copy was successful!</div>
<div>1747&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (copyToClipboard()) {</div>
<div>1748&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              deleteSelectedBeans();</div>
<div>1749&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>1750&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1751&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1752&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke cutKey = KeyStroke.getKeyStroke(KeyEvent.VK_X,</div>
<div>1753&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1754&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("Cut", cutAction);</div>
<div>1755&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1756&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(cutKey, "Cut");</div>
<div>1757&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_cutB.addActionListener(new ActionListener() {</div>
<div>1758&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1759&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1760&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            cutAction.actionPerformed(e);</div>
<div>1761&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1762&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1763&emsp;&emsp;</div>
<div>1764&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action deleteAction = new AbstractAction("Delete") {</div>
<div>1765&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1766&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1767&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1768&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = 4621688037874199553L;</div>
<div>1769&emsp;&emsp;</div>
<div>1770&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1771&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1772&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            deleteSelectedBeans();</div>
<div>1773&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1774&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1775&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke deleteKey = KeyStroke.getKeyStroke(KeyEvent.VK_DELETE, 0);</div>
<div>1776&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("Delete", deleteAction);</div>
<div>1777&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1778&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(deleteKey, "Delete");</div>
<div>1779&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_deleteB.addActionListener(new ActionListener() {</div>
<div>1780&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1781&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1782&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            deleteAction.actionPerformed(e);</div>
<div>1783&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1784&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1785&emsp;&emsp;</div>
<div>1786&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action copyAction = new AbstractAction("Copy") {</div>
<div>1787&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1788&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1789&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1790&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = 117010390180468707L;</div>
<div>1791&emsp;&emsp;</div>
<div>1792&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1793&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1794&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            copyToClipboard();</div>
<div>1795&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.setSelectedBeans(new Vector&#60;Object>());</div>
<div>1796&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1797&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1798&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke copyKey = KeyStroke.getKeyStroke(KeyEvent.VK_C,</div>
<div>1799&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1800&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("Copy", copyAction);</div>
<div>1801&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1802&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(copyKey, "Copy");</div>
<div>1803&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_copyB.addActionListener(new ActionListener() {</div>
<div>1804&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1805&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1806&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            copyAction.actionPerformed(e);</div>
<div>1807&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1808&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1809&emsp;&emsp;</div>
<div>1810&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action pasteAction = new AbstractAction("Paste") {</div>
<div>1811&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1812&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1813&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1814&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = 5935121051028929455L;</div>
<div>1815&emsp;&emsp;</div>
<div>1816&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1817&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1818&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            KnowledgeFlowApp.this.setCursor(Cursor</div>
<div>1819&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));</div>
<div>1820&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mode = PASTING;</div>
<div>1821&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1822&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1823&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke pasteKey = KeyStroke.getKeyStroke(KeyEvent.VK_V,</div>
<div>1824&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1825&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("Paste", pasteAction);</div>
<div>1826&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1827&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(pasteKey, "Paste");</div>
<div>1828&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_pasteB.addActionListener(new ActionListener() {</div>
<div>1829&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1830&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1831&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            pasteAction.actionPerformed(e);</div>
<div>1832&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1833&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1834&emsp;&emsp;</div>
<div>1835&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Action snapAction = new AbstractAction("Snap") {</div>
<div>1836&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /**</div>
<div>1837&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>1838&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>1839&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          private static final long serialVersionUID = 7820689847829357449L;</div>
<div>1840&emsp;&emsp;</div>
<div>1841&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1842&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1843&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // toggle first</div>
<div>1844&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_snapToGridB.setSelected(!m_snapToGridB.isSelected());</div>
<div>1845&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (m_snapToGridB.isSelected()) {</div>
<div>1846&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              snapSelectedToGrid();</div>
<div>1847&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>1848&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1849&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        };</div>
<div>1850&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KeyStroke snapKey = KeyStroke.getKeyStroke(KeyEvent.VK_G,</div>
<div>1851&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          InputEvent.CTRL_DOWN_MASK);</div>
<div>1852&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getActionMap().put("Snap", snapAction);</div>
<div>1853&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1854&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .put(snapKey, "Snap");</div>
<div>1855&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_snapToGridB.addActionListener(new ActionListener() {</div>
<div>1856&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>1857&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>1858&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (m_snapToGridB.isSelected()) {</div>
<div>1859&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              snapSelectedToGrid();</div>
<div>1860&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>1861&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1862&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>1863&emsp;&emsp;</div>
<div>1864&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        fixedTools.setFloatable(false);</div>
<div>1865&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        toolBarPanel.add(fixedTools, BorderLayout.EAST);</div>
<div>1866&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>1867&emsp;&emsp;</div>
<div>1868&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final Action noteAction = new AbstractAction("Note") {</div>
<div>1869&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        /**</div>
<div>1870&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         *</div>
<div>1871&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         */</div>
<div>1872&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        private static final long serialVersionUID = 2991743619130024875L;</div>
<div>1873&emsp;&emsp;</div>
<div>1874&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>1875&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>1876&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Note n = new Note();</div>
<div>1877&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_toolBarBean = n;</div>
<div>1878&emsp;&emsp;</div>
<div>1879&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          KnowledgeFlowApp.this.setCursor(Cursor</div>
<div>1880&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));</div>
<div>1881&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mode = ADDING;</div>
<div>1882&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1883&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      };</div>
<div>1884&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      KeyStroke noteKey = KeyStroke.getKeyStroke(KeyEvent.VK_I,</div>
<div>1885&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        InputEvent.CTRL_DOWN_MASK);</div>
<div>1886&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MainKFPerspective.this.getActionMap().put("Note", noteAction);</div>
<div>1887&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1888&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .put(noteKey, "Note");</div>
<div>1889&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_noteB.addActionListener(new ActionListener() {</div>
<div>1890&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>1891&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>1892&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          noteAction.actionPerformed(e);</div>
<div>1893&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1894&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>1895&emsp;&emsp;</div>
<div>1896&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final Action undoAction = new AbstractAction("Undo") {</div>
<div>1897&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        /**</div>
<div>1898&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         *</div>
<div>1899&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         */</div>
<div>1900&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        private static final long serialVersionUID = 7248362305594881263L;</div>
<div>1901&emsp;&emsp;</div>
<div>1902&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>1903&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>1904&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Stack&#60;File> undo = m_mainKFPerspective.getUndoBuffer();</div>
<div>1905&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (undo.size() > 0) {</div>
<div>1906&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            File undoF = undo.pop();</div>
<div>1907&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (undo.size() == 0) {</div>
<div>1908&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_undoB.setEnabled(false);</div>
<div>1909&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>1910&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            loadLayout(undoF, false, true);</div>
<div>1911&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1912&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1913&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      };</div>
<div>1914&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      KeyStroke undoKey = KeyStroke.getKeyStroke(KeyEvent.VK_U,</div>
<div>1915&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        InputEvent.CTRL_DOWN_MASK);</div>
<div>1916&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MainKFPerspective.this.getActionMap().put("Undo", undoAction);</div>
<div>1917&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>1918&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .put(undoKey, "Undo");</div>
<div>1919&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_undoB.addActionListener(new ActionListener() {</div>
<div>1920&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>1921&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>1922&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          undoAction.actionPerformed(e);</div>
<div>1923&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1924&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>1925&emsp;&emsp;</div>
<div>1926&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_playB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1927&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        + "resultset_next.png")));</div>
<div>1928&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_playB.setBorder(BorderFactory.createEmptyBorder(0, 5, 0, 0));</div>
<div>1929&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_playB</div>
<div>1930&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .setToolTipText("Run this flow (all start points launched in parallel)");</div>
<div>1931&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_playB.addActionListener(new ActionListener() {</div>
<div>1932&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>1933&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>1934&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (BeanInstance.getBeanInstances(</div>
<div>1935&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.getCurrentTabIndex()).size() == 0) {</div>
<div>1936&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            return;</div>
<div>1937&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1938&emsp;&emsp;</div>
<div>1939&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          boolean proceed = true;</div>
<div>1940&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (m_Memory.memoryIsLow()) {</div>
<div>1941&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            proceed = m_Memory.showMemoryIsLow();</div>
<div>1942&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1943&emsp;&emsp;</div>
<div>1944&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (proceed) {</div>
<div>1945&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            runFlow(false);</div>
<div>1946&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1947&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>1948&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>1949&emsp;&emsp;</div>
<div>1950&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_playBB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>1951&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        + "resultset_last.png")));</div>
<div>1952&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_playBB.setBorder(BorderFactory.createEmptyBorder(0, 5, 0, 0));</div>
<div>1953&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_playBB</div>
<div>1954&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .setToolTipText("Run this flow (start points launched sequentially)");</div>
<div>1955&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_playBB.addActionListener(new ActionListener() {</div>
<div>1956&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>1957&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>1958&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (BeanInstance.getBeanInstances(</div>
<div>1959&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.getCurrentTabIndex()).size() == 0) {</div>
<div>1960&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            return;</div>
<div>1961&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1962&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (!Utils</div>
<div>1963&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getDontShowDialog("weka.gui.beans.KnowledgeFlow.SequentialRunInfo")) {</div>
<div>1964&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            JCheckBox dontShow =</div>
<div>1965&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              new JCheckBox("Do not show this message again");</div>
<div>1966&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Object[] stuff = new Object[2];</div>
<div>1967&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            stuff[0] =</div>
<div>1968&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "The order that data sources are launched in can be\n"</div>
<div>1969&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "specified by setting a custom name for each data source that\n"</div>
<div>1970&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "that includes a number. E.g. \"1:MyArffLoader\". To set a name,\n"</div>
<div>1971&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "right-click over a data source and select \"Set name\"\n\n"</div>
<div>1972&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "If the prefix is not specified, then the order of execution\n"</div>
<div>1973&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "will correspond to the order that the components were added\n"</div>
<div>1974&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "to the layout. Note that it is also possible to prevent a data\n"</div>
<div>1975&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "source from executing by prefixing its name with a \"!\". E.g\n"</div>
<div>1976&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "\"!:MyArffLoader\"";</div>
<div>1977&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            stuff[1] = dontShow;</div>
<div>1978&emsp;&emsp;</div>
<div>1979&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            JOptionPane.showMessageDialog(KnowledgeFlowApp.this, stuff,</div>
<div>1980&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "Sequential execution information", JOptionPane.OK_OPTION);</div>
<div>1981&emsp;&emsp;</div>
<div>1982&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (dontShow.isSelected()) {</div>
<div>1983&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              try {</div>
<div>1984&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                Utils</div>
<div>1985&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  .setDontShowDialog("weka.gui.beans.KnowledgeFlow.SequentialRunInfo");</div>
<div>1986&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } catch (Exception ex) {</div>
<div>1987&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // quietly ignore</div>
<div>1988&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>1989&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>1990&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1991&emsp;&emsp;</div>
<div>1992&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          boolean proceed = true;</div>
<div>1993&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (m_Memory.memoryIsLow()) {</div>
<div>1994&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            proceed = m_Memory.showMemoryIsLow();</div>
<div>1995&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>1996&emsp;&emsp;</div>
<div>1997&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (proceed) {</div>
<div>1998&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            runFlow(true);</div>
<div>1999&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2000&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2001&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>2002&emsp;&emsp;</div>
<div>2003&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_stopB = new JButton(new ImageIcon(loadImage(BeanVisual.ICON_PATH</div>
<div>2004&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        + "shape_square.png")));</div>
<div>2005&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_stopB.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));</div>
<div>2006&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_stopB.setToolTipText("Stop all execution");</div>
<div>2007&emsp;&emsp;</div>
<div>2008&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Image tempI = loadImage(BeanVisual.ICON_PATH + "cursor.png");</div>
<div>2009&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_pointerB = new JButton(new ImageIcon(tempI));</div>
<div>2010&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_pointerB.setBorder(BorderFactory.createEmptyBorder(0, 5, 0, 0));</div>
<div>2011&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_pointerB.addActionListener(new ActionListener() {</div>
<div>2012&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2013&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>2014&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_toolBarBean = null;</div>
<div>2015&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mode = NONE;</div>
<div>2016&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          KnowledgeFlowApp.this.setCursor(Cursor</div>
<div>2017&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getPredefinedCursor(Cursor.DEFAULT_CURSOR));</div>
<div>2018&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_componentTree.clearSelection();</div>
<div>2019&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2020&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>2021&emsp;&emsp;</div>
<div>2022&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // Dimension dP = m_saveB.getPreferredSize();</div>
<div>2023&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // Dimension dM = m_saveB.getMaximumSize();</div>
<div>2024&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // Dimension dP = m_stopB.getPreferredSize();</div>
<div>2025&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // Dimension dM = m_stopB.getMaximumSize();</div>
<div>2026&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_pointerB.setPreferredSize(dP);</div>
<div>2027&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_pointerB.setMaximumSize(dM);</div>
<div>2028&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_toolBarGroup.add(m_pointerB);</div>
<div>2029&emsp;&emsp;</div>
<div>2030&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JToolBar fixedTools2 = new JToolBar();</div>
<div>2031&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      fixedTools2.setOrientation(JToolBar.HORIZONTAL);</div>
<div>2032&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      fixedTools2.setFloatable(false);</div>
<div>2033&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      fixedTools2.add(m_pointerB);</div>
<div>2034&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      fixedTools2.add(m_playB);</div>
<div>2035&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      fixedTools2.add(m_playBB);</div>
<div>2036&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      fixedTools2.add(m_stopB);</div>
<div>2037&emsp;&emsp;</div>
<div>2038&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Dimension d = m_playB.getPreferredSize();</div>
<div>2039&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Dimension d2 = fixedTools2.getMinimumSize();</div>
<div>2040&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Dimension d3 = new Dimension(d2.width, d.height + 4);</div>
<div>2041&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      fixedTools2.setPreferredSize(d3);</div>
<div>2042&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      fixedTools2.setMaximumSize(d3);</div>
<div>2043&emsp;&emsp;</div>
<div>2044&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_helpB.setPreferredSize(dP);</div>
<div>2045&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_helpB.setMaximumSize(dP);</div>
<div>2046&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_helpB.setSize(m_pointerB.getSize().width,</div>
<div>2047&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_pointerB.getSize().height);</div>
<div>2048&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      toolBarPanel.add(fixedTools2, BorderLayout.WEST);</div>
<div>2049&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // end modifications by Zerbetto</div>
<div>2050&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_stopB.addActionListener(new ActionListener() {</div>
<div>2051&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2052&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>2053&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_logPanel</div>
<div>2054&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .statusMessage("@!@[KnowledgeFlow]|Attempting to stop all components...");</div>
<div>2055&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          stopFlow();</div>
<div>2056&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_logPanel.statusMessage("@!@[KnowledgeFlow]|OK.");</div>
<div>2057&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2058&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>2059&emsp;&emsp;</div>
<div>2060&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final Action helpAction = new AbstractAction("Help") {</div>
<div>2061&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        /**</div>
<div>2062&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         *</div>
<div>2063&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         */</div>
<div>2064&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        private static final long serialVersionUID = 3301809940717051925L;</div>
<div>2065&emsp;&emsp;</div>
<div>2066&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2067&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>2068&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          popupHelp();</div>
<div>2069&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2070&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      };</div>
<div>2071&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      KeyStroke helpKey = KeyStroke.getKeyStroke(KeyEvent.VK_H,</div>
<div>2072&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        InputEvent.CTRL_DOWN_MASK);</div>
<div>2073&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MainKFPerspective.this.getActionMap().put("Help", helpAction);</div>
<div>2074&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>2075&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .put(helpKey, "Help");</div>
<div>2076&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_helpB.addActionListener(new ActionListener() {</div>
<div>2077&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2078&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent ae) {</div>
<div>2079&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          helpAction.actionPerformed(ae);</div>
<div>2080&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2081&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>2082&emsp;&emsp;</div>
<div>2083&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_templatesB.addActionListener(new ActionListener() {</div>
<div>2084&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2085&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>2086&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          createTemplateMenuPopup();</div>
<div>2087&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2088&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>2089&emsp;&emsp;</div>
<div>2090&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_templatesB.setEnabled(BeansProperties.TEMPLATE_PATHS.size() > 0);</div>
<div>2091&emsp;&emsp;</div>
<div>2092&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final Action togglePerspectivesAction = new AbstractAction(</div>
<div>2093&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        "Toggle perspectives") {</div>
<div>2094&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        /**</div>
<div>2095&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           *</div>
<div>2096&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>2097&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        private static final long serialVersionUID = 5394622655137498495L;</div>
<div>2098&emsp;&emsp;</div>
<div>2099&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2100&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>2101&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (m_firstUserComponentOpp) {</div>
<div>2102&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            installWindowListenerForSavingUserStuff();</div>
<div>2103&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_firstUserComponentOpp = false;</div>
<div>2104&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2105&emsp;&emsp;</div>
<div>2106&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (!Utils</div>
<div>2107&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getDontShowDialog("weka.gui.beans.KnowledgeFlow.PerspectiveInfo")) {</div>
<div>2108&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            JCheckBox dontShow =</div>
<div>2109&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              new JCheckBox("Do not show this message again");</div>
<div>2110&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Object[] stuff = new Object[2];</div>
<div>2111&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            stuff[0] =</div>
<div>2112&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "Perspectives are environments that take over the\n"</div>
<div>2113&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "Knowledge Flow UI and provide major additional functionality.\n"</div>
<div>2114&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "Many perspectives will operate on a set of instances. Instances\n"</div>
<div>2115&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "Can be sent to a perspective by placing a DataSource on the\n"</div>
<div>2116&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "layout canvas, configuring it and then selecting \"Send to perspective\"\n"</div>
<div>2117&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "from the contextual popup menu that appears when you right-click on\n"</div>
<div>2118&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "it. Several perspectives are built in to the Knowledge Flow, others\n"</div>
<div>2119&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "can be installed via the package manager.\n";</div>
<div>2120&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            stuff[1] = dontShow;</div>
<div>2121&emsp;&emsp;</div>
<div>2122&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            JOptionPane.showMessageDialog(KnowledgeFlowApp.this, stuff,</div>
<div>2123&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "Perspective information", JOptionPane.OK_OPTION);</div>
<div>2124&emsp;&emsp;</div>
<div>2125&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (dontShow.isSelected()) {</div>
<div>2126&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              try {</div>
<div>2127&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                Utils</div>
<div>2128&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  .setDontShowDialog("weka.gui.beans.KnowledgeFlow.PerspectiveInfo");</div>
<div>2129&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } catch (Exception ex) {</div>
<div>2130&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // quietly ignore</div>
<div>2131&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2132&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2133&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2134&emsp;&emsp;</div>
<div>2135&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (m_configAndPerspectivesVisible) {</div>
<div>2136&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            KnowledgeFlowApp.this.remove(m_configAndPerspectives);</div>
<div>2137&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_configAndPerspectivesVisible = false;</div>
<div>2138&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } else {</div>
<div>2139&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            KnowledgeFlowApp.this.add(m_configAndPerspectives,</div>
<div>2140&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              BorderLayout.NORTH);</div>
<div>2141&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_configAndPerspectivesVisible = true;</div>
<div>2142&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2143&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          revalidate();</div>
<div>2144&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          repaint();</div>
<div>2145&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          notifyIsDirty();</div>
<div>2146&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2147&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      };</div>
<div>2148&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      KeyStroke togglePerspectivesKey = KeyStroke.getKeyStroke(KeyEvent.VK_P,</div>
<div>2149&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        InputEvent.CTRL_DOWN_MASK);</div>
<div>2150&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MainKFPerspective.this.getActionMap().put("Toggle perspectives",</div>
<div>2151&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        togglePerspectivesAction);</div>
<div>2152&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MainKFPerspective.this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW)</div>
<div>2153&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .put(togglePerspectivesKey, "Toggle perspectives");</div>
<div>2154&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_togglePerspectivesB.addActionListener(new ActionListener() {</div>
<div>2155&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2156&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>2157&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          togglePerspectivesAction.actionPerformed(e);</div>
<div>2158&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2159&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>2160&emsp;&emsp;</div>
<div>2161&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final int standard_toolset = 0;</div>
<div>2162&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final int wrapper_toolset = 1;</div>
<div>2163&emsp;&emsp;</div>
<div>2164&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      int toolBarType = standard_toolset;</div>
<div>2165&emsp;&emsp;</div>
<div>2166&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      DefaultMutableTreeNode jtreeRoot = new DefaultMutableTreeNode("Weka");</div>
<div>2167&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // set up wrapper toolsets</div>
<div>2168&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; TOOLBARS.size(); i++) {</div>
<div>2169&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;?> tempBarSpecs = TOOLBARS.elementAt(i);</div>
<div>2170&emsp;&emsp;</div>
<div>2171&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // name for the tool bar</div>
<div>2172&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String tempToolSetName = (String) tempBarSpecs.elementAt(0);</div>
<div>2173&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        DefaultMutableTreeNode subTreeNode = new InvisibleNode(tempToolSetName);</div>
<div>2174&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        jtreeRoot.add(subTreeNode);</div>
<div>2175&emsp;&emsp;</div>
<div>2176&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // Used for weka leaf packages</div>
<div>2177&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // Box singletonHolderPanel = null;</div>
<div>2178&emsp;&emsp;</div>
<div>2179&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // name of the bean component to handle this class of weka algorithms</div>
<div>2180&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String tempBeanCompName = (String) tempBarSpecs.elementAt(1);</div>
<div>2181&emsp;&emsp;</div>
<div>2182&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // the root package for weka algorithms</div>
<div>2183&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String rootPackage = "";</div>
<div>2184&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        weka.gui.HierarchyPropertyParser hpp = null;</div>
<div>2185&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Hashtable&#60;String, HierarchyPropertyParser> hpps = null;</div>
<div>2186&emsp;&emsp;</div>
<div>2187&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // Is this a wrapper toolbar?</div>
<div>2188&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (tempBeanCompName.compareTo("null") != 0) {</div>
<div>2189&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          toolBarType = wrapper_toolset;</div>
<div>2190&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          rootPackage = (String) tempBarSpecs.elementAt(2);</div>
<div>2191&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // hpp = (weka.gui.HierarchyPropertyParser)tempBarSpecs.elementAt(3);</div>
<div>2192&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          hpps = (Hashtable&#60;String, HierarchyPropertyParser>) tempBarSpecs</div>
<div>2193&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .elementAt(3);</div>
<div>2194&emsp;&emsp;</div>
<div>2195&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          try {</div>
<div>2196&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // modifications by Zerbetto</div>
<div>2197&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // Beans.instantiate(null, tempBeanCompName);</div>
<div>2198&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            WekaPackageClassLoaderManager.objectForName(tempBeanCompName);</div>
<div>2199&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            //Beans.instantiate(this.getClass().getClassLoader(),</div>
<div>2200&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             // tempBeanCompName);</div>
<div>2201&emsp;&emsp;</div>
<div>2202&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // end modifications by Zerbetto</div>
<div>2203&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } catch (Exception ex) {</div>
<div>2204&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // ignore</div>
<div>2205&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            weka.core.logging.Logger.log(</div>
<div>2206&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              weka.core.logging.Logger.Level.WARNING,</div>
<div>2207&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "[KnowledgeFlow] Failed to instantiate: "</div>
<div>2208&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + tempBeanCompName);</div>
<div>2209&emsp;&emsp;</div>
<div>2210&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            break;</div>
<div>2211&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2212&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else {</div>
<div>2213&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          toolBarType = standard_toolset;</div>
<div>2214&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2215&emsp;&emsp;</div>
<div>2216&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // a toolbar to hold buttons---one for each algorithm</div>
<div>2217&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // JToolBar tempToolBar = new JToolBar();</div>
<div>2218&emsp;&emsp;</div>
<div>2219&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // System.err.println(tempToolBar.getLayout());</div>
<div>2220&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // tempToolBar.setLayout(new FlowLayout());</div>
<div>2221&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int z = 2;</div>
<div>2222&emsp;&emsp;</div>
<div>2223&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (toolBarType == wrapper_toolset) {</div>
<div>2224&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Enumeration&#60;String> enm = hpps.keys();</div>
<div>2225&emsp;&emsp;</div>
<div>2226&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          while (enm.hasMoreElements()) {</div>
<div>2227&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            String root = enm.nextElement();</div>
<div>2228&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            hpp = hpps.get(root);</div>
<div>2229&emsp;&emsp;</div>
<div>2230&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (!hpp.goTo(rootPackage)) {</div>
<div>2231&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2232&emsp;&emsp;</div>
<div>2233&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            String[] primaryPackages = hpp.childrenValues();</div>
<div>2234&emsp;&emsp;</div>
<div>2235&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            for (String primaryPackage : primaryPackages) {</div>
<div>2236&emsp;&emsp;</div>
<div>2237&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              hpp.goToChild(primaryPackage);</div>
<div>2238&emsp;&emsp;</div>
<div>2239&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // check to see if this is a leaf - if so then there are no</div>
<div>2240&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // sub packages</div>
<div>2241&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (hpp.isLeafReached()) {</div>
<div>2242&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                /*</div>
<div>2243&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 * if (singletonHolderPanel == null) { singletonHolderPanel =</div>
<div>2244&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 * Box.createHorizontalBox();</div>
<div>2245&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 * singletonHolderPanel.setBorder(javax</div>
<div>2246&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 * .swing.BorderFactory.createTitledBorder( tempToolSetName)); }</div>
<div>2247&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 */</div>
<div>2248&emsp;&emsp;</div>
<div>2249&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                String algName = hpp.fullValue();</div>
<div>2250&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // -- tempBean = instantiateToolBarBean(true, tempBeanCompName,</div>
<div>2251&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // algName);</div>
<div>2252&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                Object visibleCheck = instantiateBean(</div>
<div>2253&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  (toolBarType == wrapper_toolset), tempBeanCompName, algName);</div>
<div>2254&emsp;&emsp;</div>
<div>2255&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // if (tempBean != null) {</div>
<div>2256&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (visibleCheck != null) {</div>
<div>2257&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // tempToolBar.add(tempBean);</div>
<div>2258&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // singletonHolderPanel.add(tempBean);</div>
<div>2259&emsp;&emsp;</div>
<div>2260&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  /*</div>
<div>2261&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   * Object visibleCheck = instantiateBean((toolBarType ==</div>
<div>2262&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   * wrapper_toolset), tempBeanCompName, algName);</div>
<div>2263&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   */</div>
<div>2264&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  if (visibleCheck instanceof BeanContextChild) {</div>
<div>2265&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    m_bcSupport.add(visibleCheck);</div>
<div>2266&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>2267&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  ImageIcon scaledForTree = null;</div>
<div>2268&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  if (visibleCheck instanceof Visible) {</div>
<div>2269&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    BeanVisual bv = ((Visible) visibleCheck).getVisual();</div>
<div>2270&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    if (bv != null) {</div>
<div>2271&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      scaledForTree = new ImageIcon(bv.scale(0.33));</div>
<div>2272&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      // m_iconLookup.put(algName, scaledForTree);</div>
<div>2273&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    }</div>
<div>2274&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>2275&emsp;&emsp;</div>
<div>2276&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // try and get a tool tip</div>
<div>2277&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  String toolTip = "";</div>
<div>2278&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  try {</div>
<div>2279&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    Object wrappedA = WekaPackageClassLoaderManager.objectForName(algName);</div>
<div>2280&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    // Object wrappedA = Class.forName(algName).newInstance();</div>
<div>2281&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    toolTip = getGlobalInfo(wrappedA);</div>
<div>2282&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  } catch (Exception ex) {</div>
<div>2283&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>2284&emsp;&emsp;</div>
<div>2285&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  JTreeLeafDetails leafData = new JTreeLeafDetails(</div>
<div>2286&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    tempBeanCompName, algName, scaledForTree);</div>
<div>2287&emsp;&emsp;</div>
<div>2288&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  if (toolTip != null && toolTip.length() > 0) {</div>
<div>2289&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    leafData.setToolTipText(toolTip);</div>
<div>2290&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>2291&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  DefaultMutableTreeNode leafAlgo = new InvisibleNode(leafData);</div>
<div>2292&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  subTreeNode.add(leafAlgo);</div>
<div>2293&emsp;&emsp;</div>
<div>2294&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_nodeTextIndex.put(algName.toLowerCase() + " "</div>
<div>2295&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    + (toolTip != null ? toolTip.toLowerCase() + " " : ""),</div>
<div>2296&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    leafAlgo);</div>
<div>2297&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>2298&emsp;&emsp;</div>
<div>2299&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                hpp.goToParent();</div>
<div>2300&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>2301&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // make a titledborder JPanel to hold all the schemes in this</div>
<div>2302&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // package</div>
<div>2303&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // JPanel holderPanel = new JPanel();</div>
<div>2304&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                /*</div>
<div>2305&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 * Box holderPanel = Box.createHorizontalBox();</div>
<div>2306&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 * holderPanel.setBorder</div>
<div>2307&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 * (javax.swing.BorderFactory.createTitledBorder(userPrefix +</div>
<div>2308&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 * primaryPackages[kk]));</div>
<div>2309&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 */</div>
<div>2310&emsp;&emsp;</div>
<div>2311&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                DefaultMutableTreeNode firstLevelOfMainAlgoType =</div>
<div>2312&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  new InvisibleNode(</div>
<div>2313&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    primaryPackage);</div>
<div>2314&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                subTreeNode.add(firstLevelOfMainAlgoType);</div>
<div>2315&emsp;&emsp;</div>
<div>2316&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // processPackage(holderPanel, tempBeanCompName, hpp,</div>
<div>2317&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // firstLevelOfMainAlgoType);</div>
<div>2318&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                processPackage(tempBeanCompName, hpp, firstLevelOfMainAlgoType,</div>
<div>2319&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_nodeTextIndex);</div>
<div>2320&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // tempToolBar.add(holderPanel);</div>
<div>2321&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2322&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2323&emsp;&emsp;</div>
<div>2324&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            /*</div>
<div>2325&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * if (singletonHolderPanel != null) {</div>
<div>2326&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * tempToolBar.add(singletonHolderPanel); singletonHolderPanel =</div>
<div>2327&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * null; }</div>
<div>2328&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             */</div>
<div>2329&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2330&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else {</div>
<div>2331&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /*</div>
<div>2332&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * Box holderPanel = Box.createHorizontalBox();</div>
<div>2333&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * holderPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(</div>
<div>2334&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * tempToolSetName));</div>
<div>2335&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>2336&emsp;&emsp;</div>
<div>2337&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          for (int j = z; j &#60; tempBarSpecs.size(); j++) {</div>
<div>2338&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            tempBeanCompName = (String) tempBarSpecs.elementAt(j);</div>
<div>2339&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Object visibleCheck = instantiateBean(</div>
<div>2340&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              (toolBarType == wrapper_toolset), tempBeanCompName, "");</div>
<div>2341&emsp;&emsp;</div>
<div>2342&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            /*</div>
<div>2343&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * -- tempBean = instantiateToolBarBean((toolBarType ==</div>
<div>2344&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * wrapper_toolset), tempBeanCompName, "");</div>
<div>2345&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             */</div>
<div>2346&emsp;&emsp;</div>
<div>2347&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // if (tempBean != null) {</div>
<div>2348&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (visibleCheck != null) {</div>
<div>2349&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // set tool tip text (if any)</div>
<div>2350&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // setToolTipText(tempBean)</div>
<div>2351&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // holderPanel.add(tempBean);</div>
<div>2352&emsp;&emsp;</div>
<div>2353&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              String treeName = tempBeanCompName;</div>
<div>2354&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (treeName.lastIndexOf('.') > 0) {</div>
<div>2355&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                treeName = treeName.substring(treeName.lastIndexOf('.') + 1,</div>
<div>2356&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  treeName.length());</div>
<div>2357&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2358&emsp;&emsp;</div>
<div>2359&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              /*</div>
<div>2360&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * Object visibleCheck = instantiateBean((toolBarType ==</div>
<div>2361&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * wrapper_toolset), tempBeanCompName, "");</div>
<div>2362&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               */</div>
<div>2363&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (visibleCheck instanceof BeanContextChild) {</div>
<div>2364&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                m_bcSupport.add(visibleCheck);</div>
<div>2365&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2366&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              ImageIcon scaledForTree = null;</div>
<div>2367&emsp;&emsp;</div>
<div>2368&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (visibleCheck instanceof Visible) {</div>
<div>2369&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                BeanVisual bv = ((Visible) visibleCheck).getVisual();</div>
<div>2370&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (bv != null) {</div>
<div>2371&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  scaledForTree = new ImageIcon(bv.scale(0.33));</div>
<div>2372&emsp;&emsp;</div>
<div>2373&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // m_iconLookup.put(treeName, scaledForTree);</div>
<div>2374&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>2375&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2376&emsp;&emsp;</div>
<div>2377&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              String tipText = null;</div>
<div>2378&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              tipText = getGlobalInfo(visibleCheck);</div>
<div>2379&emsp;&emsp;</div>
<div>2380&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // check for annotation and let this override any global info tool</div>
<div>2381&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // tip</div>
<div>2382&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              Class&#60;?> compClass = visibleCheck.getClass();</div>
<div>2383&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              Annotation[] annotations = compClass.getDeclaredAnnotations();</div>
<div>2384&emsp;&emsp;</div>
<div>2385&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              String category = null;</div>
<div>2386&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              DefaultMutableTreeNode targetFolder = null;</div>
<div>2387&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              for (Annotation ann : annotations) {</div>
<div>2388&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (ann instanceof KFStep) {</div>
<div>2389&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  tipText = "&#60;html>&#60;font color=blue>"</div>
<div>2390&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    + ((KFStep) ann).toolTipText() + "&#60;/font>&#60;/html>";</div>
<div>2391&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  category = ((KFStep) ann).category();</div>
<div>2392&emsp;&emsp;</div>
<div>2393&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // Does this category already exist?</div>
<div>2394&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  Enumeration&#60;Object> children = jtreeRoot.children();</div>
<div>2395&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  while (children.hasMoreElements()) {</div>
<div>2396&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    Object child = children.nextElement();</div>
<div>2397&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    if (child instanceof DefaultMutableTreeNode) {</div>
<div>2398&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      if (((DefaultMutableTreeNode) child).getUserObject()</div>
<div>2399&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                        .toString().equals(category)) {</div>
<div>2400&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                        targetFolder = (DefaultMutableTreeNode) child;</div>
<div>2401&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                        break;</div>
<div>2402&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      }</div>
<div>2403&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    }</div>
<div>2404&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>2405&emsp;&emsp;</div>
<div>2406&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  break;</div>
<div>2407&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>2408&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2409&emsp;&emsp;</div>
<div>2410&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              JTreeLeafDetails leafData = new JTreeLeafDetails(</div>
<div>2411&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                tempBeanCompName, "", scaledForTree);</div>
<div>2412&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (tipText != null) {</div>
<div>2413&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                leafData.setToolTipText(tipText);</div>
<div>2414&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2415&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              DefaultMutableTreeNode fixedLeafNode =</div>
<div>2416&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                new InvisibleNode(leafData);</div>
<div>2417&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (targetFolder != null) {</div>
<div>2418&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                targetFolder.add(fixedLeafNode);</div>
<div>2419&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>2420&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                subTreeNode.add(fixedLeafNode);</div>
<div>2421&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2422&emsp;&emsp;</div>
<div>2423&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_nodeTextIndex</div>
<div>2424&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                .put(tempBeanCompName.toLowerCase() + " "</div>
<div>2425&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  + (tipText != null ? tipText.toLowerCase() : ""),</div>
<div>2426&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  fixedLeafNode);</div>
<div>2427&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2428&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2429&emsp;&emsp;</div>
<div>2430&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // tempToolBar.add(holderPanel);</div>
<div>2431&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2432&emsp;&emsp;</div>
<div>2433&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // JScrollPane tempJScrollPane =</div>
<div>2434&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // createScrollPaneForToolBar(tempToolBar);</div>
<div>2435&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // ok, now create tabbed pane to hold this toolbar</div>
<div>2436&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // m_toolBars.addTab(tempToolSetName, null, tempJScrollPane,</div>
<div>2437&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // tempToolSetName);</div>
<div>2438&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>2439&emsp;&emsp;</div>
<div>2440&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // / ----</div>
<div>2441&emsp;&emsp;</div>
<div>2442&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // TODO Prescan for bean plugins and only create user tree node if there</div>
<div>2443&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // are actually some beans (rather than just all perspectives)</div>
<div>2444&emsp;&emsp;</div>
<div>2445&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // Any plugin components to process?</div>
<div>2446&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (BeansProperties.BEAN_PLUGINS_PROPERTIES != null</div>
<div>2447&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        && BeansProperties.BEAN_PLUGINS_PROPERTIES.size() > 0) {</div>
<div>2448&emsp;&emsp;</div>
<div>2449&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        boolean pluginBeans = false;</div>
<div>2450&emsp;&emsp;</div>
<div>2451&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        DefaultMutableTreeNode userSubTree = null;</div>
<div>2452&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; BeansProperties.BEAN_PLUGINS_PROPERTIES.size(); i++) {</div>
<div>2453&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Properties tempP = BeansProperties.BEAN_PLUGINS_PROPERTIES.get(i);</div>
<div>2454&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String components = tempP</div>
<div>2455&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getProperty("weka.gui.beans.KnowledgeFlow.Plugins");</div>
<div>2456&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (components != null && components.length() > 0) {</div>
<div>2457&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            StringTokenizer st2 = new StringTokenizer(components, ", ");</div>
<div>2458&emsp;&emsp;</div>
<div>2459&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            while (st2.hasMoreTokens()) {</div>
<div>2460&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              String tempBeanCompName = st2.nextToken().trim();</div>
<div>2461&emsp;&emsp;</div>
<div>2462&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              String treeName = tempBeanCompName;</div>
<div>2463&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (treeName.lastIndexOf('.') > 0) {</div>
<div>2464&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                treeName = treeName.substring(treeName.lastIndexOf('.') + 1,</div>
<div>2465&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  treeName.length());</div>
<div>2466&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2467&emsp;&emsp;</div>
<div>2468&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // tempBean = instantiateToolBarBean(false, tempBeanCompName, "");</div>
<div>2469&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              /*</div>
<div>2470&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * if (m_pluginsToolBar == null) { // need to create the plugins</div>
<div>2471&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * tab and toolbar setUpPluginsToolBar(); }</div>
<div>2472&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * m_pluginsBoxPanel.add(tempBean);</div>
<div>2473&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               */</div>
<div>2474&emsp;&emsp;</div>
<div>2475&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              Object visibleCheck = instantiateBean(</div>
<div>2476&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                (toolBarType == wrapper_toolset), tempBeanCompName, "");</div>
<div>2477&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (visibleCheck instanceof BeanContextChild) {</div>
<div>2478&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                m_bcSupport.add(visibleCheck);</div>
<div>2479&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2480&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              ImageIcon scaledForTree = null;</div>
<div>2481&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (visibleCheck instanceof Visible) {</div>
<div>2482&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                BeanVisual bv = ((Visible) visibleCheck).getVisual();</div>
<div>2483&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (bv != null) {</div>
<div>2484&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  scaledForTree = new ImageIcon(bv.scale(0.33));</div>
<div>2485&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // m_iconLookup.put(tempBeanCompName, scaledForTree);</div>
<div>2486&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>2487&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2488&emsp;&emsp;</div>
<div>2489&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              String tipText = null;</div>
<div>2490&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              tipText = getGlobalInfo(visibleCheck);</div>
<div>2491&emsp;&emsp;</div>
<div>2492&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // check for annotation</div>
<div>2493&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              Class&#60;?> compClass = visibleCheck.getClass();</div>
<div>2494&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              Annotation[] annotations = compClass.getDeclaredAnnotations();</div>
<div>2495&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              DefaultMutableTreeNode targetFolder = null;</div>
<div>2496&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              String category = null;</div>
<div>2497&emsp;&emsp;</div>
<div>2498&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              for (Annotation ann : annotations) {</div>
<div>2499&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (ann instanceof KFStep) {</div>
<div>2500&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  category = ((KFStep) ann).category();</div>
<div>2501&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  tipText = "&#60;html>&#60;font color=red>"</div>
<div>2502&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    + ((KFStep) ann).toolTipText() + "&#60;/font>&#60;/html>";</div>
<div>2503&emsp;&emsp;</div>
<div>2504&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // Does this category already exist?</div>
<div>2505&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  Enumeration&#60;Object> children = jtreeRoot.children();</div>
<div>2506&emsp;&emsp;</div>
<div>2507&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  while (children.hasMoreElements()) {</div>
<div>2508&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    Object child = children.nextElement();</div>
<div>2509&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    if (child instanceof DefaultMutableTreeNode) {</div>
<div>2510&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      if (((DefaultMutableTreeNode) child).getUserObject()</div>
<div>2511&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                        .toString().equals(category)) {</div>
<div>2512&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                        targetFolder = (DefaultMutableTreeNode) child;</div>
<div>2513&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                        break;</div>
<div>2514&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      }</div>
<div>2515&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    }</div>
<div>2516&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>2517&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  break;</div>
<div>2518&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>2519&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2520&emsp;&emsp;</div>
<div>2521&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              JTreeLeafDetails leafData = new JTreeLeafDetails(</div>
<div>2522&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                tempBeanCompName, "", scaledForTree);</div>
<div>2523&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (tipText != null) {</div>
<div>2524&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                leafData.setToolTipText(tipText);</div>
<div>2525&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2526&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              DefaultMutableTreeNode pluginLeaf = new InvisibleNode(leafData);</div>
<div>2527&emsp;&emsp;</div>
<div>2528&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_nodeTextIndex.put(tempBeanCompName.toLowerCase()</div>
<div>2529&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + (tipText != null ? " " + tipText.toLowerCase() : ""),</div>
<div>2530&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                pluginLeaf);</div>
<div>2531&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (targetFolder != null) {</div>
<div>2532&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                targetFolder.add(pluginLeaf);</div>
<div>2533&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else if (category != null) {</div>
<div>2534&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // make a new category folder</div>
<div>2535&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                DefaultMutableTreeNode newCategoryNode = new InvisibleNode(</div>
<div>2536&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  category);</div>
<div>2537&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                jtreeRoot.add(newCategoryNode);</div>
<div>2538&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                newCategoryNode.add(pluginLeaf);</div>
<div>2539&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>2540&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // add to the default "Plugins" folder</div>
<div>2541&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (!pluginBeans) {</div>
<div>2542&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // make the Plugins tree node entry</div>
<div>2543&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  userSubTree = new InvisibleNode("Plugins");</div>
<div>2544&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  jtreeRoot.add(userSubTree);</div>
<div>2545&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  pluginBeans = true;</div>
<div>2546&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>2547&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                userSubTree.add(pluginLeaf);</div>
<div>2548&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2549&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2550&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2551&emsp;&emsp;</div>
<div>2552&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // check for perspectives</div>
<div>2553&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String perspectives = tempP</div>
<div>2554&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getProperty(("weka.gui.beans.KnowledgeFlow.Perspectives"));</div>
<div>2555&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (perspectives != null && perspectives.length() > 0) {</div>
<div>2556&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            StringTokenizer st2 = new StringTokenizer(perspectives, ",");</div>
<div>2557&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            while (st2.hasMoreTokens()) {</div>
<div>2558&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              String className = st2.nextToken();</div>
<div>2559&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              try {</div>
<div>2560&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (PluginManager.isInDisabledList(className)) {</div>
<div>2561&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  continue;</div>
<div>2562&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>2563&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                Object p = WekaPackageClassLoaderManager.objectForName(className);</div>
<div>2564&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // Object p = Class.forName(className).newInstance();</div>
<div>2565&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (p instanceof KFPerspective && p instanceof JPanel) {</div>
<div>2566&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  String title = ((KFPerspective) p).getPerspectiveTitle();</div>
<div>2567&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  weka.core.logging.Logger.log(</div>
<div>2568&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    weka.core.logging.Logger.Level.INFO,</div>
<div>2569&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    "[KnowledgeFlow] loaded perspective: "</div>
<div>2570&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      + title);</div>
<div>2571&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_pluginPerspectiveLookup.put(className, title);</div>
<div>2572&emsp;&emsp;</div>
<div>2573&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // not selected as part of the users set of perspectives</div>
<div>2574&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // yet...</div>
<div>2575&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  ((KFPerspective) p).setLoaded(false);</div>
<div>2576&emsp;&emsp;</div>
<div>2577&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // check to see if user has selected to use this perspective</div>
<div>2578&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  if (BeansProperties.VISIBLE_PERSPECTIVES.contains(className)) {</div>
<div>2579&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    // add to the perspective cache. After processing</div>
<div>2580&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    // all plugins we will iterate over the sorted</div>
<div>2581&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    // VISIBLE_PERSPECTIVES in order to add them</div>
<div>2582&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    // to the toolbar in consistent sorted order</div>
<div>2583&emsp;&emsp;</div>
<div>2584&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    // ((KFPerspective)p).setMainKFPerspective(m_mainKFPerspective);</div>
<div>2585&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    m_perspectiveCache.put(className, (KFPerspective) p);</div>
<div>2586&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>2587&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>2588&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } catch (Exception ex) {</div>
<div>2589&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (m_logPanel != null) {</div>
<div>2590&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_logPanel</div>
<div>2591&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    .logMessage("[KnowledgeFlow] WARNING: "</div>
<div>2592&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      + "unable to instantiate perspective \"" + className</div>
<div>2593&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      + "\"");</div>
<div>2594&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  ex.printStackTrace();</div>
<div>2595&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                } else {</div>
<div>2596&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  System.err</div>
<div>2597&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    .println("[KnowledgeFlow] WARNING: "</div>
<div>2598&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      + "unable to instantiate perspective \"" + className</div>
<div>2599&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      + "\"");</div>
<div>2600&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  ex.printStackTrace();</div>
<div>2601&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>2602&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2603&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2604&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2605&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2606&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>2607&emsp;&emsp;</div>
<div>2608&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_togglePerspectivesB.setEnabled(m_pluginPerspectiveLookup.keySet()</div>
<div>2609&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .size() > 0);</div>
<div>2610&emsp;&emsp;</div>
<div>2611&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // toolBarPanel.add(m_toolBars, BorderLayout.CENTER);</div>
<div>2612&emsp;&emsp;</div>
<div>2613&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // add(m_toolBars, BorderLayout.NORTH);</div>
<div>2614&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      add(toolBarPanel, BorderLayout.NORTH);</div>
<div>2615&emsp;&emsp;</div>
<div>2616&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      InvisibleTreeModel model = new InvisibleTreeModel(jtreeRoot);// new</div>
<div>2617&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                   // DefaultTreeModel(jtreeRoot);</div>
<div>2618&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      model.activateFilter(true);</div>
<div>2619&emsp;&emsp;</div>
<div>2620&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // subclass JTree so that tool tips can be displayed for leaves (if</div>
<div>2621&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // necessary)</div>
<div>2622&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_componentTree = new JTree(model) {</div>
<div>2623&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        /**</div>
<div>2624&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         *</div>
<div>2625&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         */</div>
<div>2626&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        private static final long serialVersionUID = 6628795889296634120L;</div>
<div>2627&emsp;&emsp;</div>
<div>2628&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2629&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public String getToolTipText(MouseEvent e) {</div>
<div>2630&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if ((getRowForLocation(e.getX(), e.getY())) == -1) {</div>
<div>2631&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            return null;</div>
<div>2632&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2633&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          TreePath currPath = getPathForLocation(e.getX(), e.getY());</div>
<div>2634&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (currPath.getLastPathComponent() instanceof DefaultMutableTreeNode) {</div>
<div>2635&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            DefaultMutableTreeNode node = (DefaultMutableTreeNode) currPath</div>
<div>2636&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .getLastPathComponent();</div>
<div>2637&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (node.isLeaf()) {</div>
<div>2638&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              JTreeLeafDetails leaf = (JTreeLeafDetails) node.getUserObject();</div>
<div>2639&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              return leaf.getToolTipText();</div>
<div>2640&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2641&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2642&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          return null;</div>
<div>2643&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2644&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      };</div>
<div>2645&emsp;&emsp;</div>
<div>2646&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_componentTree.setEnabled(true);</div>
<div>2647&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_componentTree.setToolTipText("");</div>
<div>2648&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_componentTree.setRootVisible(false);</div>
<div>2649&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_componentTree.setShowsRootHandles(true);</div>
<div>2650&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_componentTree.setCellRenderer(new BeanIconRenderer());</div>
<div>2651&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      DefaultTreeSelectionModel selectionModel =</div>
<div>2652&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        new DefaultTreeSelectionModel();</div>
<div>2653&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      selectionModel.setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);</div>
<div>2654&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_componentTree.setSelectionModel(selectionModel);</div>
<div>2655&emsp;&emsp;</div>
<div>2656&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_componentTree.addMouseListener(new MouseAdapter() {</div>
<div>2657&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2658&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void mouseClicked(MouseEvent e) {</div>
<div>2659&emsp;&emsp;</div>
<div>2660&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (((e.getModifiers() & InputEvent.BUTTON1_MASK) != InputEvent.BUTTON1_MASK)</div>
<div>2661&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            || e.isAltDown()) {</div>
<div>2662&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            boolean clearSelection = true;</div>
<div>2663&emsp;&emsp;</div>
<div>2664&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (clearSelection) {</div>
<div>2665&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // right click cancels selected component</div>
<div>2666&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_toolBarBean = null;</div>
<div>2667&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mode = NONE;</div>
<div>2668&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              KnowledgeFlowApp.this.setCursor(Cursor</div>
<div>2669&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                .getPredefinedCursor(Cursor.DEFAULT_CURSOR));</div>
<div>2670&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_componentTree.clearSelection();</div>
<div>2671&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2672&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2673&emsp;&emsp;</div>
<div>2674&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          TreePath p = m_componentTree.getSelectionPath();</div>
<div>2675&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (p != null) {</div>
<div>2676&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (p.getLastPathComponent() instanceof DefaultMutableTreeNode) {</div>
<div>2677&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              DefaultMutableTreeNode tNode = (DefaultMutableTreeNode) p</div>
<div>2678&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                .getLastPathComponent();</div>
<div>2679&emsp;&emsp;</div>
<div>2680&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (tNode.isLeaf()) {</div>
<div>2681&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // System.err.println("Selected : " +</div>
<div>2682&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // tNode.getUserObject().toString());</div>
<div>2683&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                Object userObject = tNode.getUserObject();</div>
<div>2684&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (userObject instanceof JTreeLeafDetails) {</div>
<div>2685&emsp;&emsp;</div>
<div>2686&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  if ((e.getModifiers() & InputEvent.SHIFT_MASK) != 0</div>
<div>2687&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    && ((JTreeLeafDetails) userObject).isMetaBean()) {</div>
<div>2688&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    if (m_firstUserComponentOpp) {</div>
<div>2689&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      installWindowListenerForSavingUserStuff();</div>
<div>2690&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      m_firstUserComponentOpp = false;</div>
<div>2691&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    }</div>
<div>2692&emsp;&emsp;</div>
<div>2693&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    Vector&#60;Object> toRemove = ((JTreeLeafDetails) userObject)</div>
<div>2694&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      .getMetaBean();</div>
<div>2695&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    DefaultTreeModel model = (DefaultTreeModel) m_componentTree</div>
<div>2696&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      .getModel();</div>
<div>2697&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    MutableTreeNode userRoot = (MutableTreeNode) tNode</div>
<div>2698&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      .getParent(); // The "User" folder</div>
<div>2699&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    model.removeNodeFromParent(tNode);</div>
<div>2700&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    m_userComponents.remove(toRemove);</div>
<div>2701&emsp;&emsp;</div>
<div>2702&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    if (m_userComponents.size() == 0) {</div>
<div>2703&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      model.removeNodeFromParent(userRoot);</div>
<div>2704&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      m_userCompNode = null;</div>
<div>2705&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    }</div>
<div>2706&emsp;&emsp;</div>
<div>2707&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  } else {</div>
<div>2708&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    ((JTreeLeafDetails) userObject).instantiateBean();</div>
<div>2709&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>2710&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>2711&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2712&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2713&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2714&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2715&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>2716&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>2717&emsp;&emsp;</div>
<div>2718&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public MainKFPerspective() {</div>
<div>2719&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      setLayout(new BorderLayout());</div>
<div>2720&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      setUpToolsAndJTree();</div>
<div>2721&emsp;&emsp;</div>
<div>2722&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JScrollPane treeView = new JScrollPane(m_componentTree);</div>
<div>2723&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JPanel treeHolder = new JPanel();</div>
<div>2724&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      treeHolder.setLayout(new BorderLayout());</div>
<div>2725&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      treeHolder.setBorder(BorderFactory.createTitledBorder("Design"));</div>
<div>2726&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      treeHolder.add(treeView, BorderLayout.CENTER);</div>
<div>2727&emsp;&emsp;</div>
<div>2728&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final JTextField searchField = new JTextField();</div>
<div>2729&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      treeHolder.add(searchField, BorderLayout.NORTH);</div>
<div>2730&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      searchField.setToolTipText("Search (clear field to reset)");</div>
<div>2731&emsp;&emsp;</div>
<div>2732&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      searchField.addKeyListener(new KeyAdapter() {</div>
<div>2733&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2734&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void keyReleased(KeyEvent e) {</div>
<div>2735&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String searchTerm = searchField.getText();</div>
<div>2736&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          List&#60;DefaultMutableTreeNode> nonhits =</div>
<div>2737&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            new ArrayList&#60;DefaultMutableTreeNode>();</div>
<div>2738&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          List&#60;DefaultMutableTreeNode> hits =</div>
<div>2739&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            new ArrayList&#60;DefaultMutableTreeNode>();</div>
<div>2740&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          DefaultTreeModel model = (DefaultTreeModel) m_componentTree</div>
<div>2741&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getModel();</div>
<div>2742&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          model.reload(); // collapse all nodes first</div>
<div>2743&emsp;&emsp;</div>
<div>2744&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          for (Map.Entry&#60;String, DefaultMutableTreeNode> entry : m_nodeTextIndex</div>
<div>2745&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .entrySet()) {</div>
<div>2746&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (entry.getValue() instanceof InvisibleNode) {</div>
<div>2747&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              ((InvisibleNode) entry.getValue()).setVisible(true);</div>
<div>2748&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2749&emsp;&emsp;</div>
<div>2750&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (searchTerm != null && searchTerm.length() > 0) {</div>
<div>2751&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (entry.getKey().contains(searchTerm.toLowerCase())) {</div>
<div>2752&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                hits.add(entry.getValue());</div>
<div>2753&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>2754&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                nonhits.add(entry.getValue());</div>
<div>2755&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2756&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2757&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2758&emsp;&emsp;</div>
<div>2759&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (searchTerm == null || searchTerm.length() == 0) {</div>
<div>2760&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            model.reload(); // just reset everything</div>
<div>2761&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2762&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // if we have some hits then set all the non-hits to invisible</div>
<div>2763&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (hits.size() > 0) {</div>
<div>2764&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            for (DefaultMutableTreeNode h : nonhits) {</div>
<div>2765&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (h instanceof InvisibleNode) {</div>
<div>2766&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                ((InvisibleNode) h).setVisible(false);</div>
<div>2767&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>2768&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2769&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            model.reload(); // collapse all the nodes first</div>
<div>2770&emsp;&emsp;</div>
<div>2771&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // expand all the hits</div>
<div>2772&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            for (DefaultMutableTreeNode h : hits) {</div>
<div>2773&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              TreeNode[] path = model.getPathToRoot(h);</div>
<div>2774&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              TreePath tpath = new TreePath(path);</div>
<div>2775&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              tpath = tpath.getParentPath();</div>
<div>2776&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_componentTree.expandPath(tpath);</div>
<div>2777&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>2778&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2779&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2780&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>2781&emsp;&emsp;</div>
<div>2782&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_perspectiveHolder.add(treeHolder, BorderLayout.WEST);</div>
<div>2783&emsp;&emsp;</div>
<div>2784&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JSplitPane p2 = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT, treeHolder,</div>
<div>2785&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_flowTabs);</div>
<div>2786&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      p2.setOneTouchExpandable(true);</div>
<div>2787&emsp;&emsp;</div>
<div>2788&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      add(p2, BorderLayout.CENTER);</div>
<div>2789&emsp;&emsp;</div>
<div>2790&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Dimension d = treeView.getPreferredSize();</div>
<div>2791&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      d = new Dimension((int) (d.getWidth() * 1.5), (int) d.getHeight());</div>
<div>2792&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      treeView.setPreferredSize(d);</div>
<div>2793&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      treeView.setMinimumSize(d);</div>
<div>2794&emsp;&emsp;</div>
<div>2795&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_flowTabs.addChangeListener(new ChangeListener() {</div>
<div>2796&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // This method is called whenever the selected tab changes</div>
<div>2797&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2798&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void stateChanged(ChangeEvent evt) {</div>
<div>2799&emsp;&emsp;</div>
<div>2800&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // Get current tab</div>
<div>2801&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          int sel = m_flowTabs.getSelectedIndex();</div>
<div>2802&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          setActiveTab(sel);</div>
<div>2803&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2804&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>2805&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>2806&emsp;&emsp;</div>
<div>2807&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void removeTab(int tabIndex) {</div>
<div>2808&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (tabIndex &#60; 0 || tabIndex >= getNumTabs()) {</div>
<div>2809&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return;</div>
<div>2810&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>2811&emsp;&emsp;</div>
<div>2812&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_editedList.get(tabIndex)) {</div>
<div>2813&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // prompt for save</div>
<div>2814&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String tabTitle = m_flowTabs.getTitleAt(tabIndex);</div>
<div>2815&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String message = "\"" + tabTitle</div>
<div>2816&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "\" has been modified. Save changes " + "before closing?";</div>
<div>2817&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int result = JOptionPane.showConfirmDialog(KnowledgeFlowApp.this,</div>
<div>2818&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          message, "Save changes", JOptionPane.YES_NO_CANCEL_OPTION);</div>
<div>2819&emsp;&emsp;</div>
<div>2820&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (result == JOptionPane.YES_OPTION) {</div>
<div>2821&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          saveLayout(tabIndex, false);</div>
<div>2822&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else if (result == JOptionPane.CANCEL_OPTION) {</div>
<div>2823&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          return;</div>
<div>2824&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2825&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>2826&emsp;&emsp;</div>
<div>2827&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanLayout bl = m_beanLayouts.get(tabIndex);</div>
<div>2828&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance.removeBeanInstances(bl, tabIndex);</div>
<div>2829&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanConnection.removeConnectionList(tabIndex);</div>
<div>2830&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_beanLayouts.remove(tabIndex);</div>
<div>2831&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_zoomSettings.remove(tabIndex);</div>
<div>2832&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanels.remove(tabIndex);</div>
<div>2833&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_editedList.remove(tabIndex);</div>
<div>2834&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_environmentSettings.remove(tabIndex);</div>
<div>2835&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_selectedBeans.remove(tabIndex);</div>
<div>2836&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      bl = null;</div>
<div>2837&emsp;&emsp;</div>
<div>2838&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_flowTabs.remove(tabIndex);</div>
<div>2839&emsp;&emsp;</div>
<div>2840&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (getCurrentTabIndex() &#60; 0) {</div>
<div>2841&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_beanLayout = null;</div>
<div>2842&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_logPanel = null;</div>
<div>2843&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_saveB.setEnabled(false);</div>
<div>2844&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>2845&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>2846&emsp;&emsp;</div>
<div>2847&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void addTab(String tabTitle) {</div>
<div>2848&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // new beans for this tab</div>
<div>2849&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance.addBeanInstances(new Vector&#60;Object>(), null);</div>
<div>2850&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // new connections for this tab</div>
<div>2851&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanConnection.addConnections(new Vector&#60;BeanConnection>());</div>
<div>2852&emsp;&emsp;</div>
<div>2853&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JPanel p1 = new JPanel();</div>
<div>2854&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      p1.setLayout(new BorderLayout());</div>
<div>2855&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      /*</div>
<div>2856&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * p1.setBorder(javax.swing.BorderFactory.createCompoundBorder(</div>
<div>2857&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * javax.swing.BorderFactory. createTitledBorder("Knowledge Flow Layout"),</div>
<div>2858&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * javax.swing.BorderFactory.createEmptyBorder(0, 5, 5, 5) ));</div>
<div>2859&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       */</div>
<div>2860&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanLayout tabBeanLayout = new BeanLayout();</div>
<div>2861&emsp;&emsp;</div>
<div>2862&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final JScrollPane js = new JScrollPane(tabBeanLayout);</div>
<div>2863&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      p1.add(js, BorderLayout.CENTER);</div>
<div>2864&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      js.getVerticalScrollBar().setUnitIncrement(m_ScrollBarIncrementLayout);</div>
<div>2865&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      js.getHorizontalScrollBar().setUnitIncrement(m_ScrollBarIncrementLayout);</div>
<div>2866&emsp;&emsp;</div>
<div>2867&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      configureBeanLayout(tabBeanLayout);</div>
<div>2868&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_beanLayouts.add(tabBeanLayout);</div>
<div>2869&emsp;&emsp;</div>
<div>2870&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tabBeanLayout.setSize(m_FlowWidth, m_FlowHeight);</div>
<div>2871&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Dimension d = tabBeanLayout.getPreferredSize();</div>
<div>2872&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tabBeanLayout.setMinimumSize(d);</div>
<div>2873&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // tabBeanLayout.setMaximumSize(d);</div>
<div>2874&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tabBeanLayout.setPreferredSize(d);</div>
<div>2875&emsp;&emsp;</div>
<div>2876&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_zoomSettings.add(new Integer(100));</div>
<div>2877&emsp;&emsp;</div>
<div>2878&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      KFLogPanel tabLogPanel = new KFLogPanel();</div>
<div>2879&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      setUpLogPanel(tabLogPanel);</div>
<div>2880&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Dimension d2 = new Dimension(100, 170);</div>
<div>2881&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tabLogPanel.setPreferredSize(d2);</div>
<div>2882&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tabLogPanel.setMinimumSize(d2);</div>
<div>2883&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanels.add(tabLogPanel);</div>
<div>2884&emsp;&emsp;</div>
<div>2885&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_environmentSettings.add(new Environment());</div>
<div>2886&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_filePaths.add(new File("-NONE-"));</div>
<div>2887&emsp;&emsp;</div>
<div>2888&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JSplitPane p2 =</div>
<div>2889&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        new JSplitPane(JSplitPane.VERTICAL_SPLIT, p1, tabLogPanel);</div>
<div>2890&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      p2.setOneTouchExpandable(true);</div>
<div>2891&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // p2.setDividerLocation(500);</div>
<div>2892&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      p2.setDividerLocation(0.7);</div>
<div>2893&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      p2.setResizeWeight(1.0);</div>
<div>2894&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JPanel splitHolder = new JPanel();</div>
<div>2895&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      splitHolder.setLayout(new BorderLayout());</div>
<div>2896&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      splitHolder.add(p2, BorderLayout.CENTER);</div>
<div>2897&emsp;&emsp;</div>
<div>2898&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // add(splitHolder, BorderLayout.CENTER);</div>
<div>2899&emsp;&emsp;</div>
<div>2900&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_editedList.add(new Boolean(false));</div>
<div>2901&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_executingList.add(new Boolean(false));</div>
<div>2902&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_executionThreads.add((RunThread) null);</div>
<div>2903&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_selectedBeans.add(new Vector&#60;Object>());</div>
<div>2904&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_undoBufferList.add(new Stack&#60;File>());</div>
<div>2905&emsp;&emsp;</div>
<div>2906&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_flowTabs.addTab(tabTitle, splitHolder);</div>
<div>2907&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      int tabIndex = getNumTabs() - 1;</div>
<div>2908&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_flowTabs.setTabComponentAt(tabIndex, new CloseableTabTitle(m_flowTabs));</div>
<div>2909&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      setActiveTab(getNumTabs() - 1);</div>
<div>2910&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_saveB.setEnabled(true);</div>
<div>2911&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>2912&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>2913&emsp;&emsp;</div>
<div>2914&emsp;&emsp;&nbsp;&nbsp;  private class CloseableTabTitle extends JPanel {</div>
<div>2915&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>2916&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>2917&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>2918&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private static final long serialVersionUID = -6844232025394346426L;</div>
<div>2919&emsp;&emsp;</div>
<div>2920&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private final JTabbedPane m_enclosingPane;</div>
<div>2921&emsp;&emsp;</div>
<div>2922&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private JLabel m_tabLabel;</div>
<div>2923&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private TabButton m_tabButton;</div>
<div>2924&emsp;&emsp;</div>
<div>2925&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public CloseableTabTitle(final JTabbedPane pane) {</div>
<div>2926&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      super(new FlowLayout(FlowLayout.LEFT, 0, 0));</div>
<div>2927&emsp;&emsp;</div>
<div>2928&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_enclosingPane = pane;</div>
<div>2929&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      setOpaque(false);</div>
<div>2930&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      setBorder(BorderFactory.createEmptyBorder(2, 0, 0, 0));</div>
<div>2931&emsp;&emsp;</div>
<div>2932&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // read the title from the JTabbedPane</div>
<div>2933&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_tabLabel = new JLabel() {</div>
<div>2934&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        /**</div>
<div>2935&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         *</div>
<div>2936&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         */</div>
<div>2937&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        private static final long serialVersionUID = 8515052190461050324L;</div>
<div>2938&emsp;&emsp;</div>
<div>2939&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>2940&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public String getText() {</div>
<div>2941&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          int index = m_enclosingPane</div>
<div>2942&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .indexOfTabComponent(CloseableTabTitle.this);</div>
<div>2943&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (index >= 0) {</div>
<div>2944&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            return m_enclosingPane.getTitleAt(index);</div>
<div>2945&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>2946&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          return null;</div>
<div>2947&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>2948&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      };</div>
<div>2949&emsp;&emsp;</div>
<div>2950&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      add(m_tabLabel);</div>
<div>2951&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_tabLabel.setBorder(BorderFactory.createEmptyBorder(0, 0, 0, 5));</div>
<div>2952&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_tabButton = new TabButton();</div>
<div>2953&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      add(m_tabButton);</div>
<div>2954&emsp;&emsp;</div>
<div>2955&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>2956&emsp;&emsp;</div>
<div>2957&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void setBold(boolean bold) {</div>
<div>2958&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_tabLabel.setEnabled(bold);</div>
<div>2959&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>2960&emsp;&emsp;</div>
<div>2961&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void setButtonEnabled(boolean enabled) {</div>
<div>2962&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_tabButton.setEnabled(enabled);</div>
<div>2963&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>2964&emsp;&emsp;</div>
<div>2965&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private class TabButton extends JButton implements ActionListener {</div>
<div>2966&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      /**</div>
<div>2967&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       *</div>
<div>2968&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       */</div>
<div>2969&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      private static final long serialVersionUID = -4915800749132175968L;</div>
<div>2970&emsp;&emsp;</div>
<div>2971&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public TabButton() {</div>
<div>2972&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int size = 17;</div>
<div>2973&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setPreferredSize(new Dimension(size, size));</div>
<div>2974&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setToolTipText("close this tab");</div>
<div>2975&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // Make the button looks the same for all Laf's</div>
<div>2976&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setUI(new BasicButtonUI());</div>
<div>2977&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // Make it transparent</div>
<div>2978&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setContentAreaFilled(false);</div>
<div>2979&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // No need to be focusable</div>
<div>2980&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setFocusable(false);</div>
<div>2981&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setBorder(BorderFactory.createEtchedBorder());</div>
<div>2982&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setBorderPainted(false);</div>
<div>2983&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // Making nice rollover effect</div>
<div>2984&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // we use the same listener for all buttons</div>
<div>2985&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        addMouseListener(new MouseAdapter() {</div>
<div>2986&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>2987&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void mouseEntered(MouseEvent e) {</div>
<div>2988&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Component component = e.getComponent();</div>
<div>2989&emsp;&emsp;</div>
<div>2990&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (component instanceof AbstractButton) {</div>
<div>2991&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              AbstractButton button = (AbstractButton) component;</div>
<div>2992&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              button.setBorderPainted(true);</div>
<div>2993&emsp;&emsp;</div>
<div>2994&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              int i = m_enclosingPane</div>
<div>2995&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                .indexOfTabComponent(CloseableTabTitle.this);</div>
<div>2996&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (i == m_mainKFPerspective.getCurrentTabIndex()) {</div>
<div>2997&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                button.setToolTipText("close this tab (Ctrl+W)");</div>
<div>2998&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>2999&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                button.setToolTipText("close this tab");</div>
<div>3000&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>3001&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3002&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>3003&emsp;&emsp;</div>
<div>3004&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>3005&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void mouseExited(MouseEvent e) {</div>
<div>3006&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Component component = e.getComponent();</div>
<div>3007&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (component instanceof AbstractButton) {</div>
<div>3008&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              AbstractButton button = (AbstractButton) component;</div>
<div>3009&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              button.setBorderPainted(false);</div>
<div>3010&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3011&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>3012&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>3013&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setRolloverEnabled(true);</div>
<div>3014&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // Close the proper tab by clicking the button</div>
<div>3015&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        addActionListener(this);</div>
<div>3016&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3017&emsp;&emsp;</div>
<div>3018&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>3019&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void actionPerformed(ActionEvent e) {</div>
<div>3020&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int i = m_enclosingPane.indexOfTabComponent(CloseableTabTitle.this);</div>
<div>3021&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (i >= 0 && getAllowMultipleTabs()) {</div>
<div>3022&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // m_enclosingPane.remove(i);</div>
<div>3023&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.removeTab(i);</div>
<div>3024&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3025&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3026&emsp;&emsp;</div>
<div>3027&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // we don't want to update UI for this button</div>
<div>3028&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>3029&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void updateUI() {</div>
<div>3030&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3031&emsp;&emsp;</div>
<div>3032&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // paint the cross</div>
<div>3033&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>3034&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      protected void paintComponent(Graphics g) {</div>
<div>3035&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        super.paintComponent(g);</div>
<div>3036&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Graphics2D g2 = (Graphics2D) g.create();</div>
<div>3037&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // shift the image for pressed buttons</div>
<div>3038&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (getModel().isPressed()) {</div>
<div>3039&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          g2.translate(1, 1);</div>
<div>3040&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3041&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        g2.setStroke(new BasicStroke(2));</div>
<div>3042&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        g2.setColor(Color.BLACK);</div>
<div>3043&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!isEnabled()) {</div>
<div>3044&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          g2.setColor(Color.GRAY);</div>
<div>3045&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3046&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (getModel().isRollover()) {</div>
<div>3047&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          g2.setColor(Color.MAGENTA);</div>
<div>3048&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3049&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int delta = 6;</div>
<div>3050&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        g2.drawLine(delta, delta, getWidth() - delta - 1, getHeight() - delta</div>
<div>3051&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          - 1);</div>
<div>3052&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        g2.drawLine(getWidth() - delta - 1, delta, delta, getHeight() - delta</div>
<div>3053&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          - 1);</div>
<div>3054&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        g2.dispose();</div>
<div>3055&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3056&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3057&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3058&emsp;&emsp;</div>
<div>3059&emsp;&emsp;&nbsp;&nbsp;  // Used for measuring and splitting icon labels</div>
<div>3060&emsp;&emsp;&nbsp;&nbsp;  // over multiple lines</div>
<div>3061&emsp;&emsp;&nbsp;&nbsp;  FontMetrics m_fontM;</div>
<div>3062&emsp;&emsp;</div>
<div>3063&emsp;&emsp;&nbsp;&nbsp;  // constants for operations in progress</div>
<div>3064&emsp;&emsp;&nbsp;&nbsp;  protected static final int NONE = 0;</div>
<div>3065&emsp;&emsp;&nbsp;&nbsp;  protected static final int MOVING = 1;</div>
<div>3066&emsp;&emsp;&nbsp;&nbsp;  protected static final int CONNECTING = 2;</div>
<div>3067&emsp;&emsp;&nbsp;&nbsp;  protected static final int ADDING = 3;</div>
<div>3068&emsp;&emsp;&nbsp;&nbsp;  protected static final int SELECTING = 4;</div>
<div>3069&emsp;&emsp;&nbsp;&nbsp;  protected static final int PASTING = 5;</div>
<div>3070&emsp;&emsp;</div>
<div>3071&emsp;&emsp;&nbsp;&nbsp;  // which operation is in progress</div>
<div>3072&emsp;&emsp;&nbsp;&nbsp;  private int m_mode = NONE;</div>
<div>3073&emsp;&emsp;</div>
<div>3074&emsp;&emsp;&nbsp;&nbsp;  /** the extension for the user components, when serialized to XML */</div>
<div>3075&emsp;&emsp;&nbsp;&nbsp;  protected final static String USERCOMPONENTS_XML_EXTENSION = ".xml";</div>
<div>3076&emsp;&emsp;</div>
<div>3077&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3078&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Holds the selected toolbar bean</div>
<div>3079&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3080&emsp;&emsp;&nbsp;&nbsp;  private Object m_toolBarBean;</div>
<div>3081&emsp;&emsp;</div>
<div>3082&emsp;&emsp;&nbsp;&nbsp;  /** Snap-to-grid spacing */</div>
<div>3083&emsp;&emsp;&nbsp;&nbsp;  private final int m_gridSpacing = 40;</div>
<div>3084&emsp;&emsp;</div>
<div>3085&emsp;&emsp;&nbsp;&nbsp;  /** Number of untitled tabs so far */</div>
<div>3086&emsp;&emsp;&nbsp;&nbsp;  protected int m_untitledCount = 1;</div>
<div>3087&emsp;&emsp;</div>
<div>3088&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3089&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * The layout area</div>
<div>3090&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3091&emsp;&emsp;&nbsp;&nbsp;  private BeanLayout m_beanLayout = null;// new BeanLayout();</div>
<div>3092&emsp;&emsp;</div>
<div>3093&emsp;&emsp;&nbsp;&nbsp;  private int m_layoutZoom = 100;</div>
<div>3094&emsp;&emsp;</div>
<div>3095&emsp;&emsp;&nbsp;&nbsp;  /** Whether to allow more than one tab or not */</div>
<div>3096&emsp;&emsp;&nbsp;&nbsp;  private boolean m_allowMultipleTabs = true;</div>
<div>3097&emsp;&emsp;</div>
<div>3098&emsp;&emsp;&nbsp;&nbsp;  private final Vector&#60;Object> m_userComponents = new Vector&#60;Object>();</div>
<div>3099&emsp;&emsp;</div>
<div>3100&emsp;&emsp;&nbsp;&nbsp;  private boolean m_firstUserComponentOpp = true;</div>
<div>3101&emsp;&emsp;</div>
<div>3102&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_pointerB;</div>
<div>3103&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_saveB;</div>
<div>3104&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_saveBB;</div>
<div>3105&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_loadB;</div>
<div>3106&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_stopB;</div>
<div>3107&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_playB;</div>
<div>3108&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_playBB;</div>
<div>3109&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_helpB;</div>
<div>3110&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_newB;</div>
<div>3111&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_togglePerspectivesB;</div>
<div>3112&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_templatesB;</div>
<div>3113&emsp;&emsp;</div>
<div>3114&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_groupB;</div>
<div>3115&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_cutB;</div>
<div>3116&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_copyB;</div>
<div>3117&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_pasteB;</div>
<div>3118&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_deleteB;</div>
<div>3119&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_noteB;</div>
<div>3120&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_selectAllB;</div>
<div>3121&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_undoB;</div>
<div>3122&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_zoomInB;</div>
<div>3123&emsp;&emsp;&nbsp;&nbsp;  protected JButton m_zoomOutB;</div>
<div>3124&emsp;&emsp;</div>
<div>3125&emsp;&emsp;&nbsp;&nbsp;  protected JToggleButton m_snapToGridB;</div>
<div>3126&emsp;&emsp;</div>
<div>3127&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3128&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Reference to bean being manipulated</div>
<div>3129&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3130&emsp;&emsp;&nbsp;&nbsp;  private BeanInstance m_editElement;</div>
<div>3131&emsp;&emsp;</div>
<div>3132&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3133&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Event set descriptor for the bean being manipulated</div>
<div>3134&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3135&emsp;&emsp;&nbsp;&nbsp;  private EventSetDescriptor m_sourceEventSetDescriptor;</div>
<div>3136&emsp;&emsp;</div>
<div>3137&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3138&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Used to record screen coordinates during move, select and connect</div>
<div>3139&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * operations</div>
<div>3140&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3141&emsp;&emsp;&nbsp;&nbsp;  private int m_oldX, m_oldY;</div>
<div>3142&emsp;&emsp;&nbsp;&nbsp;  private int m_startX, m_startY;</div>
<div>3143&emsp;&emsp;</div>
<div>3144&emsp;&emsp;&nbsp;&nbsp;  /** The file chooser for selecting layout files */</div>
<div>3145&emsp;&emsp;&nbsp;&nbsp;  protected JFileChooser m_FileChooser = new JFileChooser(new File(</div>
<div>3146&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    System.getProperty("user.dir")));</div>
<div>3147&emsp;&emsp;</div>
<div>3148&emsp;&emsp;&nbsp;&nbsp;  protected class KFLogPanel extends LogPanel {</div>
<div>3149&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /**</div>
<div>3150&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>3151&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>3152&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    private static final long serialVersionUID = -2224509243343105276L;</div>
<div>3153&emsp;&emsp;</div>
<div>3154&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public synchronized void</div>
<div>3155&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      setMessageOnAll(boolean mainKFLine, String message) {</div>
<div>3156&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (String key : m_tableIndexes.keySet()) {</div>
<div>3157&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!mainKFLine && key.equals("[KnowledgeFlow]")) {</div>
<div>3158&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          continue;</div>
<div>3159&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3160&emsp;&emsp;</div>
<div>3161&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String tm = key + "|" + message;</div>
<div>3162&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        statusMessage(tm);</div>
<div>3163&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3164&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3165&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3166&emsp;&emsp;</div>
<div>3167&emsp;&emsp;&nbsp;&nbsp;  protected KFLogPanel m_logPanel = null; // new LogPanel();//new LogPanel(null,</div>
<div>3168&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                          // true);</div>
<div>3169&emsp;&emsp;</div>
<div>3170&emsp;&emsp;&nbsp;&nbsp;  /** Toolbar to hold the perspective buttons */</div>
<div>3171&emsp;&emsp;&nbsp;&nbsp;  protected JToolBar m_perspectiveToolBar = new JToolBar(JToolBar.HORIZONTAL);</div>
<div>3172&emsp;&emsp;</div>
<div>3173&emsp;&emsp;&nbsp;&nbsp;  /** Panel to hold the perspectives toolbar and config button */</div>
<div>3174&emsp;&emsp;&nbsp;&nbsp;  protected JPanel m_configAndPerspectives;</div>
<div>3175&emsp;&emsp;</div>
<div>3176&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3177&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Whether the perspectives toolbar is visible at present (will never be</div>
<div>3178&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * visible if there are no plugin perspectives installed)</div>
<div>3179&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3180&emsp;&emsp;&nbsp;&nbsp;  protected boolean m_configAndPerspectivesVisible = true;</div>
<div>3181&emsp;&emsp;</div>
<div>3182&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3183&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Button group to manage all perspective toggle buttons</div>
<div>3184&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3185&emsp;&emsp;&nbsp;&nbsp;  private final ButtonGroup m_perspectiveGroup = new ButtonGroup();</div>
<div>3186&emsp;&emsp;</div>
<div>3187&emsp;&emsp;&nbsp;&nbsp;  /** Component that holds the currently visible perspective */</div>
<div>3188&emsp;&emsp;&nbsp;&nbsp;  protected JPanel m_perspectiveHolder;</div>
<div>3189&emsp;&emsp;</div>
<div>3190&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3191&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Holds the list of currently loaded perspectives. Element at 0 is always the</div>
<div>3192&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * main KF data mining flow perspective</div>
<div>3193&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3194&emsp;&emsp;&nbsp;&nbsp;  protected List&#60;KFPerspective> m_perspectives = new ArrayList&#60;KFPerspective>();</div>
<div>3195&emsp;&emsp;</div>
<div>3196&emsp;&emsp;&nbsp;&nbsp;  /** Thread for loading data for perspectives */</div>
<div>3197&emsp;&emsp;&nbsp;&nbsp;  protected Thread m_perspectiveDataLoadThread = null;</div>
<div>3198&emsp;&emsp;</div>
<div>3199&emsp;&emsp;&nbsp;&nbsp;  protected AttributeSelectionPanel m_perspectiveConfigurer;</div>
<div>3200&emsp;&emsp;</div>
<div>3201&emsp;&emsp;&nbsp;&nbsp;  /** Shortcut to the main perspective */</div>
<div>3202&emsp;&emsp;&nbsp;&nbsp;  protected MainKFPerspective m_mainKFPerspective;</div>
<div>3203&emsp;&emsp;</div>
<div>3204&emsp;&emsp;&nbsp;&nbsp;  protected BeanContextSupport m_bcSupport = new BeanContextSupport();</div>
<div>3205&emsp;&emsp;</div>
<div>3206&emsp;&emsp;&nbsp;&nbsp;  /** the extension for the serialized setups (Java serialization) */</div>
<div>3207&emsp;&emsp;&nbsp;&nbsp;  public final static String FILE_EXTENSION = ".kf";</div>
<div>3208&emsp;&emsp;</div>
<div>3209&emsp;&emsp;&nbsp;&nbsp;  /** the extension for the serialized setups (Java serialization) */</div>
<div>3210&emsp;&emsp;&nbsp;&nbsp;  public final static String FILE_EXTENSION_XML = ".kfml";</div>
<div>3211&emsp;&emsp;</div>
<div>3212&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3213&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * A filter to ensure only KnowledgeFlow files in binary format get shown in</div>
<div>3214&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * the chooser</div>
<div>3215&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3216&emsp;&emsp;&nbsp;&nbsp;  protected FileFilter m_KfFilter = new ExtensionFileFilter(FILE_EXTENSION,</div>
<div>3217&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    "Binary KnowledgeFlow configuration files (*" + FILE_EXTENSION + ")");</div>
<div>3218&emsp;&emsp;</div>
<div>3219&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3220&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * A filter to ensure only KnowledgeFlow files in KOML format get shown in the</div>
<div>3221&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * chooser</div>
<div>3222&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3223&emsp;&emsp;&nbsp;&nbsp;  protected FileFilter m_KOMLFilter = new ExtensionFileFilter(</div>
<div>3224&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    KOML.FILE_EXTENSION + "kf", "XML KnowledgeFlow configuration files (*"</div>
<div>3225&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      + KOML.FILE_EXTENSION + "kf)");</div>
<div>3226&emsp;&emsp;</div>
<div>3227&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3228&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * A filter to ensure only KnowledgeFlow files in XStream format get shown in</div>
<div>3229&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * the chooser</div>
<div>3230&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3231&emsp;&emsp;&nbsp;&nbsp;  protected FileFilter m_XStreamFilter = new ExtensionFileFilter(</div>
<div>3232&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    XStream.FILE_EXTENSION + "kf", "XML KnowledgeFlow configuration files (*"</div>
<div>3233&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      + XStream.FILE_EXTENSION + "kf)");</div>
<div>3234&emsp;&emsp;</div>
<div>3235&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3236&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * A filter to ensure only KnowledgeFlow layout files in XML format get shown</div>
<div>3237&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * in the chooser</div>
<div>3238&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3239&emsp;&emsp;&nbsp;&nbsp;  protected FileFilter m_XMLFilter = new ExtensionFileFilter(</div>
<div>3240&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    FILE_EXTENSION_XML, "XML KnowledgeFlow layout files (*"</div>
<div>3241&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      + FILE_EXTENSION_XML + ")");</div>
<div>3242&emsp;&emsp;</div>
<div>3243&emsp;&emsp;&nbsp;&nbsp;  /** the scrollbar increment of the layout scrollpane */</div>
<div>3244&emsp;&emsp;&nbsp;&nbsp;  protected int m_ScrollBarIncrementLayout = 20;</div>
<div>3245&emsp;&emsp;</div>
<div>3246&emsp;&emsp;&nbsp;&nbsp;  /** the scrollbar increment of the components scrollpane */</div>
<div>3247&emsp;&emsp;&nbsp;&nbsp;  protected int m_ScrollBarIncrementComponents = 50;</div>
<div>3248&emsp;&emsp;</div>
<div>3249&emsp;&emsp;&nbsp;&nbsp;  /** the flow layout width */</div>
<div>3250&emsp;&emsp;&nbsp;&nbsp;  protected int m_FlowWidth = 2560;</div>
<div>3251&emsp;&emsp;</div>
<div>3252&emsp;&emsp;&nbsp;&nbsp;  /** the flow layout height */</div>
<div>3253&emsp;&emsp;&nbsp;&nbsp;  protected int m_FlowHeight = 1440;</div>
<div>3254&emsp;&emsp;</div>
<div>3255&emsp;&emsp;&nbsp;&nbsp;  /** the preferred file extension */</div>
<div>3256&emsp;&emsp;&nbsp;&nbsp;  protected String m_PreferredExtension = FILE_EXTENSION;</div>
<div>3257&emsp;&emsp;</div>
<div>3258&emsp;&emsp;&nbsp;&nbsp;  /** whether to store the user components in XML or in binary format */</div>
<div>3259&emsp;&emsp;&nbsp;&nbsp;  protected boolean m_UserComponentsInXML = false;</div>
<div>3260&emsp;&emsp;</div>
<div>3261&emsp;&emsp;&nbsp;&nbsp;  /** Environment variables for the current flow */</div>
<div>3262&emsp;&emsp;&nbsp;&nbsp;  protected Environment m_flowEnvironment = new Environment();</div>
<div>3263&emsp;&emsp;</div>
<div>3264&emsp;&emsp;&nbsp;&nbsp;  /** Palette of components stored in a JTree */</div>
<div>3265&emsp;&emsp;&nbsp;&nbsp;  protected JTree m_componentTree;</div>
<div>3266&emsp;&emsp;</div>
<div>3267&emsp;&emsp;&nbsp;&nbsp;  /** The node of the JTree that holds "user" (metabean) components */</div>
<div>3268&emsp;&emsp;&nbsp;&nbsp;  protected DefaultMutableTreeNode m_userCompNode;</div>
<div>3269&emsp;&emsp;</div>
<div>3270&emsp;&emsp;&nbsp;&nbsp;  /** The clip board */</div>
<div>3271&emsp;&emsp;&nbsp;&nbsp;  protected StringBuffer m_pasteBuffer;</div>
<div>3272&emsp;&emsp;</div>
<div>3273&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3274&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Set the environment variables to use. NOTE: loading a new layout resets</div>
<div>3275&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * back to the default set of variables</div>
<div>3276&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>3277&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param env</div>
<div>3278&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3279&emsp;&emsp;&nbsp;&nbsp;  public void setEnvironment(Environment env) {</div>
<div>3280&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_flowEnvironment = env;</div>
<div>3281&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    setEnvironment();</div>
<div>3282&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3283&emsp;&emsp;</div>
<div>3284&emsp;&emsp;&nbsp;&nbsp;  private void setEnvironment() {</div>
<div>3285&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // pass m_flowEnvironment to all components</div>
<div>3286&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // that implement EnvironmentHandler</div>
<div>3287&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> beans = BeanInstance.getBeanInstances(m_mainKFPerspective</div>
<div>3288&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .getCurrentTabIndex());</div>
<div>3289&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>3290&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Object temp = ((BeanInstance) beans.elementAt(i)).getBean();</div>
<div>3291&emsp;&emsp;</div>
<div>3292&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (temp instanceof EnvironmentHandler) {</div>
<div>3293&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((EnvironmentHandler) temp).setEnvironment(m_flowEnvironment);</div>
<div>3294&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3295&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3296&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3297&emsp;&emsp;</div>
<div>3298&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3299&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Creates a new &#60;code>KnowledgeFlowApp&#60;/code> instance.</div>
<div>3300&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3301&emsp;&emsp;&nbsp;&nbsp;  // modifications by Zerbetto</div>
<div>3302&emsp;&emsp;&nbsp;&nbsp;  // public KnowledgeFlowApp() {</div>
<div>3303&emsp;&emsp;&nbsp;&nbsp;  public KnowledgeFlowApp(boolean showFileMenu) {</div>
<div>3304&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (BeansProperties.BEAN_PROPERTIES == null) {</div>
<div>3305&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      loadProperties();</div>
<div>3306&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      init();</div>
<div>3307&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3308&emsp;&emsp;</div>
<div>3309&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_showFileMenu = showFileMenu;</div>
<div>3310&emsp;&emsp;</div>
<div>3311&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // end modifications by Zerbetto</div>
<div>3312&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // Grab a fontmetrics object</div>
<div>3313&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    JWindow temp = new JWindow();</div>
<div>3314&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    temp.setVisible(true);</div>
<div>3315&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    temp.getGraphics().setFont(new Font(null, Font.PLAIN, 9));</div>
<div>3316&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_fontM = temp.getGraphics().getFontMetrics();</div>
<div>3317&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    temp.setVisible(false);</div>
<div>3318&emsp;&emsp;</div>
<div>3319&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // some GUI defaults</div>
<div>3320&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>3321&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_ScrollBarIncrementLayout = Integer</div>
<div>3322&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .parseInt(BeansProperties.BEAN_PROPERTIES.getProperty(</div>
<div>3323&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          "ScrollBarIncrementLayout", "" + m_ScrollBarIncrementLayout));</div>
<div>3324&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_ScrollBarIncrementComponents = Integer</div>
<div>3325&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .parseInt(BeansProperties.BEAN_PROPERTIES.getProperty(</div>
<div>3326&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          "ScrollBarIncrementComponents", "" + m_ScrollBarIncrementComponents));</div>
<div>3327&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_FlowWidth = Integer.parseInt(BeansProperties.BEAN_PROPERTIES</div>
<div>3328&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .getProperty("FlowWidth", "" + m_FlowWidth));</div>
<div>3329&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_FlowHeight = Integer.parseInt(BeansProperties.BEAN_PROPERTIES</div>
<div>3330&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .getProperty("FlowHeight", "" + m_FlowHeight));</div>
<div>3331&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_PreferredExtension = BeansProperties.BEAN_PROPERTIES.getProperty(</div>
<div>3332&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        "PreferredExtension", m_PreferredExtension);</div>
<div>3333&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_UserComponentsInXML = Boolean.valueOf(</div>
<div>3334&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeansProperties.BEAN_PROPERTIES.getProperty("UserComponentsInXML", ""</div>
<div>3335&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + m_UserComponentsInXML)).booleanValue();</div>
<div>3336&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>3337&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ex.printStackTrace();</div>
<div>3338&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3339&emsp;&emsp;</div>
<div>3340&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // FileChooser</div>
<div>3341&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_FileChooser.addChoosableFileFilter(m_KfFilter);</div>
<div>3342&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (KOML.isPresent()) {</div>
<div>3343&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_FileChooser.addChoosableFileFilter(m_KOMLFilter);</div>
<div>3344&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3345&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (XStream.isPresent()) {</div>
<div>3346&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_FileChooser.addChoosableFileFilter(m_XStreamFilter);</div>
<div>3347&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3348&emsp;&emsp;</div>
<div>3349&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_FileChooser.addChoosableFileFilter(m_XMLFilter);</div>
<div>3350&emsp;&emsp;</div>
<div>3351&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_PreferredExtension.equals(FILE_EXTENSION_XML)) {</div>
<div>3352&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_FileChooser.setFileFilter(m_XMLFilter);</div>
<div>3353&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } else if (KOML.isPresent()</div>
<div>3354&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      && m_PreferredExtension.equals(KOML.FILE_EXTENSION + "kf")) {</div>
<div>3355&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_FileChooser.setFileFilter(m_KOMLFilter);</div>
<div>3356&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } else if (XStream.isPresent()</div>
<div>3357&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      && m_PreferredExtension.equals(XStream.FILE_EXTENSION + "kf")) {</div>
<div>3358&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_FileChooser.setFileFilter(m_XStreamFilter);</div>
<div>3359&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } else {</div>
<div>3360&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_FileChooser.setFileFilter(m_KfFilter);</div>
<div>3361&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3362&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_FileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);</div>
<div>3363&emsp;&emsp;</div>
<div>3364&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_bcSupport.setDesignTime(true);</div>
<div>3365&emsp;&emsp;</div>
<div>3366&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_perspectiveHolder = new JPanel();</div>
<div>3367&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_perspectiveHolder.setLayout(new BorderLayout());</div>
<div>3368&emsp;&emsp;</div>
<div>3369&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // TODO North will hold main perspective toggle buttons</div>
<div>3370&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // WEST will hold JTree - perhaps not</div>
<div>3371&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // CENTER will hold perspective</div>
<div>3372&emsp;&emsp;</div>
<div>3373&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>3374&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * JPanel p2 = new JPanel(); p2.setLayout(new BorderLayout());</div>
<div>3375&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>3376&emsp;&emsp;</div>
<div>3377&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_mainKFPerspective = new MainKFPerspective();</div>
<div>3378&emsp;&emsp;</div>
<div>3379&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // m_perspectiveHolder.add(m_mainKFPerspective, BorderLayout.CENTER);</div>
<div>3380&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_perspectives.add(m_mainKFPerspective);</div>
<div>3381&emsp;&emsp;</div>
<div>3382&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // mainPanel.add(m_perspectiveHolder, BorderLayout.CENTER);</div>
<div>3383&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    setLayout(new BorderLayout());</div>
<div>3384&emsp;&emsp;</div>
<div>3385&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    add(m_perspectiveHolder, BorderLayout.CENTER);</div>
<div>3386&emsp;&emsp;</div>
<div>3387&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // setUpToolBars(p2);</div>
<div>3388&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // setUpToolsAndJTree(m_mainKFPerspective);</div>
<div>3389&emsp;&emsp;</div>
<div>3390&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_perspectiveHolder.add(m_mainKFPerspective, BorderLayout.CENTER);</div>
<div>3391&emsp;&emsp;</div>
<div>3392&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_pluginPerspectiveLookup.size() > 0) {</div>
<div>3393&emsp;&emsp;</div>
<div>3394&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // add the main perspective first</div>
<div>3395&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String titleM = m_mainKFPerspective.getPerspectiveTitle();</div>
<div>3396&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Icon icon = m_mainKFPerspective.getPerspectiveIcon();</div>
<div>3397&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JToggleButton tBut = new JToggleButton(titleM, icon, true);</div>
<div>3398&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tBut.addActionListener(new ActionListener() {</div>
<div>3399&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>3400&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>3401&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          KFPerspective current = (KFPerspective) m_perspectiveHolder</div>
<div>3402&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getComponent(0);</div>
<div>3403&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          current.setActive(false);</div>
<div>3404&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_perspectiveHolder.remove(0);</div>
<div>3405&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_perspectiveHolder.add((JComponent) m_perspectives.get(0),</div>
<div>3406&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            BorderLayout.CENTER);</div>
<div>3407&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_perspectives.get(0).setActive(true);</div>
<div>3408&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // KnowledgeFlowApp.this.invalidate();</div>
<div>3409&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          KnowledgeFlowApp.this.revalidate();</div>
<div>3410&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          KnowledgeFlowApp.this.repaint();</div>
<div>3411&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          notifyIsDirty();</div>
<div>3412&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3413&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>3414&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveToolBar.add(tBut);</div>
<div>3415&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveGroup.add(tBut);</div>
<div>3416&emsp;&emsp;</div>
<div>3417&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // set up the perspective toolbar toggle buttons</div>
<div>3418&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // first load the perspectives list in sorted order (kf perspective</div>
<div>3419&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // is always at index 0)</div>
<div>3420&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      setupUserPerspectives();</div>
<div>3421&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3422&emsp;&emsp;</div>
<div>3423&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_pluginPerspectiveLookup.size() > 0) {</div>
<div>3424&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_configAndPerspectives = new JPanel();</div>
<div>3425&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_configAndPerspectives.setLayout(new BorderLayout());</div>
<div>3426&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_configAndPerspectives.add(m_perspectiveToolBar, BorderLayout.CENTER);</div>
<div>3427&emsp;&emsp;</div>
<div>3428&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      try {</div>
<div>3429&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Properties visible = Utils</div>
<div>3430&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .readProperties(BeansProperties.VISIBLE_PERSPECTIVES_PROPERTIES_FILE);</div>
<div>3431&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Enumeration&#60;?> keys = visible.propertyNames();</div>
<div>3432&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (keys.hasMoreElements()) {</div>
<div>3433&emsp;&emsp;</div>
<div>3434&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String toolBarIsVisible =</div>
<div>3435&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            visible</div>
<div>3436&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .getProperty("weka.gui.beans.KnowledgeFlow.PerspectiveToolBarVisisble");</div>
<div>3437&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (toolBarIsVisible != null && toolBarIsVisible.length() > 0) {</div>
<div>3438&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_configAndPerspectivesVisible = toolBarIsVisible</div>
<div>3439&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .equalsIgnoreCase("yes");</div>
<div>3440&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>3441&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3442&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } catch (Exception ex) {</div>
<div>3443&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        System.err</div>
<div>3444&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .println("Problem reading visible perspectives property file");</div>
<div>3445&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ex.printStackTrace();</div>
<div>3446&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3447&emsp;&emsp;</div>
<div>3448&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // add the perspectives toolbar</div>
<div>3449&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // does the user want it visible?</div>
<div>3450&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_configAndPerspectivesVisible) {</div>
<div>3451&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        add(m_configAndPerspectives, BorderLayout.NORTH);</div>
<div>3452&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3453&emsp;&emsp;</div>
<div>3454&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JButton configB = new JButton(new ImageIcon(</div>
<div>3455&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        loadImage(BeanVisual.ICON_PATH + "cog.png")));</div>
<div>3456&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      configB.setBorder(BorderFactory.createEmptyBorder(0, 5, 0, 1));</div>
<div>3457&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      configB.setToolTipText("Enable/disable perspectives");</div>
<div>3458&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_configAndPerspectives.add(configB, BorderLayout.WEST);</div>
<div>3459&emsp;&emsp;</div>
<div>3460&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      configB.addActionListener(new ActionListener() {</div>
<div>3461&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>3462&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>3463&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (!Utils</div>
<div>3464&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getDontShowDialog("weka.gui.beans.KnowledgeFlow.PerspectiveInfo")) {</div>
<div>3465&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            JCheckBox dontShow =</div>
<div>3466&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              new JCheckBox("Do not show this message again");</div>
<div>3467&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Object[] stuff = new Object[2];</div>
<div>3468&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            stuff[0] =</div>
<div>3469&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "Perspectives are environments that take over the\n"</div>
<div>3470&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "Knowledge Flow UI and provide major additional functionality.\n"</div>
<div>3471&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "Many perspectives will operate on a set of instances. Instances\n"</div>
<div>3472&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "Can be sent to a perspective by placing a DataSource on the\n"</div>
<div>3473&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "layout canvas, configuring it and then selecting \"Send to perspective\"\n"</div>
<div>3474&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "from the contextual popup menu that appears when you right-click on\n"</div>
<div>3475&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "it. Several perspectives are built in to the Knowledge Flow, others\n"</div>
<div>3476&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "can be installed via the package manager.\n";</div>
<div>3477&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            stuff[1] = dontShow;</div>
<div>3478&emsp;&emsp;</div>
<div>3479&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            JOptionPane.showMessageDialog(KnowledgeFlowApp.this, stuff,</div>
<div>3480&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "Perspective information", JOptionPane.OK_OPTION);</div>
<div>3481&emsp;&emsp;</div>
<div>3482&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (dontShow.isSelected()) {</div>
<div>3483&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              try {</div>
<div>3484&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                Utils</div>
<div>3485&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  .setDontShowDialog("weka.gui.beans.KnowledgeFlow.PerspectiveInfo");</div>
<div>3486&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } catch (Exception ex) {</div>
<div>3487&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // quietly ignore</div>
<div>3488&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>3489&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3490&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>3491&emsp;&emsp;</div>
<div>3492&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          popupPerspectiveConfigurer();</div>
<div>3493&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3494&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>3495&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3496&emsp;&emsp;</div>
<div>3497&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // set main perspective on all cached perspectives</div>
<div>3498&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (String pName : m_perspectiveCache.keySet()) {</div>
<div>3499&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveCache.get(pName).setMainKFPerspective(m_mainKFPerspective);</div>
<div>3500&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3501&emsp;&emsp;</div>
<div>3502&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    loadUserComponents();</div>
<div>3503&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    clearLayout(); // add an initial "Untitled" tab</div>
<div>3504&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3505&emsp;&emsp;</div>
<div>3506&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>3507&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Gets the main knowledge flow perspective</div>
<div>3508&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>3509&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @return the main knowledge flow perspective</div>
<div>3510&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>3511&emsp;&emsp;&nbsp;&nbsp;  public MainKFPerspective getMainPerspective() {</div>
<div>3512&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return m_mainKFPerspective;</div>
<div>3513&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3514&emsp;&emsp;</div>
<div>3515&emsp;&emsp;&nbsp;&nbsp;  private void popupPerspectiveConfigurer() {</div>
<div>3516&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_perspectiveConfigurer == null) {</div>
<div>3517&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveConfigurer = new AttributeSelectionPanel(true, true, true,</div>
<div>3518&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        true);</div>
<div>3519&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3520&emsp;&emsp;</div>
<div>3521&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_firstUserComponentOpp) {</div>
<div>3522&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      installWindowListenerForSavingUserStuff();</div>
<div>3523&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_firstUserComponentOpp = false;</div>
<div>3524&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3525&emsp;&emsp;</div>
<div>3526&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    ArrayList&#60;Attribute> atts = new ArrayList&#60;Attribute>();</div>
<div>3527&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    final ArrayList&#60;String> pClasses = new ArrayList&#60;String>();</div>
<div>3528&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    SortedSet&#60;String> sortedPerspectives = new TreeSet&#60;String>();</div>
<div>3529&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (String clName : m_pluginPerspectiveLookup.keySet()) {</div>
<div>3530&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      sortedPerspectives.add(clName);</div>
<div>3531&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3532&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (String clName : sortedPerspectives) {</div>
<div>3533&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      pClasses.add(clName);</div>
<div>3534&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String pName = m_pluginPerspectiveLookup.get(clName);</div>
<div>3535&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      atts.add(new Attribute(pName));</div>
<div>3536&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3537&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Instances perspectiveInstances = new Instances("Perspectives", atts, 1);</div>
<div>3538&emsp;&emsp;</div>
<div>3539&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean[] selectedPerspectives = new boolean[perspectiveInstances</div>
<div>3540&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .numAttributes()];</div>
<div>3541&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (String selected : BeansProperties.VISIBLE_PERSPECTIVES) {</div>
<div>3542&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String pName = m_pluginPerspectiveLookup.get(selected);</div>
<div>3543&emsp;&emsp;</div>
<div>3544&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // check here - just in case the user has uninstalled/deleted a plugin</div>
<div>3545&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // perspective since the last time that the user-selected visible</div>
<div>3546&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // perspectives</div>
<div>3547&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // list was written out to the props file</div>
<div>3548&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (pName != null) {</div>
<div>3549&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int index = perspectiveInstances.attribute(pName).index();</div>
<div>3550&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        selectedPerspectives[index] = true;</div>
<div>3551&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3552&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3553&emsp;&emsp;</div>
<div>3554&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_perspectiveConfigurer.setInstances(perspectiveInstances);</div>
<div>3555&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>3556&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveConfigurer.setSelectedAttributes(selectedPerspectives);</div>
<div>3557&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>3558&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ex.printStackTrace();</div>
<div>3559&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return;</div>
<div>3560&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3561&emsp;&emsp;</div>
<div>3562&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    final JDialog d = new JDialog(</div>
<div>3563&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      (JFrame) KnowledgeFlowApp.this.getTopLevelAncestor(),</div>
<div>3564&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      "Manage Perspectives", ModalityType.DOCUMENT_MODAL);</div>
<div>3565&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    d.setLayout(new BorderLayout());</div>
<div>3566&emsp;&emsp;</div>
<div>3567&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    JPanel holder = new JPanel();</div>
<div>3568&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    holder.setLayout(new BorderLayout());</div>
<div>3569&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    holder.add(m_perspectiveConfigurer, BorderLayout.CENTER);</div>
<div>3570&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    JButton okBut = new JButton("OK");</div>
<div>3571&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    JButton cancelBut = new JButton("Cancel");</div>
<div>3572&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    JPanel butHolder = new JPanel();</div>
<div>3573&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    butHolder.setLayout(new GridLayout(1, 2));</div>
<div>3574&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    butHolder.add(okBut);</div>
<div>3575&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    butHolder.add(cancelBut);</div>
<div>3576&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    holder.add(butHolder, BorderLayout.SOUTH);</div>
<div>3577&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    okBut.addActionListener(new ActionListener() {</div>
<div>3578&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>3579&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void actionPerformed(ActionEvent e) {</div>
<div>3580&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeansProperties.VISIBLE_PERSPECTIVES = new TreeSet&#60;String>();</div>
<div>3581&emsp;&emsp;</div>
<div>3582&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int[] selected = m_perspectiveConfigurer.getSelectedAttributes();</div>
<div>3583&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int element : selected) {</div>
<div>3584&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String selectedClassName = pClasses.get(element);</div>
<div>3585&emsp;&emsp;</div>
<div>3586&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // first check to see if it's in the cache already</div>
<div>3587&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (m_perspectiveCache.get(selectedClassName) == null) {</div>
<div>3588&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // need to instantiate and add to the cache</div>
<div>3589&emsp;&emsp;</div>
<div>3590&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            try {</div>
<div>3591&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              Object p = WekaPackageClassLoaderManager.objectForName(selectedClassName);</div>
<div>3592&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // Object p = Class.forName(selectedClassName).newInstance();</div>
<div>3593&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (p instanceof KFPerspective && p instanceof JPanel) {</div>
<div>3594&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                String title = ((KFPerspective) p).getPerspectiveTitle();</div>
<div>3595&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                weka.core.logging.Logger.log(</div>
<div>3596&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  weka.core.logging.Logger.Level.INFO,</div>
<div>3597&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  "[KnowledgeFlow] loaded perspective: "</div>
<div>3598&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    + title);</div>
<div>3599&emsp;&emsp;</div>
<div>3600&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                ((KFPerspective) p).setLoaded(true);</div>
<div>3601&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                ((KFPerspective) p).setMainKFPerspective(m_mainKFPerspective);</div>
<div>3602&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                m_perspectiveCache.put(selectedClassName, (KFPerspective) p);</div>
<div>3603&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>3604&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            } catch (Exception ex) {</div>
<div>3605&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              ex.printStackTrace();</div>
<div>3606&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3607&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>3608&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          BeansProperties.VISIBLE_PERSPECTIVES.add(selectedClassName);</div>
<div>3609&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3610&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        setupUserPerspectives();</div>
<div>3611&emsp;&emsp;</div>
<div>3612&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        d.dispose();</div>
<div>3613&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3614&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    });</div>
<div>3615&emsp;&emsp;</div>
<div>3616&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    cancelBut.addActionListener(new ActionListener() {</div>
<div>3617&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>3618&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void actionPerformed(ActionEvent e) {</div>
<div>3619&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        d.dispose();</div>
<div>3620&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3621&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    });</div>
<div>3622&emsp;&emsp;</div>
<div>3623&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    d.getContentPane().add(holder, BorderLayout.CENTER);</div>
<div>3624&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>3625&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * d.addWindowListener(new java.awt.event.WindowAdapter() { public void</div>
<div>3626&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * windowClosing(java.awt.event.WindowEvent e) {</div>
<div>3627&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>3628&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>3629&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * d.dispose(); } });</div>
<div>3630&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>3631&emsp;&emsp;</div>
<div>3632&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    d.pack();</div>
<div>3633&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    d.setVisible(true);</div>
<div>3634&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3635&emsp;&emsp;</div>
<div>3636&emsp;&emsp;&nbsp;&nbsp;  private void setupUserPerspectives() {</div>
<div>3637&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // first clear the toolbar</div>
<div>3638&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = m_perspectiveToolBar.getComponentCount() - 1; i > 0; i--) {</div>
<div>3639&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveToolBar.remove(i);</div>
<div>3640&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectives.remove(i);</div>
<div>3641&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3642&emsp;&emsp;</div>
<div>3643&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int index = 1;</div>
<div>3644&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (String c : BeansProperties.VISIBLE_PERSPECTIVES) {</div>
<div>3645&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      KFPerspective toAdd = m_perspectiveCache.get(c);</div>
<div>3646&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (toAdd instanceof JComponent) {</div>
<div>3647&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        toAdd.setLoaded(true);</div>
<div>3648&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_perspectives.add(toAdd);</div>
<div>3649&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String titleM = toAdd.getPerspectiveTitle();</div>
<div>3650&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Icon icon = toAdd.getPerspectiveIcon();</div>
<div>3651&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        JToggleButton tBut = null;</div>
<div>3652&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (icon != null) {</div>
<div>3653&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          tBut = new JToggleButton(titleM, icon, false);</div>
<div>3654&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else {</div>
<div>3655&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          tBut = new JToggleButton(titleM, false);</div>
<div>3656&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3657&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        tBut.setToolTipText(toAdd.getPerspectiveTipText());</div>
<div>3658&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final int theIndex = index;</div>
<div>3659&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        tBut.addActionListener(new ActionListener() {</div>
<div>3660&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>3661&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>3662&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            setActivePerspective(theIndex);</div>
<div>3663&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>3664&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>3665&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_perspectiveToolBar.add(tBut);</div>
<div>3666&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_perspectiveGroup.add(tBut);</div>
<div>3667&emsp;&emsp;</div>
<div>3668&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        index++;</div>
<div>3669&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3670&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3671&emsp;&emsp;</div>
<div>3672&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    KFPerspective current = (KFPerspective) m_perspectiveHolder.getComponent(0);</div>
<div>3673&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (current != m_mainKFPerspective) {</div>
<div>3674&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      current.setActive(false);</div>
<div>3675&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveHolder.remove(0);</div>
<div>3676&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveHolder.add(m_mainKFPerspective);</div>
<div>3677&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ((JToggleButton) m_perspectiveToolBar.getComponent(0)).setSelected(true);</div>
<div>3678&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3679&emsp;&emsp;</div>
<div>3680&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    revalidate();</div>
<div>3681&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    repaint();</div>
<div>3682&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    notifyIsDirty();</div>
<div>3683&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3684&emsp;&emsp;</div>
<div>3685&emsp;&emsp;&nbsp;&nbsp;  protected void setActivePerspective(int theIndex) {</div>
<div>3686&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (theIndex &#60; 0 || theIndex > m_perspectives.size() - 1) {</div>
<div>3687&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return;</div>
<div>3688&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3689&emsp;&emsp;</div>
<div>3690&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    KFPerspective current = (KFPerspective) m_perspectiveHolder.getComponent(0);</div>
<div>3691&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    current.setActive(false);</div>
<div>3692&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_perspectiveHolder.remove(0);</div>
<div>3693&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_perspectiveHolder.add((JComponent) m_perspectives.get(theIndex),</div>
<div>3694&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BorderLayout.CENTER);</div>
<div>3695&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_perspectives.get(theIndex).setActive(true);</div>
<div>3696&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    ((JToggleButton) m_perspectiveToolBar.getComponent(theIndex))</div>
<div>3697&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .setSelected(true);</div>
<div>3698&emsp;&emsp;</div>
<div>3699&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // KnowledgeFlowApp.this.invalidate();</div>
<div>3700&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    KnowledgeFlowApp.this.revalidate();</div>
<div>3701&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    KnowledgeFlowApp.this.repaint();</div>
<div>3702&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    notifyIsDirty();</div>
<div>3703&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3704&emsp;&emsp;</div>
<div>3705&emsp;&emsp;&nbsp;&nbsp;  private void snapSelectedToGrid() {</div>
<div>3706&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> v = m_mainKFPerspective.getSelectedBeans();</div>
<div>3707&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (v.size() > 0) {</div>
<div>3708&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; v.size(); i++) {</div>
<div>3709&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeanInstance b = (BeanInstance) v.get(i);</div>
<div>3710&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // if (!(b.getBean() instanceof Note)) {</div>
<div>3711&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int x = b.getX();</div>
<div>3712&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int y = b.getY();</div>
<div>3713&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        b.setXY(snapToGrid(x), snapToGrid(y));</div>
<div>3714&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // }</div>
<div>3715&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3716&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      revalidate();</div>
<div>3717&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_beanLayout.repaint();</div>
<div>3718&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      notifyIsDirty();</div>
<div>3719&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setEditedStatus(true);</div>
<div>3720&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3721&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3722&emsp;&emsp;</div>
<div>3723&emsp;&emsp;&nbsp;&nbsp;  private int snapToGrid(int val) {</div>
<div>3724&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int r = val % m_gridSpacing;</div>
<div>3725&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    val /= m_gridSpacing;</div>
<div>3726&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (r > (m_gridSpacing / 2)) {</div>
<div>3727&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      val++;</div>
<div>3728&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>3729&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    val *= m_gridSpacing;</div>
<div>3730&emsp;&emsp;</div>
<div>3731&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return val;</div>
<div>3732&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>3733&emsp;&emsp;</div>
<div>3734&emsp;&emsp;&nbsp;&nbsp;  private void configureBeanLayout(final BeanLayout layout) {</div>
<div>3735&emsp;&emsp;</div>
<div>3736&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    layout.setLayout(null);</div>
<div>3737&emsp;&emsp;</div>
<div>3738&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // handle mouse events</div>
<div>3739&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    layout.addMouseListener(new MouseAdapter() {</div>
<div>3740&emsp;&emsp;</div>
<div>3741&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>3742&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void mousePressed(MouseEvent me) {</div>
<div>3743&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        layout.requestFocusInWindow();</div>
<div>3744&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double z = m_layoutZoom / 100.0;</div>
<div>3745&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double px = me.getX();</div>
<div>3746&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double py = me.getY();</div>
<div>3747&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        py /= z;</div>
<div>3748&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        px /= z;</div>
<div>3749&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_toolBarBean == null) {</div>
<div>3750&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (((me.getModifiers() & InputEvent.BUTTON1_MASK) == InputEvent.BUTTON1_MASK)</div>
<div>3751&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            && m_mode == NONE) {</div>
<div>3752&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            /*</div>
<div>3753&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * BeanInstance bi = BeanInstance.findInstance(me.getPoint(),</div>
<div>3754&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * m_mainKFPerspective.getCurrentTabIndex());</div>
<div>3755&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             */</div>
<div>3756&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            BeanInstance bi = BeanInstance.findInstance(new Point((int) px,</div>
<div>3757&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              (int) py), m_mainKFPerspective.getCurrentTabIndex());</div>
<div>3758&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            JComponent bc = null;</div>
<div>3759&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (bi != null) {</div>
<div>3760&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              bc = (JComponent) (bi.getBean());</div>
<div>3761&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3762&emsp;&emsp;</div>
<div>3763&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (bc != null /* && (bc instanceof Visible) */) {</div>
<div>3764&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_editElement = bi;</div>
<div>3765&emsp;&emsp;</div>
<div>3766&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              /*</div>
<div>3767&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * m_oldX = me.getX(); m_oldY = me.getY();</div>
<div>3768&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               */</div>
<div>3769&emsp;&emsp;</div>
<div>3770&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_oldX = (int) px;</div>
<div>3771&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_oldY = (int) py;</div>
<div>3772&emsp;&emsp;</div>
<div>3773&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mode = MOVING;</div>
<div>3774&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3775&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (m_mode != MOVING) {</div>
<div>3776&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mode = SELECTING;</div>
<div>3777&emsp;&emsp;</div>
<div>3778&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              /*</div>
<div>3779&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * m_oldX = me.getX(); m_oldY = me.getY();</div>
<div>3780&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               */</div>
<div>3781&emsp;&emsp;</div>
<div>3782&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_oldX = (int) px;</div>
<div>3783&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_oldY = (int) py;</div>
<div>3784&emsp;&emsp;</div>
<div>3785&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_startX = m_oldX;</div>
<div>3786&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_startY = m_oldY;</div>
<div>3787&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              Graphics2D gx = (Graphics2D) layout.getGraphics();</div>
<div>3788&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              gx.setXORMode(java.awt.Color.white);</div>
<div>3789&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // gx.drawRect(m_oldX, m_oldY, m_oldX, m_oldY);</div>
<div>3790&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // gx.drawLine(m_startX, m_startY, m_startX, m_startY);</div>
<div>3791&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              gx.dispose();</div>
<div>3792&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mode = SELECTING;</div>
<div>3793&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3794&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>3795&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3796&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3797&emsp;&emsp;</div>
<div>3798&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>3799&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void mouseReleased(MouseEvent me) {</div>
<div>3800&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        layout.requestFocusInWindow();</div>
<div>3801&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_editElement != null && m_mode == MOVING) {</div>
<div>3802&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (m_snapToGridB.isSelected()) {</div>
<div>3803&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            int x = snapToGrid(m_editElement.getX());</div>
<div>3804&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            int y = snapToGrid(m_editElement.getY());</div>
<div>3805&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_editElement.setXY(x, y);</div>
<div>3806&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            snapSelectedToGrid();</div>
<div>3807&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>3808&emsp;&emsp;</div>
<div>3809&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_editElement = null;</div>
<div>3810&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          revalidate();</div>
<div>3811&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          layout.repaint();</div>
<div>3812&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mode = NONE;</div>
<div>3813&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3814&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_mode == SELECTING) {</div>
<div>3815&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          revalidate();</div>
<div>3816&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          layout.repaint();</div>
<div>3817&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mode = NONE;</div>
<div>3818&emsp;&emsp;</div>
<div>3819&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          double z = m_layoutZoom / 100.0;</div>
<div>3820&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          double px = me.getX();</div>
<div>3821&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          double py = me.getY();</div>
<div>3822&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          py /= z;</div>
<div>3823&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          px /= z;</div>
<div>3824&emsp;&emsp;</div>
<div>3825&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // highlightSubFlow(m_startX, m_startY, me.getX(), me.getY());</div>
<div>3826&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          highlightSubFlow(m_startX, m_startY, (int) px, (int) py);</div>
<div>3827&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3828&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>3829&emsp;&emsp;</div>
<div>3830&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>3831&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void mouseClicked(MouseEvent me) {</div>
<div>3832&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        layout.requestFocusInWindow();</div>
<div>3833&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Point p = me.getPoint();</div>
<div>3834&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Point np = new Point();</div>
<div>3835&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double z = m_layoutZoom / 100.0;</div>
<div>3836&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        np.setLocation(p.getX() / z, p.getY() / z);</div>
<div>3837&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeanInstance bi = BeanInstance.findInstance(np,</div>
<div>3838&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.getCurrentTabIndex());</div>
<div>3839&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_mode == ADDING || m_mode == NONE) {</div>
<div>3840&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // try and popup a context sensitive menu if we have</div>
<div>3841&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // been clicked over a bean.</div>
<div>3842&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (bi != null) {</div>
<div>3843&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            JComponent bc = (JComponent) bi.getBean();</div>
<div>3844&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // if we've been double clicked, then popup customizer</div>
<div>3845&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // as long as we're not a meta bean</div>
<div>3846&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (me.getClickCount() == 2 && !(bc instanceof MetaBean)) {</div>
<div>3847&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              try {</div>
<div>3848&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                Class&#60;?> custClass = Introspector.getBeanInfo(bc.getClass())</div>
<div>3849&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  .getBeanDescriptor().getCustomizerClass();</div>
<div>3850&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (custClass != null) {</div>
<div>3851&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  if (bc instanceof BeanCommon) {</div>
<div>3852&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    if (!((BeanCommon) bc).isBusy()</div>
<div>3853&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      && !m_mainKFPerspective.getExecuting()) {</div>
<div>3854&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      popupCustomizer(custClass, bc);</div>
<div>3855&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    }</div>
<div>3856&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  } else {</div>
<div>3857&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    popupCustomizer(custClass, bc);</div>
<div>3858&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>3859&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>3860&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } catch (IntrospectionException ex) {</div>
<div>3861&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                ex.printStackTrace();</div>
<div>3862&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>3863&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            } else if (((me.getModifiers() & InputEvent.BUTTON1_MASK) != InputEvent.BUTTON1_MASK)</div>
<div>3864&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              || me.isAltDown()) {</div>
<div>3865&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // doPopup(me.getPoint(), bi, me.getX(), me.getY());</div>
<div>3866&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              doPopup(me.getPoint(), bi, (int) (p.getX() / z),</div>
<div>3867&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                (int) (p.getY() / z));</div>
<div>3868&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              return;</div>
<div>3869&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            } else {</div>
<div>3870&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // just select this bean</div>
<div>3871&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              Vector&#60;Object> v = m_mainKFPerspective.getSelectedBeans();</div>
<div>3872&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (me.isShiftDown()) {</div>
<div>3873&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>3874&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                v = new Vector&#60;Object>();</div>
<div>3875&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>3876&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              v.add(bi);</div>
<div>3877&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mainKFPerspective.setSelectedBeans(v);</div>
<div>3878&emsp;&emsp;</div>
<div>3879&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              return;</div>
<div>3880&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3881&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } else {</div>
<div>3882&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (((me.getModifiers() & InputEvent.BUTTON1_MASK) != InputEvent.BUTTON1_MASK)</div>
<div>3883&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              || me.isAltDown()) {</div>
<div>3884&emsp;&emsp;</div>
<div>3885&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              double px = me.getX();</div>
<div>3886&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              double py = me.getY();</div>
<div>3887&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              py /= z;</div>
<div>3888&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              px /= z;</div>
<div>3889&emsp;&emsp;</div>
<div>3890&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // find connections if any close to this point</div>
<div>3891&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (!m_mainKFPerspective.getExecuting()) {</div>
<div>3892&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // rightClickCanvasPopup(me.getX(), me.getY());</div>
<div>3893&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                rightClickCanvasPopup((int) px, (int) py);</div>
<div>3894&emsp;&emsp;</div>
<div>3895&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                revalidate();</div>
<div>3896&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                repaint();</div>
<div>3897&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                notifyIsDirty();</div>
<div>3898&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>3899&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              return;</div>
<div>3900&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              /*</div>
<div>3901&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * int delta = 10; deleteConnectionPopup(BeanConnection.</div>
<div>3902&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * getClosestConnections(new Point(me.getX(), me.getY()), delta,</div>
<div>3903&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * m_mainKFPerspective.getCurrentTabIndex()), me.getX(),</div>
<div>3904&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               * me.getY());</div>
<div>3905&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;               */</div>
<div>3906&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            } else if (m_toolBarBean != null) {</div>
<div>3907&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // otherwise, if a toolbar button is active then</div>
<div>3908&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // add the component</div>
<div>3909&emsp;&emsp;</div>
<div>3910&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // snap to grid</div>
<div>3911&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              double x = me.getX();</div>
<div>3912&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              double y = me.getY();</div>
<div>3913&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              x /= z;</div>
<div>3914&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              y /= z;</div>
<div>3915&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (m_snapToGridB.isSelected()) {</div>
<div>3916&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // x = snapToGrid(me.getX());</div>
<div>3917&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                x = snapToGrid((int) x);</div>
<div>3918&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // y = snapToGrid(me.getY());</div>
<div>3919&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                y = snapToGrid((int) y);</div>
<div>3920&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>3921&emsp;&emsp;</div>
<div>3922&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              addUndoPoint();</div>
<div>3923&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (m_toolBarBean instanceof StringBuffer) {</div>
<div>3924&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // serialized user meta bean</div>
<div>3925&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                pasteFromClipboard((int) x, (int) y,</div>
<div>3926&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  (StringBuffer) m_toolBarBean, false);</div>
<div>3927&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                m_mode = NONE;</div>
<div>3928&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                KnowledgeFlowApp.this.setCursor(Cursor</div>
<div>3929&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  .getPredefinedCursor(Cursor.DEFAULT_CURSOR));</div>
<div>3930&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                m_toolBarBean = null;</div>
<div>3931&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>3932&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // saveLayout(m_mainKFPerspective.getCurrentTabIndex(), false);</div>
<div>3933&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                addComponent((int) x, (int) y);</div>
<div>3934&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>3935&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_componentTree.clearSelection();</div>
<div>3936&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mainKFPerspective.setEditedStatus(true);</div>
<div>3937&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3938&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>3939&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          revalidate();</div>
<div>3940&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          repaint();</div>
<div>3941&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          notifyIsDirty();</div>
<div>3942&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3943&emsp;&emsp;</div>
<div>3944&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double px = me.getX();</div>
<div>3945&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double py = me.getY();</div>
<div>3946&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        px /= z;</div>
<div>3947&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        py /= z;</div>
<div>3948&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_mode == PASTING && m_pasteBuffer.length() > 0) {</div>
<div>3949&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // pasteFromClipboard(me.getX(), me.getY(), m_pasteBuffer, true);</div>
<div>3950&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          pasteFromClipboard((int) px, (int) py, m_pasteBuffer, true);</div>
<div>3951&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mode = NONE;</div>
<div>3952&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          KnowledgeFlowApp.this.setCursor(Cursor</div>
<div>3953&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getPredefinedCursor(Cursor.DEFAULT_CURSOR));</div>
<div>3954&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          return;</div>
<div>3955&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>3956&emsp;&emsp;</div>
<div>3957&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_mode == CONNECTING) {</div>
<div>3958&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // turn off connecting points and remove connecting line</div>
<div>3959&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          layout.repaint();</div>
<div>3960&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Vector&#60;Object> beanInstances = BeanInstance</div>
<div>3961&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getBeanInstances(m_mainKFPerspective.getCurrentTabIndex());</div>
<div>3962&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          for (int i = 0; i &#60; beanInstances.size(); i++) {</div>
<div>3963&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            JComponent bean = (JComponent) ((BeanInstance) beanInstances</div>
<div>3964&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .elementAt(i)).getBean();</div>
<div>3965&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (bean instanceof Visible) {</div>
<div>3966&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              ((Visible) bean).getVisual().setDisplayConnectors(false);</div>
<div>3967&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3968&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>3969&emsp;&emsp;</div>
<div>3970&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (bi != null) {</div>
<div>3971&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            boolean doConnection = false;</div>
<div>3972&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (!(bi.getBean() instanceof BeanCommon)) {</div>
<div>3973&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              doConnection = true;</div>
<div>3974&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            } else {</div>
<div>3975&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // Give the target bean a chance to veto the proposed</div>
<div>3976&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // connection</div>
<div>3977&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (((BeanCommon) bi.getBean()).</div>
<div>3978&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // connectionAllowed(m_sourceEventSetDescriptor.getName())) {</div>
<div>3979&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                connectionAllowed(m_sourceEventSetDescriptor)) {</div>
<div>3980&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                doConnection = true;</div>
<div>3981&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>3982&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3983&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (doConnection) {</div>
<div>3984&emsp;&emsp;</div>
<div>3985&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              addUndoPoint();</div>
<div>3986&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // attempt to connect source and target beans</div>
<div>3987&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (bi.getBean() instanceof MetaBean) {</div>
<div>3988&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                BeanConnection.doMetaConnection(m_editElement, bi,</div>
<div>3989&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_sourceEventSetDescriptor, layout,</div>
<div>3990&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_mainKFPerspective.getCurrentTabIndex());</div>
<div>3991&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>3992&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                new BeanConnection(m_editElement, bi,</div>
<div>3993&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_sourceEventSetDescriptor, m_mainKFPerspective</div>
<div>3994&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    .getCurrentTabIndex());</div>
<div>3995&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>3996&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mainKFPerspective.setEditedStatus(true);</div>
<div>3997&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>3998&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            layout.repaint();</div>
<div>3999&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4000&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mode = NONE;</div>
<div>4001&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_editElement = null;</div>
<div>4002&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_sourceEventSetDescriptor = null;</div>
<div>4003&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4004&emsp;&emsp;</div>
<div>4005&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_mainKFPerspective.getSelectedBeans().size() > 0) {</div>
<div>4006&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.setSelectedBeans(new Vector&#60;Object>());</div>
<div>4007&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4008&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4009&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    });</div>
<div>4010&emsp;&emsp;</div>
<div>4011&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    layout.addMouseMotionListener(new MouseMotionAdapter() {</div>
<div>4012&emsp;&emsp;</div>
<div>4013&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>4014&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void mouseDragged(MouseEvent me) {</div>
<div>4015&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double z = m_layoutZoom / 100.0;</div>
<div>4016&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double px = me.getX();</div>
<div>4017&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double py = me.getY();</div>
<div>4018&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        px /= z;</div>
<div>4019&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        py /= z;</div>
<div>4020&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_editElement != null && m_mode == MOVING) {</div>
<div>4021&emsp;&emsp;</div>
<div>4022&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /*</div>
<div>4023&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * int deltaX = me.getX() - m_oldX; int deltaY = me.getY() - m_oldY;</div>
<div>4024&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>4025&emsp;&emsp;</div>
<div>4026&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          int deltaX = (int) px - m_oldX;</div>
<div>4027&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          int deltaY = (int) py - m_oldY;</div>
<div>4028&emsp;&emsp;</div>
<div>4029&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_editElement.setXY(m_editElement.getX() + deltaX,</div>
<div>4030&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_editElement.getY() + deltaY);</div>
<div>4031&emsp;&emsp;</div>
<div>4032&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (m_mainKFPerspective.getSelectedBeans().size() > 0) {</div>
<div>4033&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Vector&#60;Object> v = m_mainKFPerspective.getSelectedBeans();</div>
<div>4034&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            for (int i = 0; i &#60; v.size(); i++) {</div>
<div>4035&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              BeanInstance b = (BeanInstance) v.get(i);</div>
<div>4036&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (b != m_editElement) {</div>
<div>4037&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                b.setXY(b.getX() + deltaX, b.getY() + deltaY);</div>
<div>4038&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>4039&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>4040&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4041&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          layout.repaint();</div>
<div>4042&emsp;&emsp;</div>
<div>4043&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // note the new points</div>
<div>4044&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /*</div>
<div>4045&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * m_oldX = me.getX(); m_oldY = me.getY();</div>
<div>4046&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>4047&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_oldX = (int) px;</div>
<div>4048&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_oldY = (int) py;</div>
<div>4049&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.setEditedStatus(true);</div>
<div>4050&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4051&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_mode == SELECTING) {</div>
<div>4052&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          layout.repaint();</div>
<div>4053&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /*</div>
<div>4054&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * m_oldX = me.getX(); m_oldY = me.getY();</div>
<div>4055&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>4056&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_oldX = (int) px;</div>
<div>4057&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_oldY = (int) py;</div>
<div>4058&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4059&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4060&emsp;&emsp;</div>
<div>4061&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>4062&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void mouseMoved(MouseEvent e) {</div>
<div>4063&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double z = m_layoutZoom / 100.0;</div>
<div>4064&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double px = e.getX();</div>
<div>4065&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        double py = e.getY();</div>
<div>4066&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        px /= z;</div>
<div>4067&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        py /= z;</div>
<div>4068&emsp;&emsp;</div>
<div>4069&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_mode == CONNECTING) {</div>
<div>4070&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          layout.repaint();</div>
<div>4071&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // note the new coordinates</div>
<div>4072&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /*</div>
<div>4073&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * m_oldX = e.getX(); m_oldY = e.getY();</div>
<div>4074&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>4075&emsp;&emsp;</div>
<div>4076&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_oldX = (int) px;</div>
<div>4077&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_oldY = (int) py;</div>
<div>4078&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4079&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4080&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    });</div>
<div>4081&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4082&emsp;&emsp;</div>
<div>4083&emsp;&emsp;&nbsp;&nbsp;  private void setUpLogPanel(final LogPanel logPanel) {</div>
<div>4084&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    String date = (new SimpleDateFormat("EEEE, d MMMM yyyy"))</div>
<div>4085&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .format(new Date());</div>
<div>4086&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    logPanel.logMessage("Weka Knowledge Flow was written by Mark Hall");</div>
<div>4087&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    logPanel.logMessage("Weka Knowledge Flow");</div>
<div>4088&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    logPanel.logMessage("(c) 2002-" + Copyright.getToYear() + " "</div>
<div>4089&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      + Copyright.getOwner() + ", " + Copyright.getAddress());</div>
<div>4090&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    logPanel.logMessage("web: " + Copyright.getURL());</div>
<div>4091&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    logPanel.logMessage(date);</div>
<div>4092&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    logPanel</div>
<div>4093&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .statusMessage("@!@[KnowledgeFlow]|Welcome to the Weka Knowledge Flow");</div>
<div>4094&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    logPanel.getStatusTable().addMouseListener(new MouseAdapter() {</div>
<div>4095&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>4096&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void mouseClicked(MouseEvent e) {</div>
<div>4097&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (logPanel.getStatusTable().rowAtPoint(e.getPoint()) == 0) {</div>
<div>4098&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (((e.getModifiers() & InputEvent.BUTTON1_MASK) != InputEvent.BUTTON1_MASK)</div>
<div>4099&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            || e.isAltDown()) {</div>
<div>4100&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            System.gc();</div>
<div>4101&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Runtime currR = Runtime.getRuntime();</div>
<div>4102&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            long freeM = currR.freeMemory();</div>
<div>4103&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            long totalM = currR.totalMemory();</div>
<div>4104&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            long maxM = currR.maxMemory();</div>
<div>4105&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            logPanel</div>
<div>4106&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .logMessage("[KnowledgeFlow] Memory (free/total/max.) in bytes: "</div>
<div>4107&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + String.format("%,d", freeM) + " / "</div>
<div>4108&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + String.format("%,d", totalM) + " / "</div>
<div>4109&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + String.format("%,d", maxM));</div>
<div>4110&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            logPanel</div>
<div>4111&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .statusMessage("@!@[KnowledgeFlow]|Memory (free/total/max.) in bytes: "</div>
<div>4112&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + String.format("%,d", freeM)</div>
<div>4113&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + " / "</div>
<div>4114&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + String.format("%,d", totalM)</div>
<div>4115&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + " / "</div>
<div>4116&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + String.format("%,d", maxM));</div>
<div>4117&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4118&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4119&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4120&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    });</div>
<div>4121&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4122&emsp;&emsp;</div>
<div>4123&emsp;&emsp;&nbsp;&nbsp;  private Image loadImage(String path) {</div>
<div>4124&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Image pic = null;</div>
<div>4125&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // Modified by Zerbetto</div>
<div>4126&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // java.net.URL imageURL = ClassLoader.getSystemResource(path);</div>
<div>4127&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    java.net.URL imageURL = this.getClass().getClassLoader().getResource(path);</div>
<div>4128&emsp;&emsp;</div>
<div>4129&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // end modifications</div>
<div>4130&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (imageURL == null) {</div>
<div>4131&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      weka.core.logging.Logger.log(weka.core.logging.Logger.Level.WARNING,</div>
<div>4132&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        "Unable to load " + path);</div>
<div>4133&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } else {</div>
<div>4134&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      pic = Toolkit.getDefaultToolkit().getImage(imageURL);</div>
<div>4135&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4136&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return pic;</div>
<div>4137&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4138&emsp;&emsp;</div>
<div>4139&emsp;&emsp;&nbsp;&nbsp;  protected class RunThread extends Thread {</div>
<div>4140&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int m_flowIndex;</div>
<div>4141&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean m_sequential;</div>
<div>4142&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean m_wasUserStopped = false;</div>
<div>4143&emsp;&emsp;</div>
<div>4144&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public RunThread(boolean sequential) {</div>
<div>4145&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_sequential = sequential;</div>
<div>4146&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4147&emsp;&emsp;</div>
<div>4148&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @Override</div>
<div>4149&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void run() {</div>
<div>4150&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_flowIndex = m_mainKFPerspective.getCurrentTabIndex();</div>
<div>4151&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String flowName = m_mainKFPerspective.getTabTitle(m_flowIndex);</div>
<div>4152&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setExecuting(true);</div>
<div>4153&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getLogPanel(m_flowIndex).clearStatus();</div>
<div>4154&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getLogPanel(m_flowIndex).statusMessage(</div>
<div>4155&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        "@!@[KnowledgeFlow]|Executing...");</div>
<div>4156&emsp;&emsp;</div>
<div>4157&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      FlowRunner runner = new FlowRunner(false, false);</div>
<div>4158&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      runner.setStartSequentially(m_sequential);</div>
<div>4159&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      runner.setEnvironment(m_flowEnvironment);</div>
<div>4160&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      runner.setLog(m_logPanel);</div>
<div>4161&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Object> comps = BeanInstance.getBeanInstances(m_flowIndex);</div>
<div>4162&emsp;&emsp;</div>
<div>4163&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      runner.setFlows(comps);</div>
<div>4164&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      try {</div>
<div>4165&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        runner.run();</div>
<div>4166&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        runner.waitUntilFinished();</div>
<div>4167&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } catch (InterruptedException ie) {</div>
<div>4168&emsp;&emsp;</div>
<div>4169&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } catch (Exception ex) {</div>
<div>4170&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_logPanel.logMessage("An error occurred while running the flow: "</div>
<div>4171&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + ex.getMessage());</div>
<div>4172&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } finally {</div>
<div>4173&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_flowIndex >= m_mainKFPerspective.getNumTabs() - 1</div>
<div>4174&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          || !m_mainKFPerspective.getTabTitle(m_flowIndex).equals(flowName)) {</div>
<div>4175&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // try and find which index our flow is at (user must have closed some</div>
<div>4176&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // other tabs at lower indexes than us)!</div>
<div>4177&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          for (int i = 0; i &#60; m_mainKFPerspective.getNumTabs(); i++) {</div>
<div>4178&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            String tabT = m_mainKFPerspective.getTabTitle(i);</div>
<div>4179&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (tabT != null && tabT.equals(flowName)) {</div>
<div>4180&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_flowIndex = i;</div>
<div>4181&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              break;</div>
<div>4182&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>4183&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4184&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4185&emsp;&emsp;</div>
<div>4186&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.setExecuting(m_flowIndex, false);</div>
<div>4187&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.setExecutionThread(m_flowIndex, null);</div>
<div>4188&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_wasUserStopped) {</div>
<div>4189&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // TODO global Stop message to the status area</div>
<div>4190&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          KFLogPanel lp = m_mainKFPerspective.getLogPanel(m_flowIndex);</div>
<div>4191&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          lp.setMessageOnAll(false, "Stopped.");</div>
<div>4192&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else {</div>
<div>4193&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.getLogPanel(m_flowIndex).statusMessage(</div>
<div>4194&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            "@!@[KnowledgeFlow]|OK.");</div>
<div>4195&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4196&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4197&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4198&emsp;&emsp;</div>
<div>4199&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    public void stopAllFlows() {</div>
<div>4200&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Object> components = BeanInstance.getBeanInstances(m_flowIndex);</div>
<div>4201&emsp;&emsp;</div>
<div>4202&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (components != null) {</div>
<div>4203&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; components.size(); i++) {</div>
<div>4204&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Object temp = ((BeanInstance) components.elementAt(i)).getBean();</div>
<div>4205&emsp;&emsp;</div>
<div>4206&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (temp instanceof BeanCommon) {</div>
<div>4207&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((BeanCommon) temp).stop();</div>
<div>4208&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4209&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4210&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_wasUserStopped = true;</div>
<div>4211&emsp;&emsp;</div>
<div>4212&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4213&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4214&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4215&emsp;&emsp;</div>
<div>4216&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>4217&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Run all start-points in a layout in parallel or sequentially. Order of</div>
<div>4218&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * execution is arbitrary if the user has not prefixed the names of the start</div>
<div>4219&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * points with "&#60;num> :" in order to specify the order. In both parallel and</div>
<div>4220&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * sequential mode, a start point can be ommitted from exectution by prefixing</div>
<div>4221&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * its name with "! :".</div>
<div>4222&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>4223&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param sequential true if the flow layout is to have its start points run</div>
<div>4224&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *          sequentially rather than in parallel</div>
<div>4225&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>4226&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>4227&emsp;&emsp;&nbsp;&nbsp;  private void runFlow(final boolean sequential) {</div>
<div>4228&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_mainKFPerspective.getNumTabs() > 0) {</div>
<div>4229&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      RunThread runThread = new RunThread(sequential);</div>
<div>4230&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setExecutionThread(runThread);</div>
<div>4231&emsp;&emsp;</div>
<div>4232&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      runThread.start();</div>
<div>4233&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4234&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4235&emsp;&emsp;</div>
<div>4236&emsp;&emsp;&nbsp;&nbsp;  private void stopFlow() {</div>
<div>4237&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_mainKFPerspective.getCurrentTabIndex() >= 0) {</div>
<div>4238&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      RunThread running = m_mainKFPerspective.getExecutionThread();</div>
<div>4239&emsp;&emsp;</div>
<div>4240&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (running != null) {</div>
<div>4241&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        running.stopAllFlows();</div>
<div>4242&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4243&emsp;&emsp;</div>
<div>4244&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      /*</div>
<div>4245&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * Vector components =</div>
<div>4246&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * BeanInstance.getBeanInstances(m_mainKFPerspective.getCurrentTabIndex</div>
<div>4247&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * ());</div>
<div>4248&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       *</div>
<div>4249&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * if (components != null) { for (int i = 0; i &#60; components.size(); i++) {</div>
<div>4250&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * Object temp = ((BeanInstance) components.elementAt(i)).getBean();</div>
<div>4251&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       *</div>
<div>4252&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * if (temp instanceof BeanCommon) { ((BeanCommon) temp).stop(); } } }</div>
<div>4253&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       */</div>
<div>4254&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4255&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4256&emsp;&emsp;</div>
<div>4257&emsp;&emsp;&nbsp;&nbsp;  private void processPackage(String tempBeanCompName,</div>
<div>4258&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    weka.gui.HierarchyPropertyParser hpp, DefaultMutableTreeNode parentNode,</div>
<div>4259&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Map&#60;String, DefaultMutableTreeNode> nodeTextIndex) {</div>
<div>4260&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (hpp.isLeafReached()) {</div>
<div>4261&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // instantiate a bean and add it to the holderPanel</div>
<div>4262&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // System.err.println("Would add "+hpp.fullValue());</div>
<div>4263&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      /*</div>
<div>4264&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * String algName = hpp.fullValue(); JPanel tempBean =</div>
<div>4265&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * instantiateToolBarBean(true, tempBeanCompName, algName); if (tempBean</div>
<div>4266&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * != null && holderPanel != null) { holderPanel.add(tempBean); }</div>
<div>4267&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       */</div>
<div>4268&emsp;&emsp;</div>
<div>4269&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      hpp.goToParent();</div>
<div>4270&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return;</div>
<div>4271&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4272&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    String[] children = hpp.childrenValues();</div>
<div>4273&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (String element : children) {</div>
<div>4274&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      hpp.goToChild(element);</div>
<div>4275&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      DefaultMutableTreeNode child = null;</div>
<div>4276&emsp;&emsp;</div>
<div>4277&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (hpp.isLeafReached()) {</div>
<div>4278&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String algName = hpp.fullValue();</div>
<div>4279&emsp;&emsp;</div>
<div>4280&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Object visibleCheck = instantiateBean(true, tempBeanCompName, algName);</div>
<div>4281&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (visibleCheck != null) {</div>
<div>4282&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (visibleCheck instanceof BeanContextChild) {</div>
<div>4283&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_bcSupport.add(visibleCheck);</div>
<div>4284&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4285&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ImageIcon scaledForTree = null;</div>
<div>4286&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (visibleCheck instanceof Visible) {</div>
<div>4287&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            BeanVisual bv = ((Visible) visibleCheck).getVisual();</div>
<div>4288&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (bv != null) {</div>
<div>4289&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              scaledForTree = new ImageIcon(bv.scale(0.33));</div>
<div>4290&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // m_iconLookup.put(algName, scaledForTree);</div>
<div>4291&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>4292&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4293&emsp;&emsp;</div>
<div>4294&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // try and get a tool tip</div>
<div>4295&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String toolTip = "";</div>
<div>4296&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          try {</div>
<div>4297&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Object wrappedA = WekaPackageClassLoaderManager.objectForName(algName);</div>
<div>4298&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // Object wrappedA = Class.forName(algName).newInstance();</div>
<div>4299&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            toolTip = getGlobalInfo(wrappedA);</div>
<div>4300&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } catch (Exception ex) {</div>
<div>4301&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4302&emsp;&emsp;</div>
<div>4303&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          JTreeLeafDetails leafData = new JTreeLeafDetails(tempBeanCompName,</div>
<div>4304&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            algName, scaledForTree);</div>
<div>4305&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (toolTip != null && toolTip.length() > 0) {</div>
<div>4306&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            leafData.setToolTipText(toolTip);</div>
<div>4307&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4308&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          child = new InvisibleNode(leafData);</div>
<div>4309&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          nodeTextIndex.put(algName.toLowerCase() + " "</div>
<div>4310&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + (toolTip != null ? toolTip.toLowerCase() : ""), child);</div>
<div>4311&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4312&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } else {</div>
<div>4313&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        child = new InvisibleNode(element);</div>
<div>4314&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4315&emsp;&emsp;</div>
<div>4316&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (child != null) {</div>
<div>4317&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        parentNode.add(child);</div>
<div>4318&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4319&emsp;&emsp;</div>
<div>4320&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      processPackage(tempBeanCompName, hpp, child, nodeTextIndex);</div>
<div>4321&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4322&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    hpp.goToParent();</div>
<div>4323&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4324&emsp;&emsp;</div>
<div>4325&emsp;&emsp;&nbsp;&nbsp;  private Object instantiateBean(boolean wekawrapper, String tempBeanCompName,</div>
<div>4326&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    String algName) {</div>
<div>4327&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Object tempBean;</div>
<div>4328&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (wekawrapper) {</div>
<div>4329&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      try {</div>
<div>4330&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // modifications by Zerbetto</div>
<div>4331&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // tempBean = Beans.instantiate(null, tempBeanCompName);</div>
<div>4332&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        tempBean = WekaPackageClassLoaderManager.objectForName(tempBeanCompName);</div>
<div>4333&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        //tempBean = Beans.instantiate(this.getClass().getClassLoader(),</div>
<div>4334&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        //  tempBeanCompName);</div>
<div>4335&emsp;&emsp;</div>
<div>4336&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // end modifications by Zerbetto</div>
<div>4337&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } catch (Exception ex) {</div>
<div>4338&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        weka.core.logging.Logger.log(weka.core.logging.Logger.Level.WARNING,</div>
<div>4339&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          "[KnowledgeFlow] Failed to instantiate :"</div>
<div>4340&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + tempBeanCompName + "KnowledgeFlowApp.instantiateBean()");</div>
<div>4341&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return null;</div>
<div>4342&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4343&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (tempBean instanceof WekaWrapper) {</div>
<div>4344&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // algName = (String)tempBarSpecs.elementAt(j);</div>
<div>4345&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Class&#60;?> c = null;</div>
<div>4346&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        try {</div>
<div>4347&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          c = WekaPackageClassLoaderManager.forName(algName);</div>
<div>4348&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // c = Class.forName(algName);</div>
<div>4349&emsp;&emsp;</div>
<div>4350&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // check for ignore</div>
<div>4351&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          for (Annotation a : c.getAnnotations()) {</div>
<div>4352&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (a instanceof KFIgnore) {</div>
<div>4353&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              return null;</div>
<div>4354&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>4355&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4356&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } catch (Exception ex) {</div>
<div>4357&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          weka.core.logging.Logger.log(weka.core.logging.Logger.Level.WARNING,</div>
<div>4358&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            "[KnowledgeFlow] Can't find class called: "</div>
<div>4359&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              + algName);</div>
<div>4360&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          return null;</div>
<div>4361&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4362&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        try {</div>
<div>4363&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Object o = c.newInstance();</div>
<div>4364&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ((WekaWrapper) tempBean).setWrappedAlgorithm(o);</div>
<div>4365&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } catch (Exception ex) {</div>
<div>4366&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          weka.core.logging.Logger.log(weka.core.logging.Logger.Level.WARNING,</div>
<div>4367&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            "[KnowledgeFlow] Failed to configure "</div>
<div>4368&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              + tempBeanCompName + " with " + algName);</div>
<div>4369&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          return null;</div>
<div>4370&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4371&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4372&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } else {</div>
<div>4373&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      try {</div>
<div>4374&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // modifications by Zerbetto</div>
<div>4375&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // tempBean = Beans.instantiate(null, tempBeanCompName);</div>
<div>4376&emsp;&emsp;</div>
<div>4377&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        tempBean = WekaPackageClassLoaderManager.objectForName(tempBeanCompName);</div>
<div>4378&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        //tempBean = Beans.instantiate(this.getClass().getClassLoader(),</div>
<div>4379&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        //  tempBeanCompName);</div>
<div>4380&emsp;&emsp;</div>
<div>4381&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // end modifications</div>
<div>4382&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } catch (Exception ex) {</div>
<div>4383&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ex.printStackTrace();</div>
<div>4384&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        weka.core.logging.Logger.log(weka.core.logging.Logger.Level.WARNING,</div>
<div>4385&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          "[KnowledgeFlow] Failed to instantiate :"</div>
<div>4386&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + tempBeanCompName + "KnowledgeFlowApp.instantiateBean()");</div>
<div>4387&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return null;</div>
<div>4388&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4389&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4390&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return tempBean;</div>
<div>4391&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4392&emsp;&emsp;</div>
<div>4393&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>4394&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Pop up a help window</div>
<div>4395&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>4396&emsp;&emsp;&nbsp;&nbsp;  private void popupHelp() {</div>
<div>4397&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    final JButton tempB = m_helpB;</div>
<div>4398&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>4399&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tempB.setEnabled(false);</div>
<div>4400&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // Modified by Zerbetto</div>
<div>4401&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // InputStream inR =</div>
<div>4402&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // ClassLoader.</div>
<div>4403&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // getSystemResourceAsStream("weka/gui/beans/README_KnowledgeFlow");</div>
<div>4404&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      InputStream inR = this.getClass().getClassLoader()</div>
<div>4405&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .getResourceAsStream("weka/gui/beans/README_KnowledgeFlow");</div>
<div>4406&emsp;&emsp;</div>
<div>4407&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // end modifications</div>
<div>4408&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      StringBuffer helpHolder = new StringBuffer();</div>
<div>4409&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      LineNumberReader lnr = new LineNumberReader(new InputStreamReader(inR));</div>
<div>4410&emsp;&emsp;</div>
<div>4411&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String line;</div>
<div>4412&emsp;&emsp;</div>
<div>4413&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      while ((line = lnr.readLine()) != null) {</div>
<div>4414&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        helpHolder.append(line + "\n");</div>
<div>4415&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4416&emsp;&emsp;</div>
<div>4417&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      lnr.close();</div>
<div>4418&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final javax.swing.JFrame jf = new javax.swing.JFrame();</div>
<div>4419&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.getContentPane().setLayout(new java.awt.BorderLayout());</div>
<div>4420&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final JTextArea ta = new JTextArea(helpHolder.toString());</div>
<div>4421&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ta.setFont(new Font("Monospaced", Font.PLAIN, 12));</div>
<div>4422&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ta.setEditable(false);</div>
<div>4423&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final JScrollPane sp = new JScrollPane(ta);</div>
<div>4424&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.getContentPane().add(sp, java.awt.BorderLayout.CENTER);</div>
<div>4425&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.addWindowListener(new java.awt.event.WindowAdapter() {</div>
<div>4426&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>4427&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void windowClosing(java.awt.event.WindowEvent e) {</div>
<div>4428&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          tempB.setEnabled(true);</div>
<div>4429&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          jf.dispose();</div>
<div>4430&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4431&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>4432&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.setSize(600, 600);</div>
<div>4433&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.setVisible(true);</div>
<div>4434&emsp;&emsp;</div>
<div>4435&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>4436&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tempB.setEnabled(true);</div>
<div>4437&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4438&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4439&emsp;&emsp;</div>
<div>4440&emsp;&emsp;&nbsp;&nbsp;  public void closeAllTabs() {</div>
<div>4441&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = m_mainKFPerspective.getNumTabs() - 1; i >= 0; i--) {</div>
<div>4442&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.removeTab(i);</div>
<div>4443&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4444&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4445&emsp;&emsp;</div>
<div>4446&emsp;&emsp;&nbsp;&nbsp;  public void clearLayout() {</div>
<div>4447&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    stopFlow(); // try and stop any running components</div>
<div>4448&emsp;&emsp;</div>
<div>4449&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_mainKFPerspective.getNumTabs() == 0 || getAllowMultipleTabs()) {</div>
<div>4450&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.addTab("Untitled" + m_untitledCount++);</div>
<div>4451&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4452&emsp;&emsp;</div>
<div>4453&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (!getAllowMultipleTabs()) {</div>
<div>4454&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanConnection.setConnections(new Vector&#60;BeanConnection>(),</div>
<div>4455&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex());</div>
<div>4456&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance.setBeanInstances(new Vector&#60;Object>(), m_mainKFPerspective</div>
<div>4457&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .getBeanLayout(m_mainKFPerspective.getCurrentTabIndex()),</div>
<div>4458&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex());</div>
<div>4459&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4460&emsp;&emsp;</div>
<div>4461&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>4462&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * BeanInstance.reset(m_beanLayout); BeanConnection.reset();</div>
<div>4463&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * m_beanLayout.revalidate(); m_beanLayout.repaint();</div>
<div>4464&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * m_logPanel.clearStatus();</div>
<div>4465&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * m_logPanel.statusMessage("[KnowledgeFlow]|Welcome to the Weka Knowledge Flow"</div>
<div>4466&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * );</div>
<div>4467&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>4468&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4469&emsp;&emsp;</div>
<div>4470&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>4471&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Pops up the menu for selecting template layouts</div>
<div>4472&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>4473&emsp;&emsp;&nbsp;&nbsp;  private void createTemplateMenuPopup() {</div>
<div>4474&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    PopupMenu templatesMenu = new PopupMenu();</div>
<div>4475&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // MenuItem addToUserTabItem = new MenuItem("Add to user tab");</div>
<div>4476&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; BeansProperties.TEMPLATE_PATHS.size(); i++) {</div>
<div>4477&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String mE = BeansProperties.TEMPLATE_DESCRIPTIONS.get(i);</div>
<div>4478&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final String path = BeansProperties.TEMPLATE_PATHS.get(i);</div>
<div>4479&emsp;&emsp;</div>
<div>4480&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MenuItem m = new MenuItem(mE);</div>
<div>4481&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m.addActionListener(new ActionListener() {</div>
<div>4482&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>4483&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent ee) {</div>
<div>4484&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          try {</div>
<div>4485&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ClassLoader resourceClassLoader = WekaPackageClassLoaderManager.getWekaPackageClassLoaderManager().findClassloaderForResource(path);</div>
<div>4486&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            InputStream inR = resourceClassLoader.getResourceAsStream(path);</div>
<div>4487&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            //InputStream inR = this.getClass().getClassLoader()</div>
<div>4488&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            //  .getResourceAsStream(path);</div>
<div>4489&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.addTab("Untitled" + m_untitledCount++);</div>
<div>4490&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            XMLBeans xml = new XMLBeans(m_beanLayout, m_bcSupport,</div>
<div>4491&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mainKFPerspective.getCurrentTabIndex());</div>
<div>4492&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            InputStreamReader isr = new InputStreamReader(inR);</div>
<div>4493&emsp;&emsp;</div>
<div>4494&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            @SuppressWarnings("unchecked")</div>
<div>4495&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Vector&#60;Vector&#60;?>> v = (Vector&#60;Vector&#60;?>>) xml.read(isr);</div>
<div>4496&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            @SuppressWarnings("unchecked")</div>
<div>4497&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Vector&#60;Object> beans = (Vector&#60;Object>) v</div>
<div>4498&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .get(XMLBeans.INDEX_BEANINSTANCES);</div>
<div>4499&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            @SuppressWarnings("unchecked")</div>
<div>4500&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Vector&#60;BeanConnection> connections = (Vector&#60;BeanConnection>) v</div>
<div>4501&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .get(XMLBeans.INDEX_BEANCONNECTIONS);</div>
<div>4502&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            isr.close();</div>
<div>4503&emsp;&emsp;</div>
<div>4504&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            integrateFlow(beans, connections, false, false);</div>
<div>4505&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            notifyIsDirty();</div>
<div>4506&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            revalidate();</div>
<div>4507&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } catch (Exception ex) {</div>
<div>4508&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.getCurrentLogPanel().logMessage(</div>
<div>4509&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "Problem loading template: " + ex.getMessage());</div>
<div>4510&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4511&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4512&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>4513&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      templatesMenu.add(m);</div>
<div>4514&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4515&emsp;&emsp;</div>
<div>4516&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_templatesB.add(templatesMenu);</div>
<div>4517&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    templatesMenu.show(m_templatesB, 0, 0);</div>
<div>4518&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4519&emsp;&emsp;</div>
<div>4520&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>4521&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Popup a context sensitive menu for the bean component</div>
<div>4522&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>4523&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param pt holds the panel coordinates for the component</div>
<div>4524&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param bi the bean component over which the user right clicked the mouse</div>
<div>4525&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param x the x coordinate at which to popup the menu</div>
<div>4526&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param y the y coordinate at which to popup the menu</div>
<div>4527&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>4528&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *          Modified by Zerbetto: javax.swing.JPopupMenu transformed into</div>
<div>4529&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *          java.awt.PopupMenu</div>
<div>4530&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>4531&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>4532&emsp;&emsp;&nbsp;&nbsp;  private void doPopup(Point pt, final BeanInstance bi, int x, int y) {</div>
<div>4533&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    final JComponent bc = (JComponent) bi.getBean();</div>
<div>4534&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    final int xx = x;</div>
<div>4535&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    final int yy = y;</div>
<div>4536&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int menuItemCount = 0;</div>
<div>4537&emsp;&emsp;</div>
<div>4538&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // modifications by Zerbetto</div>
<div>4539&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    PopupMenu beanContextMenu = new PopupMenu();</div>
<div>4540&emsp;&emsp;</div>
<div>4541&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // JPopupMenu beanContextMenu = new JPopupMenu();</div>
<div>4542&emsp;&emsp;</div>
<div>4543&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // beanContextMenu.insert(new JLabel("Edit",</div>
<div>4544&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // SwingConstants.CENTER),</div>
<div>4545&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // menuItemCount);</div>
<div>4546&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean executing = m_mainKFPerspective.getExecuting();</div>
<div>4547&emsp;&emsp;</div>
<div>4548&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    MenuItem edit = new MenuItem("Edit:");</div>
<div>4549&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    edit.setEnabled(false);</div>
<div>4550&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    beanContextMenu.insert(edit, menuItemCount);</div>
<div>4551&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    menuItemCount++;</div>
<div>4552&emsp;&emsp;</div>
<div>4553&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_mainKFPerspective.getSelectedBeans().size() > 0) {</div>
<div>4554&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MenuItem copyItem = new MenuItem("Copy");</div>
<div>4555&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      copyItem.addActionListener(new ActionListener() {</div>
<div>4556&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>4557&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>4558&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          copyToClipboard();</div>
<div>4559&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.setSelectedBeans(new Vector&#60;Object>());</div>
<div>4560&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4561&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>4562&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      beanContextMenu.add(copyItem);</div>
<div>4563&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      copyItem.setEnabled(!executing);</div>
<div>4564&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      menuItemCount++;</div>
<div>4565&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4566&emsp;&emsp;</div>
<div>4567&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (bc instanceof MetaBean) {</div>
<div>4568&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // JMenuItem ungroupItem = new JMenuItem("Ungroup");</div>
<div>4569&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MenuItem ungroupItem = new MenuItem("Ungroup");</div>
<div>4570&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ungroupItem.addActionListener(new ActionListener() {</div>
<div>4571&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>4572&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>4573&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // ungroup</div>
<div>4574&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          bi.removeBean(m_beanLayout, m_mainKFPerspective.getCurrentTabIndex());</div>
<div>4575&emsp;&emsp;</div>
<div>4576&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Vector&#60;Object> group = ((MetaBean) bc).getBeansInSubFlow();</div>
<div>4577&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Vector&#60;BeanConnection> associatedConnections = ((MetaBean) bc)</div>
<div>4578&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getAssociatedConnections();</div>
<div>4579&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ((MetaBean) bc).restoreBeans(xx, yy);</div>
<div>4580&emsp;&emsp;</div>
<div>4581&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          for (int i = 0; i &#60; group.size(); i++) {</div>
<div>4582&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            BeanInstance tbi = (BeanInstance) group.elementAt(i);</div>
<div>4583&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            addComponent(tbi, false);</div>
<div>4584&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            tbi.addBean(m_beanLayout, m_mainKFPerspective.getCurrentTabIndex());</div>
<div>4585&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4586&emsp;&emsp;</div>
<div>4587&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          for (int i = 0; i &#60; associatedConnections.size(); i++) {</div>
<div>4588&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            BeanConnection tbc = associatedConnections.elementAt(i);</div>
<div>4589&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            tbc.setHidden(false);</div>
<div>4590&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4591&emsp;&emsp;</div>
<div>4592&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_beanLayout.repaint();</div>
<div>4593&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.setEditedStatus(true);</div>
<div>4594&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          notifyIsDirty();</div>
<div>4595&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4596&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>4597&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ungroupItem.setEnabled(!executing);</div>
<div>4598&emsp;&emsp;</div>
<div>4599&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      beanContextMenu.add(ungroupItem);</div>
<div>4600&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      menuItemCount++;</div>
<div>4601&emsp;&emsp;</div>
<div>4602&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // Add to user tab</div>
<div>4603&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // JMenuItem addToUserTabItem = new JMenuItem("Add to user tab");</div>
<div>4604&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MenuItem addToUserTabItem = new MenuItem("Add to user tab");</div>
<div>4605&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      addToUserTabItem.addActionListener(new ActionListener() {</div>
<div>4606&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>4607&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>4608&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // addToUserToolBar((MetaBean) bi.getBean(), true);</div>
<div>4609&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // addToUserTreeNode((MetaBean) bi.getBean(), true);</div>
<div>4610&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          addToUserTreeNode(bi, true);</div>
<div>4611&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          notifyIsDirty();</div>
<div>4612&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4613&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>4614&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      addToUserTabItem.setEnabled(!executing);</div>
<div>4615&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      beanContextMenu.add(addToUserTabItem);</div>
<div>4616&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      menuItemCount++;</div>
<div>4617&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4618&emsp;&emsp;</div>
<div>4619&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // JMenuItem deleteItem = new JMenuItem("Delete");</div>
<div>4620&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    MenuItem deleteItem = new MenuItem("Delete");</div>
<div>4621&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    deleteItem.addActionListener(new ActionListener() {</div>
<div>4622&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>4623&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void actionPerformed(ActionEvent e) {</div>
<div>4624&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeanConnection.removeConnections(bi,</div>
<div>4625&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.getCurrentTabIndex());</div>
<div>4626&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        bi.removeBean(m_beanLayout, m_mainKFPerspective.getCurrentTabIndex());</div>
<div>4627&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (bc instanceof BeanCommon) {</div>
<div>4628&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String key = ((BeanCommon) bc).getCustomName() + "$" + bc.hashCode();</div>
<div>4629&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_logPanel.statusMessage(key + "|remove");</div>
<div>4630&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4631&emsp;&emsp;</div>
<div>4632&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // delete any that have been actively selected</div>
<div>4633&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_mainKFPerspective.getSelectedBeans().size() > 0) {</div>
<div>4634&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          deleteSelectedBeans();</div>
<div>4635&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4636&emsp;&emsp;</div>
<div>4637&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        revalidate();</div>
<div>4638&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.setEditedStatus(true);</div>
<div>4639&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        notifyIsDirty();</div>
<div>4640&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_selectAllB.setEnabled(BeanInstance.getBeanInstances(</div>
<div>4641&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.getCurrentTabIndex()).size() > 0);</div>
<div>4642&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4643&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    });</div>
<div>4644&emsp;&emsp;</div>
<div>4645&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    deleteItem.setEnabled(!executing);</div>
<div>4646&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (bc instanceof BeanCommon) {</div>
<div>4647&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (((BeanCommon) bc).isBusy()) {</div>
<div>4648&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        deleteItem.setEnabled(false);</div>
<div>4649&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4650&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4651&emsp;&emsp;</div>
<div>4652&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    beanContextMenu.add(deleteItem);</div>
<div>4653&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    menuItemCount++;</div>
<div>4654&emsp;&emsp;</div>
<div>4655&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (bc instanceof BeanCommon) {</div>
<div>4656&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      MenuItem nameItem = new MenuItem("Set name");</div>
<div>4657&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      nameItem.addActionListener(new ActionListener() {</div>
<div>4658&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>4659&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>4660&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String oldName = ((BeanCommon) bc).getCustomName();</div>
<div>4661&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String name = JOptionPane.showInputDialog(KnowledgeFlowApp.this,</div>
<div>4662&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            "Enter a name for this component", oldName);</div>
<div>4663&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (name != null) {</div>
<div>4664&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((BeanCommon) bc).setCustomName(name);</div>
<div>4665&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.setEditedStatus(true);</div>
<div>4666&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4667&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4668&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>4669&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (bc instanceof BeanCommon) {</div>
<div>4670&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (((BeanCommon) bc).isBusy()) {</div>
<div>4671&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          nameItem.setEnabled(false);</div>
<div>4672&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4673&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4674&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      nameItem.setEnabled(!executing);</div>
<div>4675&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      beanContextMenu.add(nameItem);</div>
<div>4676&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      menuItemCount++;</div>
<div>4677&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4678&emsp;&emsp;</div>
<div>4679&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>4680&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // BeanInfo [] compInfo = null;</div>
<div>4681&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // JComponent [] associatedBeans = null;</div>
<div>4682&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;BeanInfo> compInfo = new Vector&#60;BeanInfo>(1);</div>
<div>4683&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Object> associatedBeans = null;</div>
<div>4684&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (bc instanceof MetaBean) {</div>
<div>4685&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        compInfo = ((MetaBean) bc).getBeanInfoSubFlow();</div>
<div>4686&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        associatedBeans = ((MetaBean) bc).getBeansInSubFlow();</div>
<div>4687&emsp;&emsp;</div>
<div>4688&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((MetaBean) bc).getBeansInOutputs();</div>
<div>4689&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((MetaBean) bc).getBeanInfoOutputs();</div>
<div>4690&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } else {</div>
<div>4691&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        compInfo.add(Introspector.getBeanInfo(bc.getClass()));</div>
<div>4692&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4693&emsp;&emsp;</div>
<div>4694&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final Vector&#60;Object> tempAssociatedBeans = associatedBeans;</div>
<div>4695&emsp;&emsp;</div>
<div>4696&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (compInfo == null) {</div>
<div>4697&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        weka.core.logging.Logger.log(weka.core.logging.Logger.Level.WARNING,</div>
<div>4698&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          "[KnowledgeFlow] Error in doPopup()");</div>
<div>4699&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } else {</div>
<div>4700&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // System.err.println("Got bean info");</div>
<div>4701&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int zz = 0; zz &#60; compInfo.size(); zz++) {</div>
<div>4702&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final int tt = zz;</div>
<div>4703&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final Class&#60;?> custClass = compInfo.elementAt(zz).getBeanDescriptor()</div>
<div>4704&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .getCustomizerClass();</div>
<div>4705&emsp;&emsp;</div>
<div>4706&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (custClass != null) {</div>
<div>4707&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // System.err.println("Got customizer class");</div>
<div>4708&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // popupCustomizer(custClass, bc);</div>
<div>4709&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // JMenuItem custItem = null;</div>
<div>4710&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            MenuItem custItem = null;</div>
<div>4711&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            boolean customizationEnabled = !executing;</div>
<div>4712&emsp;&emsp;</div>
<div>4713&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (!(bc instanceof MetaBean)) {</div>
<div>4714&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // custItem = new JMenuItem("Configure...");</div>
<div>4715&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              custItem = new MenuItem("Configure...");</div>
<div>4716&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (bc instanceof BeanCommon) {</div>
<div>4717&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                customizationEnabled = (!executing && !((BeanCommon) bc)</div>
<div>4718&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  .isBusy());</div>
<div>4719&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>4720&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            } else {</div>
<div>4721&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              String custName = custClass.getName();</div>
<div>4722&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              BeanInstance tbi = (BeanInstance) associatedBeans.elementAt(zz);</div>
<div>4723&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (tbi.getBean() instanceof BeanCommon) {</div>
<div>4724&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                custName = ((BeanCommon) tbi.getBean()).getCustomName();</div>
<div>4725&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>4726&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (tbi.getBean() instanceof WekaWrapper) {</div>
<div>4727&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  custName = ((WekaWrapper) tbi.getBean())</div>
<div>4728&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    .getWrappedAlgorithm().getClass().getName();</div>
<div>4729&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                } else {</div>
<div>4730&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  custName = custName.substring(0,</div>
<div>4731&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    custName.indexOf("Customizer"));</div>
<div>4732&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>4733&emsp;&emsp;</div>
<div>4734&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                custName = custName.substring(custName.lastIndexOf('.') + 1,</div>
<div>4735&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  custName.length());</div>
<div>4736&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>4737&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // custItem = new JMenuItem("Configure: "+ custName);</div>
<div>4738&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              custItem = new MenuItem("Configure: " + custName);</div>
<div>4739&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (tbi.getBean() instanceof BeanCommon) {</div>
<div>4740&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                customizationEnabled = (!executing && !((BeanCommon) tbi</div>
<div>4741&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  .getBean()).isBusy());</div>
<div>4742&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>4743&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>4744&emsp;&emsp;</div>
<div>4745&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            custItem.addActionListener(new ActionListener() {</div>
<div>4746&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              @Override</div>
<div>4747&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              public void actionPerformed(ActionEvent e) {</div>
<div>4748&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (bc instanceof MetaBean) {</div>
<div>4749&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  popupCustomizer(custClass,</div>
<div>4750&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    (JComponent) ((BeanInstance) tempAssociatedBeans</div>
<div>4751&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      .elementAt(tt)).getBean());</div>
<div>4752&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                } else {</div>
<div>4753&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  popupCustomizer(custClass, bc);</div>
<div>4754&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>4755&emsp;&emsp;</div>
<div>4756&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                notifyIsDirty();</div>
<div>4757&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>4758&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            });</div>
<div>4759&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            custItem.setEnabled(customizationEnabled);</div>
<div>4760&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            beanContextMenu.add(custItem);</div>
<div>4761&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            menuItemCount++;</div>
<div>4762&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } else {</div>
<div>4763&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            weka.core.logging.Logger.log(weka.core.logging.Logger.Level.INFO,</div>
<div>4764&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "[KnowledgeFlow] No customizer class");</div>
<div>4765&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4766&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4767&emsp;&emsp;</div>
<div>4768&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;EventSetDescriptor[]> esdV = new Vector&#60;EventSetDescriptor[]>();</div>
<div>4769&emsp;&emsp;</div>
<div>4770&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // for (int i = 0; i &#60; compInfoOutputs.size(); i++) {</div>
<div>4771&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; compInfo.size(); i++) {</div>
<div>4772&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          EventSetDescriptor[] temp =</div>
<div>4773&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // ((BeanInfo)</div>
<div>4774&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // compInfoOutputs.elementAt(i)).getEventSetDescriptors();</div>
<div>4775&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            compInfo.elementAt(i).getEventSetDescriptors();</div>
<div>4776&emsp;&emsp;</div>
<div>4777&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if ((temp != null) && (temp.length > 0)) {</div>
<div>4778&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            esdV.add(temp);</div>
<div>4779&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4780&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4781&emsp;&emsp;</div>
<div>4782&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // EventSetDescriptor [] esds = compInfo.getEventSetDescriptors();</div>
<div>4783&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // if (esds != null && esds.length > 0) {</div>
<div>4784&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (esdV.size() > 0) {</div>
<div>4785&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // beanContextMenu.insert(new JLabel("Connections",</div>
<div>4786&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // SwingConstants.CENTER),</div>
<div>4787&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // menuItemCount);</div>
<div>4788&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          MenuItem connections = new MenuItem("Connections:");</div>
<div>4789&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          connections.setEnabled(false);</div>
<div>4790&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          beanContextMenu.insert(connections, menuItemCount);</div>
<div>4791&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          menuItemCount++;</div>
<div>4792&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4793&emsp;&emsp;</div>
<div>4794&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // final Vector finalOutputs = outputBeans;</div>
<div>4795&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Vector&#60;Object> finalOutputs = associatedBeans;</div>
<div>4796&emsp;&emsp;</div>
<div>4797&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int j = 0; j &#60; esdV.size(); j++) {</div>
<div>4798&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final int fj = j;</div>
<div>4799&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String sourceBeanName = "";</div>
<div>4800&emsp;&emsp;</div>
<div>4801&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (bc instanceof MetaBean) {</div>
<div>4802&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // Object sourceBean = ((BeanInstance)</div>
<div>4803&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // outputBeans.elementAt(j)).getBean();</div>
<div>4804&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Object sourceBean = ((BeanInstance) associatedBeans.elementAt(j))</div>
<div>4805&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .getBean();</div>
<div>4806&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (sourceBean instanceof BeanCommon) {</div>
<div>4807&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              sourceBeanName = ((BeanCommon) sourceBean).getCustomName();</div>
<div>4808&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            } else {</div>
<div>4809&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (sourceBean instanceof WekaWrapper) {</div>
<div>4810&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                sourceBeanName = ((WekaWrapper) sourceBean)</div>
<div>4811&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  .getWrappedAlgorithm().getClass().getName();</div>
<div>4812&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>4813&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                sourceBeanName = sourceBean.getClass().getName();</div>
<div>4814&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>4815&emsp;&emsp;</div>
<div>4816&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              sourceBeanName = sourceBeanName.substring(</div>
<div>4817&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                sourceBeanName.lastIndexOf('.') + 1, sourceBeanName.length());</div>
<div>4818&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>4819&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            sourceBeanName += ": ";</div>
<div>4820&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4821&emsp;&emsp;</div>
<div>4822&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          EventSetDescriptor[] esds = esdV.elementAt(j);</div>
<div>4823&emsp;&emsp;</div>
<div>4824&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          for (final EventSetDescriptor esd : esds) {</div>
<div>4825&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // System.err.println(esds[i].getName());</div>
<div>4826&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // add each event name to the menu</div>
<div>4827&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // JMenuItem evntItem = new JMenuItem(sourceBeanName</div>
<div>4828&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // +esds[i].getName());</div>
<div>4829&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            MenuItem evntItem = new MenuItem(sourceBeanName + esd.getName());</div>
<div>4830&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // Check EventConstraints (if any) here</div>
<div>4831&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            boolean ok = true;</div>
<div>4832&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            evntItem.setEnabled(!executing);</div>
<div>4833&emsp;&emsp;</div>
<div>4834&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (bc instanceof EventConstraints) {</div>
<div>4835&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              ok = ((EventConstraints) bc).eventGeneratable(esd.getName());</div>
<div>4836&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>4837&emsp;&emsp;</div>
<div>4838&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (ok) {</div>
<div>4839&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              evntItem.addActionListener(new ActionListener() {</div>
<div>4840&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                @Override</div>
<div>4841&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                public void actionPerformed(ActionEvent e) {</div>
<div>4842&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  connectComponents(</div>
<div>4843&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    esd,</div>
<div>4844&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    (bc instanceof MetaBean) ? ((BeanInstance) finalOutputs</div>
<div>4845&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      .elementAt(fj)) : bi, xx, yy);</div>
<div>4846&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  notifyIsDirty();</div>
<div>4847&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>4848&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              });</div>
<div>4849&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            } else {</div>
<div>4850&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              evntItem.setEnabled(false);</div>
<div>4851&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>4852&emsp;&emsp;</div>
<div>4853&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            beanContextMenu.add(evntItem);</div>
<div>4854&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            menuItemCount++;</div>
<div>4855&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4856&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4857&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4858&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (IntrospectionException ie) {</div>
<div>4859&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ie.printStackTrace();</div>
<div>4860&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4861&emsp;&emsp;</div>
<div>4862&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // System.err.println("Just before look for other options");</div>
<div>4863&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // now look for other options for this bean</div>
<div>4864&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (bc instanceof UserRequestAcceptor || bc instanceof Startable) {</div>
<div>4865&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Enumeration&#60;String> req = null;</div>
<div>4866&emsp;&emsp;</div>
<div>4867&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (bc instanceof UserRequestAcceptor) {</div>
<div>4868&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        req = ((UserRequestAcceptor) bc).enumerateRequests();</div>
<div>4869&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4870&emsp;&emsp;</div>
<div>4871&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (/* (bc instanceof Startable) || */(req != null && req</div>
<div>4872&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .hasMoreElements())) {</div>
<div>4873&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // beanContextMenu.insert(new JLabel("Actions",</div>
<div>4874&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // SwingConstants.CENTER),</div>
<div>4875&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // menuItemCount);</div>
<div>4876&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MenuItem actions = new MenuItem("Actions:");</div>
<div>4877&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        actions.setEnabled(false);</div>
<div>4878&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        beanContextMenu.insert(actions, menuItemCount);</div>
<div>4879&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>4880&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4881&emsp;&emsp;</div>
<div>4882&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      /*</div>
<div>4883&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * if (bc instanceof Startable) { String tempS =</div>
<div>4884&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * ((Startable)bc).getStartMessage(); insertUserOrStartableMenuItem(bc,</div>
<div>4885&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       * true, tempS, beanContextMenu); }</div>
<div>4886&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       */</div>
<div>4887&emsp;&emsp;</div>
<div>4888&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      while (req != null && req.hasMoreElements()) {</div>
<div>4889&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String tempS = req.nextElement();</div>
<div>4890&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        insertUserOrStartableMenuItem(bc, false, tempS, beanContextMenu);</div>
<div>4891&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>4892&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4893&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4894&emsp;&emsp;</div>
<div>4895&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // Send to perspective menu item?</div>
<div>4896&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (bc instanceof weka.gui.beans.Loader && m_perspectives.size() > 1</div>
<div>4897&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      && m_perspectiveDataLoadThread == null) {</div>
<div>4898&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final weka.core.converters.Loader theLoader =</div>
<div>4899&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((weka.gui.beans.Loader) bc)</div>
<div>4900&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getLoader();</div>
<div>4901&emsp;&emsp;</div>
<div>4902&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      boolean ok = true;</div>
<div>4903&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (theLoader instanceof FileSourcedConverter) {</div>
<div>4904&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String fileName = ((FileSourcedConverter) theLoader).retrieveFile()</div>
<div>4905&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getPath();</div>
<div>4906&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Environment env = m_mainKFPerspective.getEnvironmentSettings();</div>
<div>4907&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        try {</div>
<div>4908&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          fileName = env.substitute(fileName);</div>
<div>4909&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } catch (Exception ex) {</div>
<div>4910&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4911&emsp;&emsp;</div>
<div>4912&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        File tempF = new File(fileName);</div>
<div>4913&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String fileNameFixedPathSep = fileName.replace(File.separatorChar, '/');</div>
<div>4914&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!tempF.isFile()</div>
<div>4915&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          && this.getClass().getClassLoader().getResource(fileNameFixedPathSep) == null) {</div>
<div>4916&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ok = false;</div>
<div>4917&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4918&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4919&emsp;&emsp;</div>
<div>4920&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (ok) {</div>
<div>4921&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        beanContextMenu.addSeparator();</div>
<div>4922&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>4923&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_perspectives.size() > 2) {</div>
<div>4924&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          MenuItem sendToAllPerspectives = new MenuItem(</div>
<div>4925&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            "Send to all perspectives");</div>
<div>4926&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          menuItemCount++;</div>
<div>4927&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          sendToAllPerspectives.addActionListener(new ActionListener() {</div>
<div>4928&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            @Override</div>
<div>4929&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            public void actionPerformed(ActionEvent e) {</div>
<div>4930&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              loadDataAndSendToPerspective(theLoader, 0, true);</div>
<div>4931&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>4932&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          });</div>
<div>4933&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          beanContextMenu.add(sendToAllPerspectives);</div>
<div>4934&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4935&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Menu sendToPerspective = new Menu("Send to perspective...");</div>
<div>4936&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        beanContextMenu.add(sendToPerspective);</div>
<div>4937&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>4938&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 1; i &#60; m_perspectives.size(); i++) {</div>
<div>4939&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final int pIndex = i;</div>
<div>4940&emsp;&emsp;</div>
<div>4941&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (m_perspectives.get(i).acceptsInstances()) {</div>
<div>4942&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            String pName = m_perspectives.get(i).getPerspectiveTitle();</div>
<div>4943&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            MenuItem pI = new MenuItem(pName);</div>
<div>4944&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            pI.addActionListener(new ActionListener() {</div>
<div>4945&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              @Override</div>
<div>4946&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              public void actionPerformed(ActionEvent e) {</div>
<div>4947&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                loadDataAndSendToPerspective(theLoader, pIndex, false);</div>
<div>4948&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>4949&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            });</div>
<div>4950&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            sendToPerspective.add(pI);</div>
<div>4951&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>4952&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>4953&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>4954&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4955&emsp;&emsp;</div>
<div>4956&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // System.err.println("Just before showing menu");</div>
<div>4957&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // popup the menu</div>
<div>4958&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (menuItemCount > 0) {</div>
<div>4959&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // beanContextMenu.show(m_beanLayout, x, y);</div>
<div>4960&emsp;&emsp;</div>
<div>4961&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      double z = m_layoutZoom / 100.0;</div>
<div>4962&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      double px = x * z;</div>
<div>4963&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      double py = y * z;</div>
<div>4964&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_beanLayout.add(beanContextMenu);</div>
<div>4965&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // beanContextMenu.show(m_beanLayout, x, y);</div>
<div>4966&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      beanContextMenu.show(m_beanLayout, (int) px, (int) py);</div>
<div>4967&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>4968&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>4969&emsp;&emsp;</div>
<div>4970&emsp;&emsp;&nbsp;&nbsp;  private synchronized void loadDataAndSendToPerspective(</div>
<div>4971&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    final weka.core.converters.Loader loader, final int perspectiveIndex,</div>
<div>4972&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    final boolean sendToAll) {</div>
<div>4973&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_perspectiveDataLoadThread == null) {</div>
<div>4974&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveDataLoadThread = new Thread() {</div>
<div>4975&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>4976&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void run() {</div>
<div>4977&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          try {</div>
<div>4978&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Environment env = m_mainKFPerspective.getEnvironmentSettings();</div>
<div>4979&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (loader instanceof EnvironmentHandler) {</div>
<div>4980&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              ((EnvironmentHandler) loader).setEnvironment(env);</div>
<div>4981&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>4982&emsp;&emsp;</div>
<div>4983&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            loader.reset();</div>
<div>4984&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_logPanel</div>
<div>4985&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .statusMessage("@!@[KnowledgeFlow]|Sending data to perspective(s)...");</div>
<div>4986&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Instances data = loader.getDataSet();</div>
<div>4987&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (data != null) {</div>
<div>4988&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // make sure the perspective toolbar is visible!!</div>
<div>4989&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (!m_configAndPerspectivesVisible) {</div>
<div>4990&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                KnowledgeFlowApp.this.add(m_configAndPerspectives,</div>
<div>4991&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  BorderLayout.NORTH);</div>
<div>4992&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                m_configAndPerspectivesVisible = true;</div>
<div>4993&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>4994&emsp;&emsp;</div>
<div>4995&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // need to disable all the perspective buttons</div>
<div>4996&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              for (int i = 0; i &#60; m_perspectives.size(); i++) {</div>
<div>4997&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                m_perspectiveToolBar.getComponent(i).setEnabled(false);</div>
<div>4998&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>4999&emsp;&emsp;</div>
<div>5000&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (sendToAll) {</div>
<div>5001&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                for (int i = 1; i &#60; m_perspectives.size(); i++) {</div>
<div>5002&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  if (m_perspectives.get(i).acceptsInstances()) {</div>
<div>5003&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    m_perspectives.get(i).setInstances(data);</div>
<div>5004&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>5005&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>5006&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } else {</div>
<div>5007&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                KFPerspective currentP = (KFPerspective) m_perspectiveHolder</div>
<div>5008&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  .getComponent(0);</div>
<div>5009&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (currentP != m_perspectives.get(perspectiveIndex)) {</div>
<div>5010&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_perspectives.get(perspectiveIndex).setInstances(data);</div>
<div>5011&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  currentP.setActive(false);</div>
<div>5012&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_perspectiveHolder.remove(0);</div>
<div>5013&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_perspectiveHolder.add(</div>
<div>5014&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    (JComponent) m_perspectives.get(perspectiveIndex),</div>
<div>5015&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    BorderLayout.CENTER);</div>
<div>5016&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  m_perspectives.get(perspectiveIndex).setActive(true);</div>
<div>5017&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  ((JToggleButton) m_perspectiveToolBar</div>
<div>5018&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    .getComponent(perspectiveIndex)).setSelected(true);</div>
<div>5019&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  // KnowledgeFlowApp.this.invalidate();</div>
<div>5020&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  KnowledgeFlowApp.this.revalidate();</div>
<div>5021&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  KnowledgeFlowApp.this.repaint();</div>
<div>5022&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  notifyIsDirty();</div>
<div>5023&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>5024&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>5025&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>5026&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } catch (Exception ex) {</div>
<div>5027&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            weka.core.logging.Logger.log(</div>
<div>5028&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              weka.core.logging.Logger.Level.WARNING,</div>
<div>5029&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "[KnowledgeFlow] problem loading data for "</div>
<div>5030&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                + "perspective(s) : " + ex.getMessage());</div>
<div>5031&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ex.printStackTrace();</div>
<div>5032&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } finally {</div>
<div>5033&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // re-enable all the perspective buttons</div>
<div>5034&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            for (int i = 0; i &#60; m_perspectives.size(); i++) {</div>
<div>5035&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_perspectiveToolBar.getComponent(i).setEnabled(true);</div>
<div>5036&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>5037&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_perspectiveDataLoadThread = null;</div>
<div>5038&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_logPanel.statusMessage("@!@[KnowledgeFlow]|OK");</div>
<div>5039&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5040&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5041&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      };</div>
<div>5042&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveDataLoadThread.setPriority(Thread.MIN_PRIORITY);</div>
<div>5043&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_perspectiveDataLoadThread.start();</div>
<div>5044&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5045&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5046&emsp;&emsp;</div>
<div>5047&emsp;&emsp;&nbsp;&nbsp;  private void insertUserOrStartableMenuItem(final JComponent bc,</div>
<div>5048&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    final boolean startable, String tempS, PopupMenu beanContextMenu) {</div>
<div>5049&emsp;&emsp;</div>
<div>5050&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean disabled = false;</div>
<div>5051&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean confirmRequest = false;</div>
<div>5052&emsp;&emsp;</div>
<div>5053&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // check to see if this item is currently disabled</div>
<div>5054&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (tempS.charAt(0) == '$') {</div>
<div>5055&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tempS = tempS.substring(1, tempS.length());</div>
<div>5056&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      disabled = true;</div>
<div>5057&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5058&emsp;&emsp;</div>
<div>5059&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // check to see if this item requires confirmation</div>
<div>5060&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (tempS.charAt(0) == '?') {</div>
<div>5061&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tempS = tempS.substring(1, tempS.length());</div>
<div>5062&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      confirmRequest = true;</div>
<div>5063&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5064&emsp;&emsp;</div>
<div>5065&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    final String tempS2 = tempS;</div>
<div>5066&emsp;&emsp;</div>
<div>5067&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // JMenuItem custItem = new JMenuItem(tempS2);</div>
<div>5068&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    MenuItem custItem = new MenuItem(tempS2);</div>
<div>5069&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (confirmRequest) {</div>
<div>5070&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      custItem.addActionListener(new ActionListener() {</div>
<div>5071&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>5072&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>5073&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          //</div>
<div>5074&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          int result = JOptionPane.showConfirmDialog(KnowledgeFlowApp.this,</div>
<div>5075&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            tempS2, "Confirm action", JOptionPane.YES_NO_OPTION);</div>
<div>5076&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (result == JOptionPane.YES_OPTION) {</div>
<div>5077&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            Thread startPointThread = new Thread() {</div>
<div>5078&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              @Override</div>
<div>5079&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              public void run() {</div>
<div>5080&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                try {</div>
<div>5081&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  if (startable) {</div>
<div>5082&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    ((Startable) bc).start();</div>
<div>5083&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  } else if (bc instanceof UserRequestAcceptor) {</div>
<div>5084&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    ((UserRequestAcceptor) bc).performRequest(tempS2);</div>
<div>5085&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>5086&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  notifyIsDirty();</div>
<div>5087&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                } catch (Exception ex) {</div>
<div>5088&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  ex.printStackTrace();</div>
<div>5089&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>5090&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>5091&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            };</div>
<div>5092&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            startPointThread.setPriority(Thread.MIN_PRIORITY);</div>
<div>5093&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            startPointThread.start();</div>
<div>5094&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5095&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5096&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>5097&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } else {</div>
<div>5098&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      custItem.addActionListener(new ActionListener() {</div>
<div>5099&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>5100&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void actionPerformed(ActionEvent e) {</div>
<div>5101&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Thread startPointThread = new Thread() {</div>
<div>5102&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            @Override</div>
<div>5103&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            public void run() {</div>
<div>5104&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              try {</div>
<div>5105&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                if (startable) {</div>
<div>5106&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  ((Startable) bc).start();</div>
<div>5107&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                } else if (bc instanceof UserRequestAcceptor) {</div>
<div>5108&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  ((UserRequestAcceptor) bc).performRequest(tempS2);</div>
<div>5109&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>5110&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                notifyIsDirty();</div>
<div>5111&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              } catch (Exception ex) {</div>
<div>5112&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                ex.printStackTrace();</div>
<div>5113&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>5114&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>5115&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          };</div>
<div>5116&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          startPointThread.setPriority(Thread.MIN_PRIORITY);</div>
<div>5117&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          startPointThread.start();</div>
<div>5118&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5119&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>5120&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5121&emsp;&emsp;</div>
<div>5122&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (disabled) {</div>
<div>5123&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      custItem.setEnabled(false);</div>
<div>5124&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5125&emsp;&emsp;</div>
<div>5126&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    beanContextMenu.add(custItem);</div>
<div>5127&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5128&emsp;&emsp;</div>
<div>5129&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>5130&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Tells us about the modified status of a particular object - typically a</div>
<div>5131&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * customizer that is editing a flow component. Allows us to set the modified</div>
<div>5132&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * flag for the current flow.</div>
<div>5133&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>5134&emsp;&emsp;&nbsp;&nbsp;  @Override</div>
<div>5135&emsp;&emsp;&nbsp;&nbsp;  public void setModifiedStatus(Object source, boolean modified) {</div>
<div>5136&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (source instanceof BeanCustomizer && modified) {</div>
<div>5137&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setEditedStatus(modified);</div>
<div>5138&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5139&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5140&emsp;&emsp;</div>
<div>5141&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>5142&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Popup the customizer for this bean</div>
<div>5143&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>5144&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param custClass the class of the customizer</div>
<div>5145&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param bc the bean to be customized</div>
<div>5146&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>5147&emsp;&emsp;&nbsp;&nbsp;  private void popupCustomizer(Class&#60;?> custClass, JComponent bc) {</div>
<div>5148&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>5149&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // instantiate</div>
<div>5150&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final Object customizer = custClass.newInstance();</div>
<div>5151&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // set environment **before** setting object!!</div>
<div>5152&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (customizer instanceof EnvironmentHandler) {</div>
<div>5153&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((EnvironmentHandler) customizer).setEnvironment(m_flowEnvironment);</div>
<div>5154&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5155&emsp;&emsp;</div>
<div>5156&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (customizer instanceof BeanCustomizer) {</div>
<div>5157&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((BeanCustomizer) customizer).setModifiedListener(this);</div>
<div>5158&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5159&emsp;&emsp;</div>
<div>5160&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ((Customizer) customizer).setObject(bc);</div>
<div>5161&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // final javax.swing.JFrame jf = new javax.swing.JFrame();</div>
<div>5162&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final JDialog d = new JDialog(</div>
<div>5163&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        (java.awt.Frame) KnowledgeFlowApp.this.getTopLevelAncestor(),</div>
<div>5164&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ModalityType.DOCUMENT_MODAL);</div>
<div>5165&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      d.setLayout(new BorderLayout());</div>
<div>5166&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      d.getContentPane().add((JComponent) customizer, BorderLayout.CENTER);</div>
<div>5167&emsp;&emsp;</div>
<div>5168&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // jf.getContentPane().setLayout(new BorderLayout());</div>
<div>5169&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // jf.getContentPane().add((JComponent)customizer, BorderLayout.CENTER);</div>
<div>5170&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (customizer instanceof CustomizerCloseRequester) {</div>
<div>5171&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((CustomizerCloseRequester) customizer).setParentWindow(d);</div>
<div>5172&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5173&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      d.addWindowListener(new java.awt.event.WindowAdapter() {</div>
<div>5174&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>5175&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void windowClosing(java.awt.event.WindowEvent e) {</div>
<div>5176&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (customizer instanceof CustomizerClosingListener) {</div>
<div>5177&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((CustomizerClosingListener) customizer).customizerClosing();</div>
<div>5178&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5179&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          d.dispose();</div>
<div>5180&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5181&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>5182&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // jf.pack();</div>
<div>5183&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // jf.setVisible(true);</div>
<div>5184&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      d.pack();</div>
<div>5185&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      d.setLocationRelativeTo(KnowledgeFlowApp.this);</div>
<div>5186&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      d.setVisible(true);</div>
<div>5187&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>5188&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ex.printStackTrace();</div>
<div>5189&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5190&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5191&emsp;&emsp;</div>
<div>5192&emsp;&emsp;&nbsp;&nbsp;  private void addToUserTreeNode(BeanInstance meta, boolean installListener) {</div>
<div>5193&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    DefaultTreeModel model = (DefaultTreeModel) m_componentTree.getModel();</div>
<div>5194&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    DefaultMutableTreeNode root = (DefaultMutableTreeNode) model.getRoot();</div>
<div>5195&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_userCompNode == null) {</div>
<div>5196&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_userCompNode = new InvisibleNode("User");</div>
<div>5197&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      model.insertNodeInto(m_userCompNode, root, 0);</div>
<div>5198&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5199&emsp;&emsp;</div>
<div>5200&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> beanHolder = new Vector&#60;Object>();</div>
<div>5201&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    beanHolder.add(meta);</div>
<div>5202&emsp;&emsp;</div>
<div>5203&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>5204&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      StringBuffer serialized = copyToBuffer(beanHolder);</div>
<div>5205&emsp;&emsp;</div>
<div>5206&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String displayName = "";</div>
<div>5207&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ImageIcon scaledIcon = null;</div>
<div>5208&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      //</div>
<div>5209&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (meta.getBean() instanceof Visible) {</div>
<div>5210&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // ((Visible)copy).getVisual().scale(3);</div>
<div>5211&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        scaledIcon = new ImageIcon(((Visible) meta.getBean()).getVisual()</div>
<div>5212&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .scale(0.33));</div>
<div>5213&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        displayName = ((Visible) meta.getBean()).getVisual().getText();</div>
<div>5214&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5215&emsp;&emsp;</div>
<div>5216&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Object> metaDetails = new Vector&#60;Object>();</div>
<div>5217&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      metaDetails.add(displayName);</div>
<div>5218&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      metaDetails.add(serialized);</div>
<div>5219&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      metaDetails.add(scaledIcon);</div>
<div>5220&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      SerializedObject so = new SerializedObject(metaDetails);</div>
<div>5221&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @SuppressWarnings("unchecked")</div>
<div>5222&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Object> copy = (Vector&#60;Object>) so.getObject();</div>
<div>5223&emsp;&emsp;</div>
<div>5224&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JTreeLeafDetails metaLeaf = new JTreeLeafDetails(displayName, copy,</div>
<div>5225&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        scaledIcon);</div>
<div>5226&emsp;&emsp;</div>
<div>5227&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      DefaultMutableTreeNode newUserComp = new InvisibleNode(metaLeaf);</div>
<div>5228&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      model.insertNodeInto(newUserComp, m_userCompNode, 0);</div>
<div>5229&emsp;&emsp;</div>
<div>5230&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // add to the list of user components</div>
<div>5231&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_userComponents.add(copy);</div>
<div>5232&emsp;&emsp;</div>
<div>5233&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (installListener && m_firstUserComponentOpp) {</div>
<div>5234&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        try {</div>
<div>5235&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          installWindowListenerForSavingUserStuff();</div>
<div>5236&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_firstUserComponentOpp = false;</div>
<div>5237&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } catch (Exception ex) {</div>
<div>5238&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ex.printStackTrace();</div>
<div>5239&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5240&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5241&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>5242&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ex.printStackTrace();</div>
<div>5243&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5244&emsp;&emsp;</div>
<div>5245&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>5246&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * java.awt.Color bckC = getBackground(); Vector beans =</div>
<div>5247&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * BeanInstance.getBeanInstances(m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5248&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * detachFromLayout(beans);</div>
<div>5249&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>5250&emsp;&emsp;</div>
<div>5251&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // Disconnect any beans connected to the inputs or outputs</div>
<div>5252&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // of this MetaBean (prevents serialization of the entire</div>
<div>5253&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // KnowledgeFlow!!)</div>
<div>5254&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>5255&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Vector tempRemovedConnections = new Vector(); Vector allConnections =</div>
<div>5256&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * BeanConnection.getConnections(m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5257&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Vector inputs = bean.getInputs(); Vector outputs = bean.getOutputs();</div>
<div>5258&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Vector allComps = bean.getSubFlow();</div>
<div>5259&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5260&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * for (int i = 0; i &#60; inputs.size(); i++) { BeanInstance temp =</div>
<div>5261&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * (BeanInstance)inputs.elementAt(i); // is this input a target for some</div>
<div>5262&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * event? for (int j = 0; j &#60; allConnections.size(); j++) { BeanConnection</div>
<div>5263&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * tempC = (BeanConnection)allConnections.elementAt(j); if</div>
<div>5264&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * (tempC.getTarget() == temp) { tempRemovedConnections.add(tempC); }</div>
<div>5265&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5266&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * // also check to see if this input is a source for // some target that is</div>
<div>5267&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * *not* in the subFlow if (tempC.getSource() == temp &&</div>
<div>5268&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * !bean.subFlowContains(tempC.getTarget())) {</div>
<div>5269&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * tempRemovedConnections.add(tempC); } } }</div>
<div>5270&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5271&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * for (int i = 0; i &#60; outputs.size(); i++) { BeanInstance temp =</div>
<div>5272&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * (BeanInstance)outputs.elementAt(i); // is this output a source for some</div>
<div>5273&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * target? for (int j = 0; j &#60; allConnections.size(); j++) { BeanConnection</div>
<div>5274&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * tempC = (BeanConnection)allConnections.elementAt(j); if</div>
<div>5275&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * (tempC.getSource() == temp) { tempRemovedConnections.add(tempC); } } }</div>
<div>5276&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5277&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5278&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * for (int i = 0; i &#60; tempRemovedConnections.size(); i++) { BeanConnection</div>
<div>5279&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * temp = (BeanConnection)tempRemovedConnections.elementAt(i);</div>
<div>5280&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * temp.remove(m_mainKFPerspective.getCurrentTabIndex()); }</div>
<div>5281&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5282&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * MetaBean copy = copyMetaBean(bean, true);</div>
<div>5283&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5284&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * String displayName =""; ImageIcon scaledIcon = null; // if (copy</div>
<div>5285&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * instanceof Visible) { //((Visible)copy).getVisual().scale(3); scaledIcon</div>
<div>5286&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * = new ImageIcon(((Visible)copy).getVisual().scale(0.33)); displayName =</div>
<div>5287&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * ((Visible)copy).getVisual().getText(); }</div>
<div>5288&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5289&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * JTreeLeafDetails metaLeaf = new JTreeLeafDetails(displayName, copy,</div>
<div>5290&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * scaledIcon); DefaultMutableTreeNode newUserComp = new</div>
<div>5291&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * DefaultMutableTreeNode(metaLeaf); model.insertNodeInto(newUserComp,</div>
<div>5292&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * m_userCompNode, 0);</div>
<div>5293&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5294&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * // add to the list of user components m_userComponents.add(copy);</div>
<div>5295&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5296&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * if (installListener && m_firstUserComponentOpp) { try {</div>
<div>5297&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * installWindowListenerForSavingUserBeans(); m_firstUserComponentOpp =</div>
<div>5298&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * false; } catch (Exception ex) { ex.printStackTrace(); } }</div>
<div>5299&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5300&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * // Now reinstate any deleted connections to the original MetaBean for</div>
<div>5301&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * (int i = 0; i &#60; tempRemovedConnections.size(); i++) { BeanConnection temp</div>
<div>5302&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * = (BeanConnection)tempRemovedConnections.elementAt(i); BeanConnection</div>
<div>5303&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * newC = new BeanConnection(temp.getSource(), temp.getTarget(),</div>
<div>5304&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * temp.getSourceEventSetDescriptor(),</div>
<div>5305&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * m_mainKFPerspective.getCurrentTabIndex()); }</div>
<div>5306&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>5307&emsp;&emsp;</div>
<div>5308&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>5309&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * for (int i = 0; i &#60; beans.size(); i++) { BeanInstance tempB =</div>
<div>5310&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * (BeanInstance)beans.elementAt(i); if (tempB.getBean() instanceof Visible)</div>
<div>5311&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * { ((Visible)(tempB.getBean())).getVisual().</div>
<div>5312&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * addPropertyChangeListener(KnowledgeFlowApp.this);</div>
<div>5313&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>5314&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * if (tempB.getBean() instanceof MetaBean) { ((MetaBean)tempB.getBean()).</div>
<div>5315&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * addPropertyChangeListenersSubFlow(KnowledgeFlowApp.this); } // Restore</div>
<div>5316&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * the default background colour ((Visible)(tempB.getBean())).getVisual().</div>
<div>5317&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * setBackground(bckC); ((JComponent)(tempB.getBean())).setBackground(bckC);</div>
<div>5318&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * } }</div>
<div>5319&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>5320&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5321&emsp;&emsp;</div>
<div>5322&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>5323&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Set the contents of the "paste" buffer and enable the paste from cliboard</div>
<div>5324&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * toolbar button</div>
<div>5325&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>5326&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param b the buffer to use</div>
<div>5327&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>5328&emsp;&emsp;&nbsp;&nbsp;  public void setPasteBuffer(StringBuffer b) {</div>
<div>5329&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_pasteBuffer = b;</div>
<div>5330&emsp;&emsp;</div>
<div>5331&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_pasteBuffer != null && m_pasteBuffer.length() > 0) {</div>
<div>5332&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_pasteB.setEnabled(true);</div>
<div>5333&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5334&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5335&emsp;&emsp;</div>
<div>5336&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>5337&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Get the contents of the paste buffer</div>
<div>5338&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>5339&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @return the contents of the paste buffer</div>
<div>5340&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>5341&emsp;&emsp;&nbsp;&nbsp;  public StringBuffer getPasteBuffer() {</div>
<div>5342&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return m_pasteBuffer;</div>
<div>5343&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5344&emsp;&emsp;</div>
<div>5345&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>5346&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Utility routine that serializes the supplied Vector of BeanInstances to XML</div>
<div>5347&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>5348&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param selectedBeans the vector of BeanInstances to serialize</div>
<div>5349&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @return a StringBuffer containing the serialized vector</div>
<div>5350&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @throws Exception if a problem occurs</div>
<div>5351&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>5352&emsp;&emsp;&nbsp;&nbsp;  public StringBuffer copyToBuffer(Vector&#60;Object> selectedBeans)</div>
<div>5353&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    throws Exception {</div>
<div>5354&emsp;&emsp;</div>
<div>5355&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;BeanConnection> associatedConnections = BeanConnection</div>
<div>5356&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .getConnections(m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5357&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>5358&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * BeanConnection.associatedConnections(selectedBeans,</div>
<div>5359&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5360&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>5361&emsp;&emsp;</div>
<div>5362&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // xml serialize to a string and store in the</div>
<div>5363&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // clipboard variable</div>
<div>5364&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Vector&#60;?>> v = new Vector&#60;Vector&#60;?>>();</div>
<div>5365&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    v.setSize(2);</div>
<div>5366&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    v.set(XMLBeans.INDEX_BEANINSTANCES, selectedBeans);</div>
<div>5367&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    v.set(XMLBeans.INDEX_BEANCONNECTIONS, associatedConnections);</div>
<div>5368&emsp;&emsp;</div>
<div>5369&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    XMLBeans xml = new XMLBeans(m_beanLayout, m_bcSupport,</div>
<div>5370&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5371&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    java.io.StringWriter sw = new java.io.StringWriter();</div>
<div>5372&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    xml.write(sw, v);</div>
<div>5373&emsp;&emsp;</div>
<div>5374&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return sw.getBuffer();</div>
<div>5375&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // System.out.println(m_pasteBuffer.toString());</div>
<div>5376&emsp;&emsp;</div>
<div>5377&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5378&emsp;&emsp;</div>
<div>5379&emsp;&emsp;&nbsp;&nbsp;  private boolean copyToClipboard() {</div>
<div>5380&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> selectedBeans = m_mainKFPerspective.getSelectedBeans();</div>
<div>5381&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (selectedBeans == null || selectedBeans.size() == 0) {</div>
<div>5382&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return false;</div>
<div>5383&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5384&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // m_mainKFPerspective.setSelectedBeans(new Vector());</div>
<div>5385&emsp;&emsp;</div>
<div>5386&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>5387&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_pasteBuffer = copyToBuffer(selectedBeans);</div>
<div>5388&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>5389&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanel.logMessage("[KnowledgeFlow] problem copying beans: "</div>
<div>5390&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        + ex.getMessage());</div>
<div>5391&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ex.printStackTrace();</div>
<div>5392&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return false;</div>
<div>5393&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5394&emsp;&emsp;</div>
<div>5395&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_pasteB.setEnabled(true);</div>
<div>5396&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    revalidate();</div>
<div>5397&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    repaint();</div>
<div>5398&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    notifyIsDirty();</div>
<div>5399&emsp;&emsp;</div>
<div>5400&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return true;</div>
<div>5401&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5402&emsp;&emsp;</div>
<div>5403&emsp;&emsp;&nbsp;&nbsp;  protected boolean pasteFromBuffer(int x, int y, StringBuffer pasteBuffer,</div>
<div>5404&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean addUndoPoint) {</div>
<div>5405&emsp;&emsp;</div>
<div>5406&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (addUndoPoint) {</div>
<div>5407&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      addUndoPoint();</div>
<div>5408&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5409&emsp;&emsp;</div>
<div>5410&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    java.io.StringReader sr = new java.io.StringReader(pasteBuffer.toString());</div>
<div>5411&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>5412&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      XMLBeans xml = new XMLBeans(m_beanLayout, m_bcSupport,</div>
<div>5413&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5414&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @SuppressWarnings("unchecked")</div>
<div>5415&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Vector&#60;?>> v = (Vector&#60;Vector&#60;?>>) xml.read(sr);</div>
<div>5416&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @SuppressWarnings("unchecked")</div>
<div>5417&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Object> beans = (Vector&#60;Object>) v</div>
<div>5418&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .get(XMLBeans.INDEX_BEANINSTANCES);</div>
<div>5419&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @SuppressWarnings("unchecked")</div>
<div>5420&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;BeanConnection> connections = (Vector&#60;BeanConnection>) v</div>
<div>5421&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .get(XMLBeans.INDEX_BEANCONNECTIONS);</div>
<div>5422&emsp;&emsp;</div>
<div>5423&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>5424&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeanInstance b = (BeanInstance) beans.get(i);</div>
<div>5425&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (b.getBean() instanceof MetaBean) {</div>
<div>5426&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Vector&#60;Object> subFlow = ((MetaBean) b.getBean()).getSubFlow();</div>
<div>5427&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          for (int j = 0; j &#60; subFlow.size(); j++) {</div>
<div>5428&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            BeanInstance subB = (BeanInstance) subFlow.get(j);</div>
<div>5429&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            subB.removeBean(m_beanLayout,</div>
<div>5430&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5431&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (subB.getBean() instanceof Visible) {</div>
<div>5432&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              ((Visible) subB.getBean()).getVisual()</div>
<div>5433&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                .removePropertyChangeListener(this);</div>
<div>5434&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>5435&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5436&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5437&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5438&emsp;&emsp;</div>
<div>5439&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // adjust beans coords with respect to x, y. Look for</div>
<div>5440&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // the smallest x and the smallest y (top left corner of the bounding)</div>
<div>5441&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // box.</div>
<div>5442&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      int minX = Integer.MAX_VALUE;</div>
<div>5443&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      int minY = Integer.MAX_VALUE;</div>
<div>5444&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      boolean adjust = false;</div>
<div>5445&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>5446&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeanInstance b = (BeanInstance) beans.get(i);</div>
<div>5447&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (b.getX() &#60; minX) {</div>
<div>5448&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          minX = b.getX();</div>
<div>5449&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          adjust = true;</div>
<div>5450&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5451&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (b.getY() &#60; minY) {</div>
<div>5452&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          minY = b.getY();</div>
<div>5453&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          adjust = true;</div>
<div>5454&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5455&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5456&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (adjust) {</div>
<div>5457&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int deltaX = x - minX;</div>
<div>5458&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int deltaY = y - minY;</div>
<div>5459&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>5460&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          BeanInstance b = (BeanInstance) beans.get(i);</div>
<div>5461&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          /*</div>
<div>5462&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           * b.setX(b.getX() + deltaX); b.setY(b.getY() + deltaY);</div>
<div>5463&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           */</div>
<div>5464&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          b.setXY(b.getX() + deltaX, b.getY() + deltaY);</div>
<div>5465&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5466&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5467&emsp;&emsp;</div>
<div>5468&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // integrate these beans</div>
<div>5469&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      integrateFlow(beans, connections, false, false);</div>
<div>5470&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>5471&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        checkForDuplicateName((BeanInstance) beans.get(i));</div>
<div>5472&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5473&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      setEnvironment();</div>
<div>5474&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      notifyIsDirty();</div>
<div>5475&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setSelectedBeans(beans);</div>
<div>5476&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception e) {</div>
<div>5477&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanel.logMessage("[KnowledgeFlow] problem pasting beans: "</div>
<div>5478&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        + e.getMessage());</div>
<div>5479&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      e.printStackTrace();</div>
<div>5480&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5481&emsp;&emsp;</div>
<div>5482&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    revalidate();</div>
<div>5483&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    notifyIsDirty();</div>
<div>5484&emsp;&emsp;</div>
<div>5485&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return true;</div>
<div>5486&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5487&emsp;&emsp;</div>
<div>5488&emsp;&emsp;&nbsp;&nbsp;  private boolean pasteFromClipboard(int x, int y, StringBuffer pasteBuffer,</div>
<div>5489&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean addUndoPoint) {</div>
<div>5490&emsp;&emsp;</div>
<div>5491&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return pasteFromBuffer(x, y, pasteBuffer, addUndoPoint);</div>
<div>5492&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5493&emsp;&emsp;</div>
<div>5494&emsp;&emsp;&nbsp;&nbsp;  private void deleteSelectedBeans() {</div>
<div>5495&emsp;&emsp;</div>
<div>5496&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> v = m_mainKFPerspective.getSelectedBeans();</div>
<div>5497&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (v.size() > 0) {</div>
<div>5498&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setSelectedBeans(new Vector&#60;Object>());</div>
<div>5499&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5500&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    addUndoPoint();</div>
<div>5501&emsp;&emsp;</div>
<div>5502&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; v.size(); i++) {</div>
<div>5503&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance b = (BeanInstance) v.get(i);</div>
<div>5504&emsp;&emsp;</div>
<div>5505&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanConnection.removeConnections(b,</div>
<div>5506&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5507&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      b.removeBean(m_beanLayout, m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5508&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (b instanceof BeanCommon) {</div>
<div>5509&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String key = ((BeanCommon) b).getCustomName() + "$" + b.hashCode();</div>
<div>5510&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_logPanel.statusMessage(key + "|remove");</div>
<div>5511&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5512&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5513&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_mainKFPerspective.setSelectedBeans(new Vector&#60;Object>());</div>
<div>5514&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    revalidate();</div>
<div>5515&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    notifyIsDirty();</div>
<div>5516&emsp;&emsp;</div>
<div>5517&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_selectAllB.setEnabled(BeanInstance.getBeanInstances(</div>
<div>5518&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getCurrentTabIndex()).size() > 0);</div>
<div>5519&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5520&emsp;&emsp;</div>
<div>5521&emsp;&emsp;&nbsp;&nbsp;  private void addUndoPoint() {</div>
<div>5522&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>5523&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Stack&#60;File> undo = m_mainKFPerspective.getUndoBuffer();</div>
<div>5524&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      File tempFile = File.createTempFile("knowledgeFlow", FILE_EXTENSION_XML);</div>
<div>5525&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      tempFile.deleteOnExit();</div>
<div>5526&emsp;&emsp;</div>
<div>5527&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (saveLayout(tempFile, m_mainKFPerspective.getCurrentTabIndex(), true)) {</div>
<div>5528&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        undo.push(tempFile);</div>
<div>5529&emsp;&emsp;</div>
<div>5530&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // keep no more than 20 undo points</div>
<div>5531&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (undo.size() > 20) {</div>
<div>5532&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          undo.remove(0);</div>
<div>5533&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5534&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_undoB.setEnabled(true);</div>
<div>5535&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5536&emsp;&emsp;</div>
<div>5537&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>5538&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanel</div>
<div>5539&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .logMessage("[KnowledgeFlow] a problem occurred while trying to "</div>
<div>5540&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "create a undo point : " + ex.getMessage());</div>
<div>5541&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5542&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5543&emsp;&emsp;</div>
<div>5544&emsp;&emsp;&nbsp;&nbsp;  private boolean groupable(Vector&#60;Object> selected, Vector&#60;Object> inputs,</div>
<div>5545&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> outputs) {</div>
<div>5546&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean groupable = true;</div>
<div>5547&emsp;&emsp;</div>
<div>5548&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // screen the inputs and outputs</div>
<div>5549&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (inputs.size() == 0 || outputs.size() == 0) {</div>
<div>5550&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return false;</div>
<div>5551&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5552&emsp;&emsp;</div>
<div>5553&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // dissallow MetaBeans in the selected set (for the</div>
<div>5554&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // time being).</div>
<div>5555&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; selected.size(); i++) {</div>
<div>5556&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance temp = (BeanInstance) selected.elementAt(i);</div>
<div>5557&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (temp.getBean() instanceof MetaBean) {</div>
<div>5558&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        groupable = false;</div>
<div>5559&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return false;</div>
<div>5560&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5561&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5562&emsp;&emsp;</div>
<div>5563&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // show connector dots for input beans</div>
<div>5564&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; inputs.size(); i++) {</div>
<div>5565&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance temp = (BeanInstance) inputs.elementAt(i);</div>
<div>5566&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (temp.getBean() instanceof Visible) {</div>
<div>5567&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((Visible) temp.getBean()).getVisual().setDisplayConnectors(true,</div>
<div>5568&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          java.awt.Color.red);</div>
<div>5569&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5570&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5571&emsp;&emsp;</div>
<div>5572&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // show connector dots for output beans</div>
<div>5573&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; outputs.size(); i++) {</div>
<div>5574&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance temp = (BeanInstance) outputs.elementAt(i);</div>
<div>5575&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (temp.getBean() instanceof Visible) {</div>
<div>5576&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((Visible) temp.getBean()).getVisual().setDisplayConnectors(true,</div>
<div>5577&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          java.awt.Color.green);</div>
<div>5578&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5579&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5580&emsp;&emsp;</div>
<div>5581&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return groupable;</div>
<div>5582&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5583&emsp;&emsp;</div>
<div>5584&emsp;&emsp;&nbsp;&nbsp;  // right click over empty canvas (not on a bean)</div>
<div>5585&emsp;&emsp;&nbsp;&nbsp;  private void rightClickCanvasPopup(final int x, final int y) {</div>
<div>5586&emsp;&emsp;</div>
<div>5587&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;BeanConnection> closestConnections = BeanConnection</div>
<div>5588&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .getClosestConnections(new Point(x, y), 10,</div>
<div>5589&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5590&emsp;&emsp;</div>
<div>5591&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    PopupMenu rightClickMenu = new PopupMenu();</div>
<div>5592&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int menuItemCount = 0;</div>
<div>5593&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_mainKFPerspective.getSelectedBeans().size() > 0</div>
<div>5594&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      || closestConnections.size() > 0</div>
<div>5595&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      || (m_pasteBuffer != null && m_pasteBuffer.length() > 0)) {</div>
<div>5596&emsp;&emsp;</div>
<div>5597&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_mainKFPerspective.getSelectedBeans().size() > 0) {</div>
<div>5598&emsp;&emsp;</div>
<div>5599&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MenuItem snapItem = new MenuItem("Snap selected to grid");</div>
<div>5600&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        snapItem.addActionListener(new ActionListener() {</div>
<div>5601&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>5602&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>5603&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            snapSelectedToGrid();</div>
<div>5604&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5605&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>5606&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        rightClickMenu.add(snapItem);</div>
<div>5607&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>5608&emsp;&emsp;</div>
<div>5609&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MenuItem copyItem = new MenuItem("Copy selected");</div>
<div>5610&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        copyItem.addActionListener(new ActionListener() {</div>
<div>5611&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>5612&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>5613&emsp;&emsp;</div>
<div>5614&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            copyToClipboard();</div>
<div>5615&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.setSelectedBeans(new Vector&#60;Object>());</div>
<div>5616&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5617&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>5618&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        rightClickMenu.add(copyItem);</div>
<div>5619&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>5620&emsp;&emsp;</div>
<div>5621&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MenuItem cutItem = new MenuItem("Cut selected");</div>
<div>5622&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        cutItem.addActionListener(new ActionListener() {</div>
<div>5623&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>5624&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>5625&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // only delete if our copy was successful!</div>
<div>5626&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (copyToClipboard()) {</div>
<div>5627&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              deleteSelectedBeans();</div>
<div>5628&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>5629&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5630&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>5631&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        rightClickMenu.add(cutItem);</div>
<div>5632&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>5633&emsp;&emsp;</div>
<div>5634&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MenuItem deleteSelected = new MenuItem("Delete selected");</div>
<div>5635&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        deleteSelected.addActionListener(new ActionListener() {</div>
<div>5636&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>5637&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>5638&emsp;&emsp;</div>
<div>5639&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            deleteSelectedBeans();</div>
<div>5640&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5641&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>5642&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        rightClickMenu.add(deleteSelected);</div>
<div>5643&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>5644&emsp;&emsp;</div>
<div>5645&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // Able to group selected subflow?</div>
<div>5646&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Vector&#60;Object> selected = m_mainKFPerspective.getSelectedBeans();</div>
<div>5647&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // check if sub flow is valid</div>
<div>5648&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Vector&#60;Object> inputs = BeanConnection.inputs(selected,</div>
<div>5649&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5650&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        final Vector&#60;Object> outputs = BeanConnection.outputs(selected,</div>
<div>5651&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5652&emsp;&emsp;</div>
<div>5653&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        boolean groupable = groupable(selected, inputs, outputs);</div>
<div>5654&emsp;&emsp;</div>
<div>5655&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (groupable) {</div>
<div>5656&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          MenuItem groupItem = new MenuItem("Group selected");</div>
<div>5657&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          groupItem.addActionListener(new ActionListener() {</div>
<div>5658&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            @Override</div>
<div>5659&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            public void actionPerformed(ActionEvent e) {</div>
<div>5660&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              groupSubFlow(selected, inputs, outputs);</div>
<div>5661&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>5662&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          });</div>
<div>5663&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          rightClickMenu.add(groupItem);</div>
<div>5664&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          menuItemCount++;</div>
<div>5665&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5666&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5667&emsp;&emsp;</div>
<div>5668&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_pasteBuffer != null && m_pasteBuffer.length() > 0) {</div>
<div>5669&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        rightClickMenu.addSeparator();</div>
<div>5670&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>5671&emsp;&emsp;</div>
<div>5672&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MenuItem pasteItem = new MenuItem("Paste");</div>
<div>5673&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        pasteItem.addActionListener(new ActionListener() {</div>
<div>5674&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          @Override</div>
<div>5675&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          public void actionPerformed(ActionEvent e) {</div>
<div>5676&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // deserialize, integerate and</div>
<div>5677&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // position at x, y</div>
<div>5678&emsp;&emsp;</div>
<div>5679&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            pasteFromClipboard(x, y, m_pasteBuffer, true);</div>
<div>5680&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5681&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        });</div>
<div>5682&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        rightClickMenu.add(pasteItem);</div>
<div>5683&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>5684&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5685&emsp;&emsp;</div>
<div>5686&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (closestConnections.size() > 0) {</div>
<div>5687&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        rightClickMenu.addSeparator();</div>
<div>5688&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>5689&emsp;&emsp;</div>
<div>5690&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MenuItem deleteConnection = new MenuItem("Delete Connection:");</div>
<div>5691&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        deleteConnection.setEnabled(false);</div>
<div>5692&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        rightClickMenu.insert(deleteConnection, menuItemCount);</div>
<div>5693&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        menuItemCount++;</div>
<div>5694&emsp;&emsp;</div>
<div>5695&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; closestConnections.size(); i++) {</div>
<div>5696&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          final BeanConnection bc = closestConnections.elementAt(i);</div>
<div>5697&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String connName = bc.getSourceEventSetDescriptor().getName();</div>
<div>5698&emsp;&emsp;</div>
<div>5699&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // JMenuItem deleteItem = new JMenuItem(connName);</div>
<div>5700&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String targetName = "";</div>
<div>5701&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (bc.getTarget().getBean() instanceof BeanCommon) {</div>
<div>5702&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            targetName = ((BeanCommon) bc.getTarget().getBean())</div>
<div>5703&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .getCustomName();</div>
<div>5704&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } else {</div>
<div>5705&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            targetName = bc.getTarget().getBean().getClass().getName();</div>
<div>5706&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            targetName = targetName.substring(targetName.lastIndexOf('.') + 1,</div>
<div>5707&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              targetName.length());</div>
<div>5708&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5709&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          MenuItem deleteItem = new MenuItem(connName + "-->" + targetName);</div>
<div>5710&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          deleteItem.addActionListener(new ActionListener() {</div>
<div>5711&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            @Override</div>
<div>5712&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            public void actionPerformed(ActionEvent e) {</div>
<div>5713&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              addUndoPoint();</div>
<div>5714&emsp;&emsp;</div>
<div>5715&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              bc.remove(m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5716&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_beanLayout.revalidate();</div>
<div>5717&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_beanLayout.repaint();</div>
<div>5718&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_mainKFPerspective.setEditedStatus(true);</div>
<div>5719&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (m_mainKFPerspective.getSelectedBeans().size() > 0) {</div>
<div>5720&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                m_mainKFPerspective.setSelectedBeans(new Vector&#60;Object>());</div>
<div>5721&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>5722&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              notifyIsDirty();</div>
<div>5723&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>5724&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          });</div>
<div>5725&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          rightClickMenu.add(deleteItem);</div>
<div>5726&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          menuItemCount++;</div>
<div>5727&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5728&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5729&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5730&emsp;&emsp;</div>
<div>5731&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (menuItemCount > 0) {</div>
<div>5732&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      rightClickMenu.addSeparator();</div>
<div>5733&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      menuItemCount++;</div>
<div>5734&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5735&emsp;&emsp;</div>
<div>5736&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    MenuItem noteItem = new MenuItem("New note");</div>
<div>5737&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    noteItem.addActionListener(new ActionListener() {</div>
<div>5738&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @Override</div>
<div>5739&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      public void actionPerformed(ActionEvent e) {</div>
<div>5740&emsp;&emsp;</div>
<div>5741&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Note n = new Note();</div>
<div>5742&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_toolBarBean = n;</div>
<div>5743&emsp;&emsp;</div>
<div>5744&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KnowledgeFlowApp.this.setCursor(Cursor</div>
<div>5745&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getPredefinedCursor(Cursor.CROSSHAIR_CURSOR));</div>
<div>5746&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mode = ADDING;</div>
<div>5747&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5748&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    });</div>
<div>5749&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    rightClickMenu.add(noteItem);</div>
<div>5750&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    menuItemCount++;</div>
<div>5751&emsp;&emsp;</div>
<div>5752&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_beanLayout.add(rightClickMenu);</div>
<div>5753&emsp;&emsp;</div>
<div>5754&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // make sure that popup location takes current scaling into account</div>
<div>5755&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    double z = m_layoutZoom / 100.0;</div>
<div>5756&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    double px = x * z;</div>
<div>5757&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    double py = y * z;</div>
<div>5758&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    rightClickMenu.show(m_beanLayout, (int) px, (int) py);</div>
<div>5759&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5760&emsp;&emsp;</div>
<div>5761&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>5762&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Initiates the connection process for two beans</div>
<div>5763&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>5764&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param esd the EventSetDescriptor for the source bean</div>
<div>5765&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param bi the source bean</div>
<div>5766&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param x the x coordinate to start connecting from</div>
<div>5767&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param y the y coordinate to start connecting from</div>
<div>5768&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>5769&emsp;&emsp;&nbsp;&nbsp;  private void connectComponents(EventSetDescriptor esd, BeanInstance bi,</div>
<div>5770&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int x, int y) {</div>
<div>5771&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // unselect any selected beans on the canvas</div>
<div>5772&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_mainKFPerspective.getSelectedBeans(</div>
<div>5773&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getCurrentTabIndex()).size() > 0) {</div>
<div>5774&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setSelectedBeans(</div>
<div>5775&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex(), new Vector&#60;Object>());</div>
<div>5776&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5777&emsp;&emsp;</div>
<div>5778&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // record the event set descriptior for this event</div>
<div>5779&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_sourceEventSetDescriptor = esd;</div>
<div>5780&emsp;&emsp;</div>
<div>5781&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Class&#60;?> listenerClass = esd.getListenerType(); // class of the listener</div>
<div>5782&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    JComponent source = (JComponent) bi.getBean();</div>
<div>5783&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // now determine which (if any) of the other beans implement this</div>
<div>5784&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // listener</div>
<div>5785&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int targetCount = 0;</div>
<div>5786&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> beanInstances = BeanInstance</div>
<div>5787&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .getBeanInstances(m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5788&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; beanInstances.size(); i++) {</div>
<div>5789&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      JComponent bean =</div>
<div>5790&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        (JComponent) ((BeanInstance) beanInstances.elementAt(i))</div>
<div>5791&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getBean();</div>
<div>5792&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      boolean connectable = false;</div>
<div>5793&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      boolean canContinue = false;</div>
<div>5794&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (bean != source) {</div>
<div>5795&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (bean instanceof MetaBean) {</div>
<div>5796&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (((MetaBean) bean).canAcceptConnection(listenerClass)) {</div>
<div>5797&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            canContinue = true;</div>
<div>5798&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5799&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else if (listenerClass.isInstance(bean) && bean != source) {</div>
<div>5800&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          canContinue = true;</div>
<div>5801&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5802&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5803&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (canContinue) {</div>
<div>5804&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!(bean instanceof BeanCommon)) {</div>
<div>5805&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          connectable = true; // assume this bean is happy to receive a</div>
<div>5806&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                              // connection</div>
<div>5807&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else {</div>
<div>5808&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // give this bean a chance to veto any proposed connection via</div>
<div>5809&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // the listener interface</div>
<div>5810&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (((BeanCommon) bean).</div>
<div>5811&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // connectionAllowed(esd.getName())) {</div>
<div>5812&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            connectionAllowed(esd)) {</div>
<div>5813&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            connectable = true;</div>
<div>5814&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5815&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5816&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (connectable) {</div>
<div>5817&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (bean instanceof Visible) {</div>
<div>5818&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            targetCount++;</div>
<div>5819&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((Visible) bean).getVisual().setDisplayConnectors(true);</div>
<div>5820&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5821&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5822&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5823&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5824&emsp;&emsp;</div>
<div>5825&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // have some possible beans to connect to?</div>
<div>5826&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (targetCount > 0) {</div>
<div>5827&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // System.err.println("target count "+targetCount);</div>
<div>5828&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (source instanceof Visible) {</div>
<div>5829&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((Visible) source).getVisual().setDisplayConnectors(true);</div>
<div>5830&emsp;&emsp;</div>
<div>5831&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_editElement = bi;</div>
<div>5832&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Point closest = ((Visible) source).getVisual()</div>
<div>5833&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getClosestConnectorPoint(new Point(x, y));</div>
<div>5834&emsp;&emsp;</div>
<div>5835&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_startX = (int) closest.getX();</div>
<div>5836&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_startY = (int) closest.getY();</div>
<div>5837&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_oldX = m_startX;</div>
<div>5838&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_oldY = m_startY;</div>
<div>5839&emsp;&emsp;</div>
<div>5840&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Graphics2D gx = (Graphics2D) m_beanLayout.getGraphics();</div>
<div>5841&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        gx.setXORMode(java.awt.Color.white);</div>
<div>5842&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        gx.drawLine(m_startX, m_startY, m_startX, m_startY);</div>
<div>5843&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        gx.dispose();</div>
<div>5844&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mode = CONNECTING;</div>
<div>5845&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5846&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5847&emsp;&emsp;</div>
<div>5848&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    revalidate();</div>
<div>5849&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    repaint();</div>
<div>5850&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    notifyIsDirty();</div>
<div>5851&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5852&emsp;&emsp;</div>
<div>5853&emsp;&emsp;&nbsp;&nbsp;  private void checkForDuplicateName(BeanInstance comp) {</div>
<div>5854&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (comp.getBean() instanceof BeanCommon) {</div>
<div>5855&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String currentName = ((BeanCommon) comp.getBean()).getCustomName();</div>
<div>5856&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (currentName != null && currentName.length() > 0) {</div>
<div>5857&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;Object> layoutBeans = BeanInstance</div>
<div>5858&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getBeanInstances(m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5859&emsp;&emsp;</div>
<div>5860&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        boolean exactMatch = false;</div>
<div>5861&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int maxCopyNum = 1;</div>
<div>5862&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; layoutBeans.size(); i++) {</div>
<div>5863&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          BeanInstance b = (BeanInstance) layoutBeans.get(i);</div>
<div>5864&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (b.getBean() instanceof BeanCommon) {</div>
<div>5865&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            String compName = ((BeanCommon) b.getBean()).getCustomName();</div>
<div>5866&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (currentName.equals(compName) && (b.getBean() != comp.getBean())) {</div>
<div>5867&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              exactMatch = true;</div>
<div>5868&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            } else {</div>
<div>5869&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (compName.startsWith(currentName)) {</div>
<div>5870&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                // see if the comparison bean has a number at the end</div>
<div>5871&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                String num = compName.replace(currentName, "");</div>
<div>5872&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                try {</div>
<div>5873&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  int compNum = Integer.parseInt(num);</div>
<div>5874&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  if (compNum > maxCopyNum) {</div>
<div>5875&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    maxCopyNum = compNum;</div>
<div>5876&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  }</div>
<div>5877&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                } catch (NumberFormatException e) {</div>
<div>5878&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                }</div>
<div>5879&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>5880&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>5881&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>5882&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5883&emsp;&emsp;</div>
<div>5884&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (exactMatch) {</div>
<div>5885&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          maxCopyNum++;</div>
<div>5886&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          currentName += "" + maxCopyNum;</div>
<div>5887&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ((BeanCommon) comp.getBean()).setCustomName(currentName);</div>
<div>5888&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>5889&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5890&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5891&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5892&emsp;&emsp;</div>
<div>5893&emsp;&emsp;&nbsp;&nbsp;  private void addComponent(BeanInstance comp, boolean repaint) {</div>
<div>5894&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (comp.getBean() instanceof Visible) {</div>
<div>5895&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ((Visible) comp.getBean()).getVisual().addPropertyChangeListener(this);</div>
<div>5896&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5897&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (comp.getBean() instanceof BeanCommon) {</div>
<div>5898&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ((BeanCommon) comp.getBean()).setLog(m_logPanel);</div>
<div>5899&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5900&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (comp.getBean() instanceof MetaBean) {</div>
<div>5901&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // re-align sub-beans</div>
<div>5902&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Object> list;</div>
<div>5903&emsp;&emsp;</div>
<div>5904&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      list = ((MetaBean) comp.getBean()).getInputs();</div>
<div>5905&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; list.size(); i++) {</div>
<div>5906&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((BeanInstance) list.get(i)).setX(comp.getX());</div>
<div>5907&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((BeanInstance) list.get(i)).setY(comp.getY());</div>
<div>5908&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5909&emsp;&emsp;</div>
<div>5910&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      list = ((MetaBean) comp.getBean()).getOutputs();</div>
<div>5911&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; list.size(); i++) {</div>
<div>5912&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((BeanInstance) list.get(i)).setX(comp.getX());</div>
<div>5913&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((BeanInstance) list.get(i)).setY(comp.getY());</div>
<div>5914&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5915&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5916&emsp;&emsp;</div>
<div>5917&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (comp.getBean() instanceof EnvironmentHandler) {</div>
<div>5918&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ((EnvironmentHandler) comp.getBean()).setEnvironment(m_flowEnvironment);</div>
<div>5919&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5920&emsp;&emsp;</div>
<div>5921&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // check for a duplicate name</div>
<div>5922&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    checkForDuplicateName(comp);</div>
<div>5923&emsp;&emsp;</div>
<div>5924&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    KnowledgeFlowApp.this.setCursor(Cursor</div>
<div>5925&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .getPredefinedCursor(Cursor.DEFAULT_CURSOR));</div>
<div>5926&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (repaint) {</div>
<div>5927&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_beanLayout.repaint();</div>
<div>5928&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5929&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_pointerB.setSelected(true);</div>
<div>5930&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_mode = NONE;</div>
<div>5931&emsp;&emsp;</div>
<div>5932&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_selectAllB.setEnabled(BeanInstance.getBeanInstances(</div>
<div>5933&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getCurrentTabIndex()).size() > 0);</div>
<div>5934&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5935&emsp;&emsp;</div>
<div>5936&emsp;&emsp;&nbsp;&nbsp;  private void addComponent(int x, int y) {</div>
<div>5937&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_toolBarBean instanceof MetaBean) {</div>
<div>5938&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // need to add the MetaBean's internal connections</div>
<div>5939&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // to BeanConnection's vector</div>
<div>5940&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;BeanConnection> associatedConnections = ((MetaBean) m_toolBarBean)</div>
<div>5941&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .getAssociatedConnections();</div>
<div>5942&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanConnection.getConnections(m_mainKFPerspective.getCurrentTabIndex())</div>
<div>5943&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .addAll(associatedConnections);</div>
<div>5944&emsp;&emsp;</div>
<div>5945&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // ((MetaBean)m_toolBarBean).setXDrop(x);</div>
<div>5946&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // ((MetaBean)m_toolBarBean).setYDrop(y);</div>
<div>5947&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ((MetaBean) m_toolBarBean)</div>
<div>5948&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .addPropertyChangeListenersSubFlow(KnowledgeFlowApp.this);</div>
<div>5949&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5950&emsp;&emsp;</div>
<div>5951&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_toolBarBean instanceof BeanContextChild) {</div>
<div>5952&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_bcSupport.add(m_toolBarBean);</div>
<div>5953&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>5954&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    BeanInstance bi = new BeanInstance(m_beanLayout, m_toolBarBean, x, y,</div>
<div>5955&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5956&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // addBean((JComponent)bi.getBean());</div>
<div>5957&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_toolBarBean = null;</div>
<div>5958&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    addComponent(bi, true);</div>
<div>5959&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5960&emsp;&emsp;</div>
<div>5961&emsp;&emsp;&nbsp;&nbsp;  private void highlightSubFlow(int startX, int startY, int endX, int endY) {</div>
<div>5962&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    java.awt.Rectangle r = new java.awt.Rectangle((startX &#60; endX) ? startX</div>
<div>5963&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      : endX, (startY &#60; endY) ? startY : endY, Math.abs(startX - endX),</div>
<div>5964&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Math.abs(startY - endY));</div>
<div>5965&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // System.err.println(r);</div>
<div>5966&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> selected = BeanInstance.findInstances(r,</div>
<div>5967&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getCurrentTabIndex());</div>
<div>5968&emsp;&emsp;</div>
<div>5969&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // show connector dots for selected beans</div>
<div>5970&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>5971&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * for (int i = 0; i &#60; selected.size(); i++) { BeanInstance temp =</div>
<div>5972&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * (BeanInstance)selected.elementAt(i); if (temp.getBean() instanceof</div>
<div>5973&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * Visible) {</div>
<div>5974&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * ((Visible)temp.getBean()).getVisual().setDisplayConnectors(true); } }</div>
<div>5975&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>5976&emsp;&emsp;</div>
<div>5977&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_mainKFPerspective.setSelectedBeans(selected);</div>
<div>5978&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>5979&emsp;&emsp;</div>
<div>5980&emsp;&emsp;&nbsp;&nbsp;  private void groupSubFlow(Vector&#60;Object> selected, Vector&#60;Object> inputs,</div>
<div>5981&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> outputs) {</div>
<div>5982&emsp;&emsp;</div>
<div>5983&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int upperLeftX = Integer.MAX_VALUE;</div>
<div>5984&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int upperLeftY = Integer.MAX_VALUE;</div>
<div>5985&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int lowerRightX = Integer.MIN_VALUE;</div>
<div>5986&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int lowerRightY = Integer.MIN_VALUE;</div>
<div>5987&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; selected.size(); i++) {</div>
<div>5988&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance b = (BeanInstance) selected.get(i);</div>
<div>5989&emsp;&emsp;</div>
<div>5990&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (b.getX() &#60; upperLeftX) {</div>
<div>5991&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        upperLeftX = b.getX();</div>
<div>5992&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5993&emsp;&emsp;</div>
<div>5994&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (b.getY() &#60; upperLeftY) {</div>
<div>5995&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        upperLeftY = b.getY();</div>
<div>5996&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>5997&emsp;&emsp;</div>
<div>5998&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (b.getX() > lowerRightX) {</div>
<div>5999&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // ImageIcon ic = ((Visible)b.getBean()).getVisual().getStaticIcon();</div>
<div>6000&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // lowerRightX = (b.getX() + ic.getIconWidth());</div>
<div>6001&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        lowerRightX = b.getX();</div>
<div>6002&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6003&emsp;&emsp;</div>
<div>6004&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (b.getY() > lowerRightY) {</div>
<div>6005&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // ImageIcon ic = ((Visible)b.getBean()).getVisual().getStaticIcon();</div>
<div>6006&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // lowerRightY = (b.getY() + ic.getIconHeight());</div>
<div>6007&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        lowerRightY = b.getY();</div>
<div>6008&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6009&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6010&emsp;&emsp;</div>
<div>6011&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int bx = upperLeftX + ((lowerRightX - upperLeftX) / 2);</div>
<div>6012&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int by = upperLeftY + ((lowerRightY - upperLeftY) / 2);</div>
<div>6013&emsp;&emsp;</div>
<div>6014&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    new java.awt.Rectangle(upperLeftX, upperLeftY, lowerRightX, lowerRightY);</div>
<div>6015&emsp;&emsp;</div>
<div>6016&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>6017&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * BufferedImage subFlowPreview = null; try { subFlowPreview =</div>
<div>6018&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * createImage(m_beanLayout, r); } catch (IOException ex) {</div>
<div>6019&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * ex.printStackTrace(); // drop through quietly }</div>
<div>6020&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>6021&emsp;&emsp;</div>
<div>6022&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // Confirmation pop-up</div>
<div>6023&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int result = JOptionPane.showConfirmDialog(KnowledgeFlowApp.this,</div>
<div>6024&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      "Group this sub-flow?", "Group Components", JOptionPane.YES_NO_OPTION);</div>
<div>6025&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (result == JOptionPane.YES_OPTION) {</div>
<div>6026&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;BeanConnection> associatedConnections = BeanConnection</div>
<div>6027&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .associatedConnections(selected,</div>
<div>6028&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6029&emsp;&emsp;</div>
<div>6030&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String name = JOptionPane.showInputDialog(KnowledgeFlowApp.this,</div>
<div>6031&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        "Enter a name for this group", "MyGroup");</div>
<div>6032&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (name != null) {</div>
<div>6033&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        MetaBean group = new MetaBean();</div>
<div>6034&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // group.setXCreate(bx); group.setYCreate(by);</div>
<div>6035&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // group.setXDrop(bx); group.setYDrop(by);</div>
<div>6036&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        group.setSubFlow(selected);</div>
<div>6037&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        group.setAssociatedConnections(associatedConnections);</div>
<div>6038&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        group.setInputs(inputs);</div>
<div>6039&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        group.setOutputs(outputs);</div>
<div>6040&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // group.setSubFlowPreview(new ImageIcon(subFlowPreview));</div>
<div>6041&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (name.length() > 0) {</div>
<div>6042&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // group.getVisual().setText(name);</div>
<div>6043&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          group.setCustomName(name);</div>
<div>6044&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6045&emsp;&emsp;</div>
<div>6046&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // if (group instanceof BeanContextChild) {</div>
<div>6047&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // m_bcSupport.add(group);</div>
<div>6048&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // }</div>
<div>6049&emsp;&emsp;</div>
<div>6050&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // int bx = (int)r.getCenterX() -</div>
<div>6051&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // group.getVisual().m_icon.getIconWidth();</div>
<div>6052&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // int by = (int)r.getCenterY() -</div>
<div>6053&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // group.getVisual().m_icon.getIconHeight();</div>
<div>6054&emsp;&emsp;</div>
<div>6055&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        /*</div>
<div>6056&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         * BeanInstance bi = new BeanInstance(m_beanLayout, group,</div>
<div>6057&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         * (int)r.getX()+(int)(r.getWidth()/2),</div>
<div>6058&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         * (int)r.getY()+(int)(r.getHeight()/2),</div>
<div>6059&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         * m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6060&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         */</div>
<div>6061&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Dimension d = group.getPreferredSize();</div>
<div>6062&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ;</div>
<div>6063&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int dx = (int) (d.getWidth() / 2);</div>
<div>6064&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        int dy = (int) (d.getHeight() / 2);</div>
<div>6065&emsp;&emsp;</div>
<div>6066&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeanInstance bi = new BeanInstance(m_beanLayout, group, bx + dx, by</div>
<div>6067&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + dy, m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6068&emsp;&emsp;</div>
<div>6069&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; selected.size(); i++) {</div>
<div>6070&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          BeanInstance temp = (BeanInstance) selected.elementAt(i);</div>
<div>6071&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          temp.removeBean(m_beanLayout,</div>
<div>6072&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6073&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (temp.getBean() instanceof Visible) {</div>
<div>6074&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((Visible) temp.getBean()).getVisual()</div>
<div>6075&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .removePropertyChangeListener(this);</div>
<div>6076&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>6077&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6078&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; associatedConnections.size(); i++) {</div>
<div>6079&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          BeanConnection temp = associatedConnections.elementAt(i);</div>
<div>6080&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          temp.setHidden(true);</div>
<div>6081&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6082&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        group.shiftBeans(bi, true);</div>
<div>6083&emsp;&emsp;</div>
<div>6084&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        addComponent(bi, true);</div>
<div>6085&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6086&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6087&emsp;&emsp;</div>
<div>6088&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; selected.size(); i++) {</div>
<div>6089&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance temp = (BeanInstance) selected.elementAt(i);</div>
<div>6090&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (temp.getBean() instanceof Visible) {</div>
<div>6091&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((Visible) temp.getBean()).getVisual().setDisplayConnectors(false);</div>
<div>6092&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6093&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6094&emsp;&emsp;</div>
<div>6095&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_mainKFPerspective.setSelectedBeans(new Vector&#60;Object>());</div>
<div>6096&emsp;&emsp;</div>
<div>6097&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    revalidate();</div>
<div>6098&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    notifyIsDirty();</div>
<div>6099&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6100&emsp;&emsp;</div>
<div>6101&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6102&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Accept property change events</div>
<div>6103&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6104&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param e a &#60;code>PropertyChangeEvent&#60;/code> value</div>
<div>6105&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6106&emsp;&emsp;&nbsp;&nbsp;  @Override</div>
<div>6107&emsp;&emsp;&nbsp;&nbsp;  public void propertyChange(PropertyChangeEvent e) {</div>
<div>6108&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    revalidate();</div>
<div>6109&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_beanLayout.repaint();</div>
<div>6110&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6111&emsp;&emsp;</div>
<div>6112&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6113&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Load a pre-saved layout</div>
<div>6114&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6115&emsp;&emsp;&nbsp;&nbsp;  private void loadLayout() {</div>
<div>6116&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_loadB.setEnabled(false);</div>
<div>6117&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_saveB.setEnabled(false);</div>
<div>6118&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playB.setEnabled(false);</div>
<div>6119&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playBB.setEnabled(false);</div>
<div>6120&emsp;&emsp;</div>
<div>6121&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int returnVal = m_FileChooser.showOpenDialog(this);</div>
<div>6122&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (returnVal == JFileChooser.APPROVE_OPTION) {</div>
<div>6123&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // stopFlow();</div>
<div>6124&emsp;&emsp;</div>
<div>6125&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // determine filename</div>
<div>6126&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      File oFile = m_FileChooser.getSelectedFile();</div>
<div>6127&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // set internal flow directory environment variable</div>
<div>6128&emsp;&emsp;</div>
<div>6129&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // add extension if necessary</div>
<div>6130&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_FileChooser.getFileFilter() == m_KfFilter) {</div>
<div>6131&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!oFile.getName().toLowerCase().endsWith(FILE_EXTENSION)) {</div>
<div>6132&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          oFile = new File(oFile.getParent(), oFile.getName() + FILE_EXTENSION);</div>
<div>6133&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6134&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } else if (m_FileChooser.getFileFilter() == m_KOMLFilter) {</div>
<div>6135&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!oFile.getName().toLowerCase().endsWith(KOML.FILE_EXTENSION + "kf")) {</div>
<div>6136&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          oFile = new File(oFile.getParent(), oFile.getName()</div>
<div>6137&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + KOML.FILE_EXTENSION + "kf");</div>
<div>6138&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6139&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } else if (m_FileChooser.getFileFilter() == m_XMLFilter) {</div>
<div>6140&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!oFile.getName().toLowerCase().endsWith(FILE_EXTENSION_XML)) {</div>
<div>6141&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          oFile = new File(oFile.getParent(), oFile.getName()</div>
<div>6142&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + FILE_EXTENSION_XML);</div>
<div>6143&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6144&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } else if (m_FileChooser.getFileFilter() == m_XStreamFilter) {</div>
<div>6145&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!oFile.getName().toLowerCase()</div>
<div>6146&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .endsWith(XStream.FILE_EXTENSION + "kf")) {</div>
<div>6147&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          oFile = new File(oFile.getParent(), oFile.getName()</div>
<div>6148&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + XStream.FILE_EXTENSION + "kf");</div>
<div>6149&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6150&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6151&emsp;&emsp;</div>
<div>6152&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String flowName = oFile.getName();</div>
<div>6153&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (flowName.lastIndexOf('.') > 0) {</div>
<div>6154&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        flowName = flowName.substring(0, flowName.lastIndexOf('.'));</div>
<div>6155&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6156&emsp;&emsp;</div>
<div>6157&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      loadLayout(oFile, getAllowMultipleTabs());</div>
<div>6158&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6159&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_loadB.setEnabled(true);</div>
<div>6160&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playB.setEnabled(true);</div>
<div>6161&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playBB.setEnabled(true);</div>
<div>6162&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_saveB.setEnabled(true);</div>
<div>6163&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6164&emsp;&emsp;</div>
<div>6165&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6166&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Load a layout from a file. Supports loading binary and XML serialized flow</div>
<div>6167&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * files</div>
<div>6168&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6169&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param oFile the file to load from</div>
<div>6170&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param newTab true if the loaded layout should be displayed in a new tab</div>
<div>6171&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6172&emsp;&emsp;&nbsp;&nbsp;  public void loadLayout(File oFile, boolean newTab) {</div>
<div>6173&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    loadLayout(oFile, newTab, false);</div>
<div>6174&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6175&emsp;&emsp;</div>
<div>6176&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6177&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Load a layout from a file</div>
<div>6178&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6179&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param oFile the file to load from</div>
<div>6180&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param newTab true if the loaded layout should be displayed in a new tab</div>
<div>6181&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param isUndo is this file an "undo" file?</div>
<div>6182&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6183&emsp;&emsp;&nbsp;&nbsp;  @SuppressWarnings("unchecked")</div>
<div>6184&emsp;&emsp;&nbsp;&nbsp;  protected void loadLayout(File oFile, boolean newTab, boolean isUndo) {</div>
<div>6185&emsp;&emsp;</div>
<div>6186&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // stop any running flow first (if we are loading into this tab)</div>
<div>6187&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (!newTab) {</div>
<div>6188&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      stopFlow();</div>
<div>6189&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6190&emsp;&emsp;</div>
<div>6191&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_loadB.setEnabled(false);</div>
<div>6192&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_saveB.setEnabled(false);</div>
<div>6193&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playB.setEnabled(false);</div>
<div>6194&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playBB.setEnabled(false);</div>
<div>6195&emsp;&emsp;</div>
<div>6196&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (newTab) {</div>
<div>6197&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      String flowName = oFile.getName();</div>
<div>6198&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (flowName.lastIndexOf('.') > 0) {</div>
<div>6199&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        flowName = flowName.substring(0, flowName.lastIndexOf('.'));</div>
<div>6200&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6201&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.addTab(flowName);</div>
<div>6202&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_mainKFPerspective.setActiveTab(m_mainKFPerspective.getNumTabs() - 1);</div>
<div>6203&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setFlowFile(oFile);</div>
<div>6204&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setEditedStatus(false);</div>
<div>6205&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6206&emsp;&emsp;</div>
<div>6207&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (!isUndo) {</div>
<div>6208&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      File absolute = new File(oFile.getAbsolutePath());</div>
<div>6209&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_flowEnvironment.addVariable("Internal.knowledgeflow.directory",</div>
<div>6210&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // absolute.getParent());</div>
<div>6211&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getEnvironmentSettings().addVariable(</div>
<div>6212&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        "Internal.knowledgeflow.directory", absolute.getParent());</div>
<div>6213&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6214&emsp;&emsp;</div>
<div>6215&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>6216&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Object> beans = new Vector&#60;Object>();</div>
<div>6217&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;BeanConnection> connections = new Vector&#60;BeanConnection>();</div>
<div>6218&emsp;&emsp;</div>
<div>6219&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // KOML?</div>
<div>6220&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if ((KOML.isPresent())</div>
<div>6221&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        && (oFile.getAbsolutePath().toLowerCase().endsWith(KOML.FILE_EXTENSION</div>
<div>6222&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "kf"))) {</div>
<div>6223&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;Vector&#60;?>> v = (Vector&#60;Vector&#60;?>>) KOML.read(oFile</div>
<div>6224&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getAbsolutePath());</div>
<div>6225&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        beans = (Vector&#60;Object>) v.get(XMLBeans.INDEX_BEANINSTANCES);</div>
<div>6226&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        connections = (Vector&#60;BeanConnection>) v</div>
<div>6227&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .get(XMLBeans.INDEX_BEANCONNECTIONS);</div>
<div>6228&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } /* XStream */else if ((XStream.isPresent())</div>
<div>6229&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        && (oFile.getAbsolutePath().toLowerCase()</div>
<div>6230&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .endsWith(XStream.FILE_EXTENSION + "kf"))) {</div>
<div>6231&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;Vector&#60;?>> v = (Vector&#60;Vector&#60;?>>) XStream.read(oFile</div>
<div>6232&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getAbsolutePath());</div>
<div>6233&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        beans = (Vector&#60;Object>) v.get(XMLBeans.INDEX_BEANINSTANCES);</div>
<div>6234&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        connections = (Vector&#60;BeanConnection>) v</div>
<div>6235&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .get(XMLBeans.INDEX_BEANCONNECTIONS);</div>
<div>6236&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } /* XML? */else if (oFile.getAbsolutePath().toLowerCase()</div>
<div>6237&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .endsWith(FILE_EXTENSION_XML)) {</div>
<div>6238&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        XMLBeans xml = new XMLBeans(m_beanLayout, m_bcSupport,</div>
<div>6239&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6240&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;Vector&#60;?>> v = (Vector&#60;Vector&#60;?>>) xml.read(oFile);</div>
<div>6241&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        beans = (Vector&#60;Object>) v.get(XMLBeans.INDEX_BEANINSTANCES);</div>
<div>6242&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        connections = (Vector&#60;BeanConnection>) v</div>
<div>6243&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .get(XMLBeans.INDEX_BEANCONNECTIONS);</div>
<div>6244&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // connections = new Vector();</div>
<div>6245&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } /* binary */else {</div>
<div>6246&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        InputStream is = new FileInputStream(oFile);</div>
<div>6247&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ObjectInputStream ois = new ObjectInputStream(is);</div>
<div>6248&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        beans = (Vector&#60;Object>) ois.readObject();</div>
<div>6249&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        connections = (Vector&#60;BeanConnection>) ois.readObject();</div>
<div>6250&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ois.close();</div>
<div>6251&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6252&emsp;&emsp;</div>
<div>6253&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      integrateFlow(beans, connections, true, false);</div>
<div>6254&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      setEnvironment();</div>
<div>6255&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (newTab) {</div>
<div>6256&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_logPanel.clearStatus();</div>
<div>6257&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_logPanel.statusMessage("@!@[KnowledgeFlow]|Flow loaded.");</div>
<div>6258&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6259&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>6260&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanel</div>
<div>6261&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .statusMessage("@!@[KnowledgeFlow]|Unable to load flow (see log).");</div>
<div>6262&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanel.logMessage("[KnowledgeFlow] Unable to load flow ("</div>
<div>6263&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        + ex.getMessage() + ").");</div>
<div>6264&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ex.printStackTrace();</div>
<div>6265&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6266&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_loadB.setEnabled(true);</div>
<div>6267&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_saveB.setEnabled(true);</div>
<div>6268&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playB.setEnabled(true);</div>
<div>6269&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playBB.setEnabled(true);</div>
<div>6270&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6271&emsp;&emsp;</div>
<div>6272&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6273&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Load a flow file from an input stream. Only supports XML serialized flows.</div>
<div>6274&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6275&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param is the input stream to laod from</div>
<div>6276&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param newTab whether to open a new tab in the UI for the flow</div>
<div>6277&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param flowName the name of the flow</div>
<div>6278&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @throws Exception if a problem occurs during de-serialization</div>
<div>6279&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6280&emsp;&emsp;&nbsp;&nbsp;  public void loadLayout(InputStream is, boolean newTab, String flowName)</div>
<div>6281&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    throws Exception {</div>
<div>6282&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    InputStreamReader isr = new InputStreamReader(is);</div>
<div>6283&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    loadLayout(isr, newTab, flowName);</div>
<div>6284&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6285&emsp;&emsp;</div>
<div>6286&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6287&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Load a flow file from a reader. Only supports XML serialized flows.</div>
<div>6288&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6289&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param reader the reader to load from</div>
<div>6290&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param newTab whether to open a new tab in the UI for the flow</div>
<div>6291&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param flowName the name of the flow</div>
<div>6292&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @throws Exception if a problem occurs during de-serialization</div>
<div>6293&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6294&emsp;&emsp;&nbsp;&nbsp;  @SuppressWarnings("unchecked")</div>
<div>6295&emsp;&emsp;&nbsp;&nbsp;  public void loadLayout(Reader reader, boolean newTab, String flowName)</div>
<div>6296&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    throws Exception {</div>
<div>6297&emsp;&emsp;</div>
<div>6298&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // stop any running flow first (if we are loading into this tab)</div>
<div>6299&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (!newTab) {</div>
<div>6300&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      stopFlow();</div>
<div>6301&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6302&emsp;&emsp;</div>
<div>6303&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_loadB.setEnabled(false);</div>
<div>6304&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_saveB.setEnabled(false);</div>
<div>6305&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playB.setEnabled(false);</div>
<div>6306&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playBB.setEnabled(false);</div>
<div>6307&emsp;&emsp;</div>
<div>6308&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (newTab) {</div>
<div>6309&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.addTab(flowName);</div>
<div>6310&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setEditedStatus(false);</div>
<div>6311&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6312&emsp;&emsp;</div>
<div>6313&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    XMLBeans xml = new XMLBeans(m_beanLayout, m_bcSupport,</div>
<div>6314&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6315&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Vector&#60;?>> v = (Vector&#60;Vector&#60;?>>) xml.read(reader);</div>
<div>6316&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> beans = (Vector&#60;Object>) v.get(XMLBeans.INDEX_BEANINSTANCES);</div>
<div>6317&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;BeanConnection> connections = (Vector&#60;BeanConnection>) v</div>
<div>6318&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .get(XMLBeans.INDEX_BEANCONNECTIONS);</div>
<div>6319&emsp;&emsp;</div>
<div>6320&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    integrateFlow(beans, connections, true, false);</div>
<div>6321&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    setEnvironment();</div>
<div>6322&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (newTab) {</div>
<div>6323&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanel.clearStatus();</div>
<div>6324&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanel.statusMessage("@!@[KnowledgeFlow]|Flow loaded.");</div>
<div>6325&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6326&emsp;&emsp;</div>
<div>6327&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_loadB.setEnabled(true);</div>
<div>6328&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_saveB.setEnabled(true);</div>
<div>6329&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playB.setEnabled(true);</div>
<div>6330&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_playBB.setEnabled(true);</div>
<div>6331&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6332&emsp;&emsp;</div>
<div>6333&emsp;&emsp;&nbsp;&nbsp;  // Link the supplied beans into the KnowledgeFlow gui</div>
<div>6334&emsp;&emsp;&nbsp;&nbsp;  protected void integrateFlow(Vector&#60;Object> beans,</div>
<div>6335&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;BeanConnection> connections, boolean replace,</div>
<div>6336&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean notReplaceAndSourcedFromBinary) {</div>
<div>6337&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    java.awt.Color bckC = getBackground();</div>
<div>6338&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_bcSupport = new BeanContextSupport();</div>
<div>6339&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_bcSupport.setDesignTime(true);</div>
<div>6340&emsp;&emsp;</div>
<div>6341&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // register this panel as a property change listener with each</div>
<div>6342&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // bean</div>
<div>6343&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>6344&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance tempB = (BeanInstance) beans.elementAt(i);</div>
<div>6345&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (tempB.getBean() instanceof Visible) {</div>
<div>6346&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((Visible) (tempB.getBean())).getVisual().addPropertyChangeListener(</div>
<div>6347&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          this);</div>
<div>6348&emsp;&emsp;</div>
<div>6349&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // A workaround to account for JPanel's with their default</div>
<div>6350&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // background colour not being serializable in Apple's JRE</div>
<div>6351&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((Visible) (tempB.getBean())).getVisual().setBackground(bckC);</div>
<div>6352&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((JComponent) (tempB.getBean())).setBackground(bckC);</div>
<div>6353&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6354&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (tempB.getBean() instanceof BeanCommon) {</div>
<div>6355&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((BeanCommon) (tempB.getBean())).setLog(m_logPanel);</div>
<div>6356&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6357&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (tempB.getBean() instanceof BeanContextChild) {</div>
<div>6358&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_bcSupport.add(tempB.getBean());</div>
<div>6359&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6360&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6361&emsp;&emsp;</div>
<div>6362&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (replace) {</div>
<div>6363&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance.setBeanInstances(beans, m_beanLayout,</div>
<div>6364&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6365&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanConnection.setConnections(connections,</div>
<div>6366&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6367&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } else if (notReplaceAndSourcedFromBinary) {</div>
<div>6368&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance.appendBeans(m_beanLayout, beans,</div>
<div>6369&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6370&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanConnection.appendConnections(connections,</div>
<div>6371&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6372&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6373&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    revalidate();</div>
<div>6374&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_beanLayout.revalidate();</div>
<div>6375&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_beanLayout.repaint();</div>
<div>6376&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    notifyIsDirty();</div>
<div>6377&emsp;&emsp;</div>
<div>6378&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_selectAllB.setEnabled(BeanInstance.getBeanInstances(</div>
<div>6379&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.getCurrentTabIndex()).size() > 0);</div>
<div>6380&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6381&emsp;&emsp;</div>
<div>6382&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6383&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Set the flow for the KnowledgeFlow to edit. Assumes that client has loaded</div>
<div>6384&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * a Vector of beans and a Vector of connections. the supplied beans and</div>
<div>6385&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * connections are deep-copied via serialization before being set in the</div>
<div>6386&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * layout. The beans get added to the flow at position 0.</div>
<div>6387&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6388&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param v a Vector containing a Vector of beans and a Vector of connections</div>
<div>6389&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @exception Exception if something goes wrong</div>
<div>6390&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6391&emsp;&emsp;&nbsp;&nbsp;  @SuppressWarnings("unchecked")</div>
<div>6392&emsp;&emsp;&nbsp;&nbsp;  public void setFlow(Vector&#60;Vector&#60;?>> v) throws Exception {</div>
<div>6393&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // Vector beansCopy = null, connectionsCopy = null;</div>
<div>6394&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // clearLayout();</div>
<div>6395&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (getAllowMultipleTabs()) {</div>
<div>6396&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      throw new Exception("[KnowledgeFlow] setFlow() - can only set a flow in "</div>
<div>6397&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        + "singe tab only mode");</div>
<div>6398&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6399&emsp;&emsp;</div>
<div>6400&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>6401&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * int tabI = 0;</div>
<div>6402&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     *</div>
<div>6403&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * BeanInstance.</div>
<div>6404&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * removeAllBeansFromContainer((JComponent)m_mainKFPerspective.</div>
<div>6405&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * getBeanLayout(tabI), tabI); BeanInstance.setBeanInstances(new Vector(),</div>
<div>6406&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * m_mainKFPerspective.getBeanLayout(tabI));</div>
<div>6407&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * BeanConnection.setConnections(new Vector());</div>
<div>6408&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>6409&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // m_mainKFPerspective.removeTab(0);</div>
<div>6410&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // m_mainKFPerspective.addTab("Untitled");</div>
<div>6411&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_beanLayout.removeAll();</div>
<div>6412&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    BeanInstance.init();</div>
<div>6413&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    BeanConnection.init();</div>
<div>6414&emsp;&emsp;</div>
<div>6415&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    SerializedObject so = new SerializedObject(v);</div>
<div>6416&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Vector&#60;?>> copy = (Vector&#60;Vector&#60;?>>) so.getObject();</div>
<div>6417&emsp;&emsp;</div>
<div>6418&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> beans = (Vector&#60;Object>) copy.elementAt(0);</div>
<div>6419&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;BeanConnection> connections = (Vector&#60;BeanConnection>) copy</div>
<div>6420&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .elementAt(1);</div>
<div>6421&emsp;&emsp;</div>
<div>6422&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // reset environment variables</div>
<div>6423&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_flowEnvironment = new Environment();</div>
<div>6424&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    integrateFlow(beans, connections, true, false);</div>
<div>6425&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    revalidate();</div>
<div>6426&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    notifyIsDirty();</div>
<div>6427&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6428&emsp;&emsp;</div>
<div>6429&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6430&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Gets the current flow being edited. The flow is returned as a single Vector</div>
<div>6431&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * containing two other Vectors: the beans and the connections. These two</div>
<div>6432&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * vectors are deep-copied via serialization before being returned.</div>
<div>6433&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6434&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @return the current flow being edited</div>
<div>6435&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @throws Exception if a problem occurs</div>
<div>6436&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6437&emsp;&emsp;&nbsp;&nbsp;  public Vector&#60;Vector&#60;?>> getFlow() throws Exception {</div>
<div>6438&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Vector&#60;?>> v = new Vector&#60;Vector&#60;?>>();</div>
<div>6439&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> beans = BeanInstance.getBeanInstances(m_mainKFPerspective</div>
<div>6440&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .getCurrentTabIndex());</div>
<div>6441&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;BeanConnection> connections = BeanConnection</div>
<div>6442&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .getConnections(m_mainKFPerspective.getCurrentTabIndex());</div>
<div>6443&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    detachFromLayout(beans);</div>
<div>6444&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    v.add(beans);</div>
<div>6445&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    v.add(connections);</div>
<div>6446&emsp;&emsp;</div>
<div>6447&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    SerializedObject so = new SerializedObject(v);</div>
<div>6448&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    @SuppressWarnings("unchecked")</div>
<div>6449&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Vector&#60;?>> copy = (Vector&#60;Vector&#60;?>>) so.getObject();</div>
<div>6450&emsp;&emsp;</div>
<div>6451&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // tempWrite(beans, connections);</div>
<div>6452&emsp;&emsp;</div>
<div>6453&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    integrateFlow(beans, connections, true, false);</div>
<div>6454&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return copy;</div>
<div>6455&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6456&emsp;&emsp;</div>
<div>6457&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6458&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Returns the current flow being edited in XML format.</div>
<div>6459&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6460&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @return the current flow as an XML string</div>
<div>6461&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @throws Exception if a problem occurs</div>
<div>6462&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6463&emsp;&emsp;&nbsp;&nbsp;  public String getFlowXML() throws Exception {</div>
<div>6464&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> beans = BeanInstance.getBeanInstances(m_mainKFPerspective</div>
<div>6465&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .getCurrentTabIndex());</div>
<div>6466&emsp;&emsp;</div>
<div>6467&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    StringBuffer buff = copyToBuffer(beans);</div>
<div>6468&emsp;&emsp;</div>
<div>6469&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return buff.toString();</div>
<div>6470&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6471&emsp;&emsp;</div>
<div>6472&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6473&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Utility method to create an image of a region of the given component</div>
<div>6474&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6475&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param component the component to create an image of</div>
<div>6476&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param region the region of the component to put into the image</div>
<div>6477&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @return the image</div>
<div>6478&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @throws IOException</div>
<div>6479&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6480&emsp;&emsp;&nbsp;&nbsp;  protected static BufferedImage createImage(JComponent component,</div>
<div>6481&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Rectangle region) throws IOException {</div>
<div>6482&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean opaqueValue = component.isOpaque();</div>
<div>6483&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    component.setOpaque(true);</div>
<div>6484&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    BufferedImage image = new BufferedImage(region.width, region.height,</div>
<div>6485&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BufferedImage.TYPE_INT_RGB);</div>
<div>6486&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Graphics2D g2d = image.createGraphics();</div>
<div>6487&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    g2d.translate(-region.getX(), -region.getY());</div>
<div>6488&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // g2d.setClip( region );</div>
<div>6489&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    component.paint(g2d);</div>
<div>6490&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    g2d.dispose();</div>
<div>6491&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    component.setOpaque(opaqueValue);</div>
<div>6492&emsp;&emsp;</div>
<div>6493&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return image;</div>
<div>6494&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6495&emsp;&emsp;</div>
<div>6496&emsp;&emsp;&nbsp;&nbsp;  // Remove this panel as a property changle listener from</div>
<div>6497&emsp;&emsp;&nbsp;&nbsp;  // each bean</div>
<div>6498&emsp;&emsp;&nbsp;&nbsp;  private void detachFromLayout(Vector&#60;Object> beans) {</div>
<div>6499&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>6500&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance tempB = (BeanInstance) beans.elementAt(i);</div>
<div>6501&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (tempB.getBean() instanceof Visible) {</div>
<div>6502&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((Visible) (tempB.getBean())).getVisual().removePropertyChangeListener(</div>
<div>6503&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          this);</div>
<div>6504&emsp;&emsp;</div>
<div>6505&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (tempB.getBean() instanceof MetaBean) {</div>
<div>6506&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ((MetaBean) tempB.getBean())</div>
<div>6507&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .removePropertyChangeListenersSubFlow(this);</div>
<div>6508&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6509&emsp;&emsp;</div>
<div>6510&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // A workaround to account for JPanel's with their default</div>
<div>6511&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // background colour not being serializable in Apple's JRE.</div>
<div>6512&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // JComponents are rendered with a funky stripy background</div>
<div>6513&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // under OS X using java.awt.TexturePaint - unfortunately</div>
<div>6514&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // TexturePaint doesn't implement Serializable.</div>
<div>6515&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((Visible) (tempB.getBean())).getVisual().setBackground(</div>
<div>6516&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          java.awt.Color.white);</div>
<div>6517&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((JComponent) (tempB.getBean())).setBackground(java.awt.Color.white);</div>
<div>6518&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6519&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6520&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6521&emsp;&emsp;</div>
<div>6522&emsp;&emsp;&nbsp;&nbsp;  public void saveLayout(File toFile, int tabIndex) {</div>
<div>6523&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    saveLayout(toFile, tabIndex, false);</div>
<div>6524&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6525&emsp;&emsp;</div>
<div>6526&emsp;&emsp;&nbsp;&nbsp;  protected boolean saveLayout(File sFile, int tabIndex, boolean isUndoPoint) {</div>
<div>6527&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    java.awt.Color bckC = getBackground();</div>
<div>6528&emsp;&emsp;</div>
<div>6529&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> beans = BeanInstance.getBeanInstances(tabIndex);</div>
<div>6530&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    detachFromLayout(beans);</div>
<div>6531&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    detachFromLayout(beans);</div>
<div>6532&emsp;&emsp;</div>
<div>6533&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // now serialize components vector and connections vector</div>
<div>6534&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>6535&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // KOML?</div>
<div>6536&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if ((KOML.isPresent())</div>
<div>6537&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        && (sFile.getAbsolutePath().toLowerCase().endsWith(KOML.FILE_EXTENSION</div>
<div>6538&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "kf"))) {</div>
<div>6539&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;Vector&#60;?>> v = new Vector&#60;Vector&#60;?>>();</div>
<div>6540&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        v.setSize(2);</div>
<div>6541&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        v.set(XMLBeans.INDEX_BEANINSTANCES, beans);</div>
<div>6542&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        v.set(XMLBeans.INDEX_BEANCONNECTIONS,</div>
<div>6543&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          BeanConnection.getConnections(tabIndex));</div>
<div>6544&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        KOML.write(sFile.getAbsolutePath(), v);</div>
<div>6545&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } /* XStream */else if ((XStream.isPresent())</div>
<div>6546&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        && (sFile.getAbsolutePath().toLowerCase()</div>
<div>6547&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .endsWith(XStream.FILE_EXTENSION + "kf"))) {</div>
<div>6548&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;Vector&#60;?>> v = new Vector&#60;Vector&#60;?>>();</div>
<div>6549&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        v.setSize(2);</div>
<div>6550&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        v.set(XMLBeans.INDEX_BEANINSTANCES, beans);</div>
<div>6551&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        v.set(XMLBeans.INDEX_BEANCONNECTIONS,</div>
<div>6552&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          BeanConnection.getConnections(tabIndex));</div>
<div>6553&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        XStream.write(sFile.getAbsolutePath(), v);</div>
<div>6554&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } /* XML? */else if (sFile.getAbsolutePath().toLowerCase()</div>
<div>6555&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .endsWith(FILE_EXTENSION_XML)) {</div>
<div>6556&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Vector&#60;Vector&#60;?>> v = new Vector&#60;Vector&#60;?>>();</div>
<div>6557&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        v.setSize(2);</div>
<div>6558&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        v.set(XMLBeans.INDEX_BEANINSTANCES, beans);</div>
<div>6559&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        v.set(XMLBeans.INDEX_BEANCONNECTIONS,</div>
<div>6560&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          BeanConnection.getConnections(tabIndex));</div>
<div>6561&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        XMLBeans xml = new XMLBeans(m_beanLayout, m_bcSupport, tabIndex);</div>
<div>6562&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // XML flows are tagged as encoded with UTF-8</div>
<div>6563&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BufferedWriter br = new BufferedWriter(new OutputStreamWriter(</div>
<div>6564&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          new FileOutputStream(sFile), "UTF-8"));</div>
<div>6565&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        xml.write(br, v);</div>
<div>6566&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } /* binary */else {</div>
<div>6567&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        OutputStream os = new FileOutputStream(sFile);</div>
<div>6568&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ObjectOutputStream oos = new ObjectOutputStream(os);</div>
<div>6569&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        oos.writeObject(beans);</div>
<div>6570&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        oos.writeObject(BeanConnection.getConnections(tabIndex));</div>
<div>6571&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        oos.flush();</div>
<div>6572&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        oos.close();</div>
<div>6573&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6574&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>6575&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanel</div>
<div>6576&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        .statusMessage("@!@[KnowledgeFlow]|Unable to save flow (see log).");</div>
<div>6577&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_logPanel.logMessage("[KnowledgeFlow] Unable to save flow ("</div>
<div>6578&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        + ex.getMessage() + ").");</div>
<div>6579&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ex.printStackTrace();</div>
<div>6580&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      return false;</div>
<div>6581&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } finally {</div>
<div>6582&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // restore this panel as a property change listener in the beans</div>
<div>6583&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>6584&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeanInstance tempB = (BeanInstance) beans.elementAt(i);</div>
<div>6585&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (tempB.getBean() instanceof Visible) {</div>
<div>6586&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ((Visible) (tempB.getBean())).getVisual().addPropertyChangeListener(</div>
<div>6587&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            this);</div>
<div>6588&emsp;&emsp;</div>
<div>6589&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (tempB.getBean() instanceof MetaBean) {</div>
<div>6590&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((MetaBean) tempB.getBean())</div>
<div>6591&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .addPropertyChangeListenersSubFlow(this);</div>
<div>6592&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>6593&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // Restore the default background colour</div>
<div>6594&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ((Visible) (tempB.getBean())).getVisual().setBackground(bckC);</div>
<div>6595&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ((JComponent) (tempB.getBean())).setBackground(bckC);</div>
<div>6596&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6597&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6598&emsp;&emsp;</div>
<div>6599&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (!isUndoPoint) {</div>
<div>6600&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        Environment e = m_mainKFPerspective.getEnvironmentSettings(tabIndex);</div>
<div>6601&emsp;&emsp;</div>
<div>6602&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        e.addVariable("Internal.knowledgeflow.directory",</div>
<div>6603&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          new File(sFile.getAbsolutePath()).getParent());</div>
<div>6604&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.setEditedStatus(tabIndex, false);</div>
<div>6605&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String tabTitle = sFile.getName();</div>
<div>6606&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        tabTitle = tabTitle.substring(0, tabTitle.lastIndexOf('.'));</div>
<div>6607&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_mainKFPerspective.setTabTitle(tabIndex, tabTitle);</div>
<div>6608&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6609&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6610&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return true;</div>
<div>6611&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6612&emsp;&emsp;</div>
<div>6613&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6614&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Serialize the layout to a file</div>
<div>6615&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6616&emsp;&emsp;&nbsp;&nbsp;  private void saveLayout(int tabIndex, boolean showDialog) {</div>
<div>6617&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    getBackground();</div>
<div>6618&emsp;&emsp;</div>
<div>6619&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    File sFile = m_mainKFPerspective.getFlowFile(tabIndex);</div>
<div>6620&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    int returnVal = JFileChooser.APPROVE_OPTION;</div>
<div>6621&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean shownDialog = false;</div>
<div>6622&emsp;&emsp;</div>
<div>6623&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (showDialog || sFile.getName().equals("-NONE-")) {</div>
<div>6624&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      returnVal = m_FileChooser.showSaveDialog(this);</div>
<div>6625&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      shownDialog = true;</div>
<div>6626&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6627&emsp;&emsp;</div>
<div>6628&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (returnVal == JFileChooser.APPROVE_OPTION) {</div>
<div>6629&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // temporarily remove this panel as a property changle listener from</div>
<div>6630&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // each bean</div>
<div>6631&emsp;&emsp;</div>
<div>6632&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Object> beans = BeanInstance.getBeanInstances(tabIndex);</div>
<div>6633&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      detachFromLayout(beans);</div>
<div>6634&emsp;&emsp;</div>
<div>6635&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // determine filename (if necessary)</div>
<div>6636&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (shownDialog) {</div>
<div>6637&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        sFile = m_FileChooser.getSelectedFile();</div>
<div>6638&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6639&emsp;&emsp;</div>
<div>6640&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // add extension if necessary</div>
<div>6641&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_FileChooser.getFileFilter() == m_KfFilter) {</div>
<div>6642&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!sFile.getName().toLowerCase().endsWith(FILE_EXTENSION)) {</div>
<div>6643&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          sFile = new File(sFile.getParent(), sFile.getName() + FILE_EXTENSION);</div>
<div>6644&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6645&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } else if (m_FileChooser.getFileFilter() == m_KOMLFilter) {</div>
<div>6646&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!sFile.getName().toLowerCase().endsWith(KOML.FILE_EXTENSION + "kf")) {</div>
<div>6647&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          sFile = new File(sFile.getParent(), sFile.getName()</div>
<div>6648&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + KOML.FILE_EXTENSION + "kf");</div>
<div>6649&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6650&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } else if (m_FileChooser.getFileFilter() == m_XStreamFilter) {</div>
<div>6651&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!sFile.getName().toLowerCase()</div>
<div>6652&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .endsWith(XStream.FILE_EXTENSION + "kf")) {</div>
<div>6653&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          sFile = new File(sFile.getParent(), sFile.getName()</div>
<div>6654&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + XStream.FILE_EXTENSION + "kf");</div>
<div>6655&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6656&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } else if (m_FileChooser.getFileFilter() == m_XMLFilter) {</div>
<div>6657&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (!sFile.getName().toLowerCase().endsWith(FILE_EXTENSION_XML)) {</div>
<div>6658&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          sFile = new File(sFile.getParent(), sFile.getName()</div>
<div>6659&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + FILE_EXTENSION_XML);</div>
<div>6660&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6661&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6662&emsp;&emsp;</div>
<div>6663&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      saveLayout(sFile, m_mainKFPerspective.getCurrentTabIndex(), false);</div>
<div>6664&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_mainKFPerspective.setFlowFile(tabIndex, sFile);</div>
<div>6665&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6666&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6667&emsp;&emsp;</div>
<div>6668&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6669&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Save the knowledge flow into the OutputStream passed at input. Only</div>
<div>6670&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * supports saving the layout data (no trained models) to XML.</div>
<div>6671&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6672&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param out the output stream to save the layout in</div>
<div>6673&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6674&emsp;&emsp;&nbsp;&nbsp;  public void saveLayout(OutputStream out, int tabIndex) {</div>
<div>6675&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // temporarily remove this panel as a property changle listener from</div>
<div>6676&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // each bean</div>
<div>6677&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Object> beans = BeanInstance.getBeanInstances(tabIndex);</div>
<div>6678&emsp;&emsp;</div>
<div>6679&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>6680&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      BeanInstance tempB = (BeanInstance) beans.elementAt(i);</div>
<div>6681&emsp;&emsp;</div>
<div>6682&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (tempB.getBean() instanceof Visible) {</div>
<div>6683&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ((Visible) (tempB.getBean())).getVisual().removePropertyChangeListener(</div>
<div>6684&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          this);</div>
<div>6685&emsp;&emsp;</div>
<div>6686&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (tempB.getBean() instanceof MetaBean) {</div>
<div>6687&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ((MetaBean) tempB.getBean())</div>
<div>6688&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .removePropertyChangeListenersSubFlow(this);</div>
<div>6689&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6690&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6691&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6692&emsp;&emsp;</div>
<div>6693&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // now serialize components vector and connections vector</div>
<div>6694&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>6695&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Vector&#60;Vector&#60;?>> v = new Vector&#60;Vector&#60;?>>();</div>
<div>6696&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      v.setSize(2);</div>
<div>6697&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      v.set(XMLBeans.INDEX_BEANINSTANCES, beans);</div>
<div>6698&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      v.set(XMLBeans.INDEX_BEANCONNECTIONS,</div>
<div>6699&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeanConnection.getConnections(tabIndex));</div>
<div>6700&emsp;&emsp;</div>
<div>6701&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      XMLBeans xml = new XMLBeans(m_beanLayout, m_bcSupport, tabIndex);</div>
<div>6702&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      xml.write(out, v);</div>
<div>6703&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>6704&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ex.printStackTrace();</div>
<div>6705&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } finally {</div>
<div>6706&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // restore this panel as a property change listener in the beans</div>
<div>6707&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; beans.size(); i++) {</div>
<div>6708&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        BeanInstance tempB = (BeanInstance) beans.elementAt(i);</div>
<div>6709&emsp;&emsp;</div>
<div>6710&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (tempB.getBean() instanceof Visible) {</div>
<div>6711&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ((Visible) (tempB.getBean())).getVisual().addPropertyChangeListener(</div>
<div>6712&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            this);</div>
<div>6713&emsp;&emsp;</div>
<div>6714&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (tempB.getBean() instanceof MetaBean) {</div>
<div>6715&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ((MetaBean) tempB.getBean())</div>
<div>6716&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              .addPropertyChangeListenersSubFlow(this);</div>
<div>6717&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>6718&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6719&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6720&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6721&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6722&emsp;&emsp;</div>
<div>6723&emsp;&emsp;&nbsp;&nbsp;  @SuppressWarnings("unchecked")</div>
<div>6724&emsp;&emsp;&nbsp;&nbsp;  private void loadUserComponents() {</div>
<div>6725&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    Vector&#60;Vector&#60;Object>> tempV = null;</div>
<div>6726&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // String ext = "";</div>
<div>6727&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>6728&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * if (m_UserComponentsInXML) ext = USERCOMPONENTS_XML_EXTENSION;</div>
<div>6729&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>6730&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    File sFile = new File(weka.core.WekaPackageManager.WEKA_HOME.getPath()</div>
<div>6731&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      + File.separator + "knowledgeFlow" + File.separator + "userComponents");</div>
<div>6732&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    /*</div>
<div>6733&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * new File(System.getProperty("user.home") +File.separator +</div>
<div>6734&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     * ".knowledgeFlow" +File.separator + "userComponents" +ext);</div>
<div>6735&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     */</div>
<div>6736&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (sFile.exists()) {</div>
<div>6737&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      try {</div>
<div>6738&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        /*</div>
<div>6739&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         * if (m_UserComponentsInXML) { XMLBeans xml = new</div>
<div>6740&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         * XMLBeans(m_beanLayout, m_bcSupport, XMLBeans.DATATYPE_USERCOMPONENTS,</div>
<div>6741&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         * 0); tempV = (Vector) xml.read(sFile); } else {</div>
<div>6742&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         */</div>
<div>6743&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        InputStream is = new FileInputStream(sFile);</div>
<div>6744&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ObjectInputStream ois = new ObjectInputStream(is);</div>
<div>6745&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        tempV = (Vector&#60;Vector&#60;Object>>) ois.readObject();</div>
<div>6746&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ois.close();</div>
<div>6747&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // }</div>
<div>6748&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      } catch (Exception ex) {</div>
<div>6749&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        weka.core.logging.Logger.log(weka.core.logging.Logger.Level.WARNING,</div>
<div>6750&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          "[KnowledgeFlow] Problem reading user components.");</div>
<div>6751&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        ex.printStackTrace();</div>
<div>6752&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        return;</div>
<div>6753&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6754&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (tempV.size() > 0) {</div>
<div>6755&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        DefaultTreeModel model = (DefaultTreeModel) m_componentTree.getModel();</div>
<div>6756&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        DefaultMutableTreeNode root = (DefaultMutableTreeNode) model.getRoot();</div>
<div>6757&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (m_userCompNode == null) {</div>
<div>6758&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_userCompNode = new InvisibleNode("User");</div>
<div>6759&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          model.insertNodeInto(m_userCompNode, root, 0);</div>
<div>6760&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6761&emsp;&emsp;</div>
<div>6762&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        // add the components</div>
<div>6763&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        for (int i = 0; i &#60; tempV.size(); i++) {</div>
<div>6764&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          Vector&#60;Object> tempB = tempV.elementAt(i);</div>
<div>6765&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          String displayName = (String) tempB.get(0);</div>
<div>6766&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          tempB.get(1);</div>
<div>6767&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          ImageIcon scaledIcon = (ImageIcon) tempB.get(2);</div>
<div>6768&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          JTreeLeafDetails treeLeaf = new JTreeLeafDetails(displayName, tempB,</div>
<div>6769&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            scaledIcon);</div>
<div>6770&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          DefaultMutableTreeNode newUserComp = new InvisibleNode(treeLeaf);</div>
<div>6771&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          model.insertNodeInto(newUserComp, m_userCompNode, 0);</div>
<div>6772&emsp;&emsp;</div>
<div>6773&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // add to the list of user components</div>
<div>6774&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_userComponents.add(tempB);</div>
<div>6775&emsp;&emsp;</div>
<div>6776&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // addToUserToolBar(tempB, false);</div>
<div>6777&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // addToUserTreeNode(tempB, false);</div>
<div>6778&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6779&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6780&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6781&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6782&emsp;&emsp;</div>
<div>6783&emsp;&emsp;&nbsp;&nbsp;  private void installWindowListenerForSavingUserStuff() {</div>
<div>6784&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    ((java.awt.Window) getTopLevelAncestor())</div>
<div>6785&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      .addWindowListener(new java.awt.event.WindowAdapter() {</div>
<div>6786&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>6787&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void windowClosing(java.awt.event.WindowEvent e) {</div>
<div>6788&emsp;&emsp;</div>
<div>6789&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          weka.core.logging.Logger.log(weka.core.logging.Logger.Level.INFO,</div>
<div>6790&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            "[KnowledgeFlow] Saving user components....");</div>
<div>6791&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          File sFile = new File(WekaPackageManager.WEKA_HOME.getPath()</div>
<div>6792&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            + File.separator + "knowledgeFlow");</div>
<div>6793&emsp;&emsp;</div>
<div>6794&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          if (!sFile.exists()) {</div>
<div>6795&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (!sFile.mkdir()) {</div>
<div>6796&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              weka.core.logging.Logger.log(</div>
<div>6797&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                weka.core.logging.Logger.Level.WARNING,</div>
<div>6798&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                "[KnowledgeFlow] Unable to create \""</div>
<div>6799&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  + sFile.getPath() + "\" directory");</div>
<div>6800&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>6801&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>6802&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          try {</div>
<div>6803&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            String ext = "";</div>
<div>6804&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            /*</div>
<div>6805&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * if (m_UserComponentsInXML) ext = USERCOMPONENTS_XML_EXTENSION;</div>
<div>6806&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             */</div>
<div>6807&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            File sFile2 = new File(sFile.getAbsolutePath() + File.separator</div>
<div>6808&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              + "userComponents" + ext);</div>
<div>6809&emsp;&emsp;</div>
<div>6810&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            /*</div>
<div>6811&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * if (m_UserComponentsInXML) { XMLBeans xml = new</div>
<div>6812&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * XMLBeans(m_beanLayout, m_bcSupport,</div>
<div>6813&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * XMLBeans.DATATYPE_USERCOMPONENTS,</div>
<div>6814&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * m_mainKFPerspective.getCurrentTabIndex()); xml.write(sFile2,</div>
<div>6815&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             * m_userComponents); } else {</div>
<div>6816&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             */</div>
<div>6817&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            OutputStream os = new FileOutputStream(sFile2);</div>
<div>6818&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ObjectOutputStream oos = new ObjectOutputStream(os);</div>
<div>6819&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            oos.writeObject(m_userComponents);</div>
<div>6820&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            oos.flush();</div>
<div>6821&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            oos.close();</div>
<div>6822&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // }</div>
<div>6823&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } catch (Exception ex) {</div>
<div>6824&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            weka.core.logging.Logger.log(</div>
<div>6825&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              weka.core.logging.Logger.Level.WARNING,</div>
<div>6826&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "[KnowledgeFlow] Unable to save user components");</div>
<div>6827&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ex.printStackTrace();</div>
<div>6828&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>6829&emsp;&emsp;</div>
<div>6830&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // if (VISIBLE_PERSPECTIVES.size() > 0) {</div>
<div>6831&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          weka.core.logging.Logger.log(weka.core.logging.Logger.Level.INFO,</div>
<div>6832&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            "Saving preferences for selected perspectives...");</div>
<div>6833&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          sFile = new File(weka.core.WekaPackageManager.PROPERTIES_DIR</div>
<div>6834&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .toString() + File.separator + "VisiblePerspectives.props");</div>
<div>6835&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          try {</div>
<div>6836&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            FileWriter f = new FileWriter(sFile);</div>
<div>6837&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            f.write("weka.gui.beans.KnowledgeFlow.SelectedPerspectives=");</div>
<div>6838&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            int i = 0;</div>
<div>6839&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            for (String p : BeansProperties.VISIBLE_PERSPECTIVES) {</div>
<div>6840&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              if (i > 0) {</div>
<div>6841&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                f.write(",");</div>
<div>6842&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              }</div>
<div>6843&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              f.write(p);</div>
<div>6844&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              i++;</div>
<div>6845&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>6846&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            f.write("\n");</div>
<div>6847&emsp;&emsp;</div>
<div>6848&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            f.write("weka.gui.beans.KnowledgeFlow.PerspectiveToolBarVisisble="</div>
<div>6849&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              + ((m_configAndPerspectivesVisible) ? "yes" : "no"));</div>
<div>6850&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            f.write("\n");</div>
<div>6851&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            f.close();</div>
<div>6852&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          } catch (Exception ex) {</div>
<div>6853&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            weka.core.logging.Logger.log(</div>
<div>6854&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              weka.core.logging.Logger.Level.WARNING,</div>
<div>6855&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              "[KnowledgeFlow] Unable to save user perspectives preferences");</div>
<div>6856&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            ex.printStackTrace();</div>
<div>6857&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>6858&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          // }</div>
<div>6859&emsp;&emsp;</div>
<div>6860&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6861&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      });</div>
<div>6862&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6863&emsp;&emsp;</div>
<div>6864&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6865&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Utility method for grabbing the global info help (if it exists) from an</div>
<div>6866&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * arbitrary object</div>
<div>6867&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6868&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param tempBean the object to grab global info from</div>
<div>6869&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @return the global help info or null if global info does not exist</div>
<div>6870&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6871&emsp;&emsp;&nbsp;&nbsp;  public static String getGlobalInfo(Object tempBean) {</div>
<div>6872&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return Utils.getGlobalInfo(tempBean, true);</div>
<div>6873&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6874&emsp;&emsp;</div>
<div>6875&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6876&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * variable for the KnowLedgeFlow class which would be set to null by the</div>
<div>6877&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * memory monitoring thread to free up some memory if we running out of</div>
<div>6878&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * memory.</div>
<div>6879&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6880&emsp;&emsp;&nbsp;&nbsp;  private static KnowledgeFlowApp m_knowledgeFlow;</div>
<div>6881&emsp;&emsp;</div>
<div>6882&emsp;&emsp;&nbsp;&nbsp;  /** for monitoring the Memory consumption */</div>
<div>6883&emsp;&emsp;&nbsp;&nbsp;  private static Memory m_Memory = new Memory(true);</div>
<div>6884&emsp;&emsp;</div>
<div>6885&emsp;&emsp;&nbsp;&nbsp;  // list of things to be notified when the startup process of</div>
<div>6886&emsp;&emsp;&nbsp;&nbsp;  // the KnowledgeFlow is complete</div>
<div>6887&emsp;&emsp;&nbsp;&nbsp;  public static Vector&#60;StartUpListener> s_startupListeners =</div>
<div>6888&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    new Vector&#60;StartUpListener>();</div>
<div>6889&emsp;&emsp;</div>
<div>6890&emsp;&emsp;&nbsp;&nbsp;  // modifications by Zerbetto</div>
<div>6891&emsp;&emsp;&nbsp;&nbsp;  // If showFileMenu is true, the file menu (open file, new file, save file</div>
<div>6892&emsp;&emsp;&nbsp;&nbsp;  // buttons) is showed</div>
<div>6893&emsp;&emsp;&nbsp;&nbsp;  private boolean m_showFileMenu = true;</div>
<div>6894&emsp;&emsp;</div>
<div>6895&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6896&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Create the singleton instance of the KnowledgeFlow</div>
<div>6897&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6898&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param args can contain a file argument for loading a flow layout (format:</div>
<div>6899&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *          "file=[path to layout file]") Modified by Zerbetto: you can</div>
<div>6900&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *          specify the path of a knowledge flow layout file at input</div>
<div>6901&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6902&emsp;&emsp;&nbsp;&nbsp;  public static void createSingleton(String[] args) {</div>
<div>6903&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // modifications by Zerbetto 05-12-2007</div>
<div>6904&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    String fileName = null;</div>
<div>6905&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    boolean showFileMenu = true;</div>
<div>6906&emsp;&emsp;</div>
<div>6907&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if ((args != null) && (args.length > 0)) {</div>
<div>6908&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (String arg : args) {</div>
<div>6909&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (arg.startsWith("file=")) {</div>
<div>6910&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          fileName = arg.substring("file=".length());</div>
<div>6911&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else if (arg.startsWith("showFileMenu=")) {</div>
<div>6912&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          showFileMenu = Boolean.parseBoolean(arg.substring("showFileMenu="</div>
<div>6913&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            .length()));</div>
<div>6914&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6915&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6916&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6917&emsp;&emsp;</div>
<div>6918&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (m_knowledgeFlow == null) {</div>
<div>6919&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_knowledgeFlow = new KnowledgeFlowApp(showFileMenu);</div>
<div>6920&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6921&emsp;&emsp;</div>
<div>6922&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // end modifications by Zerbetto</div>
<div>6923&emsp;&emsp;</div>
<div>6924&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // notify listeners (if any)</div>
<div>6925&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    for (int i = 0; i &#60; s_startupListeners.size(); i++) {</div>
<div>6926&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      s_startupListeners.elementAt(i).startUpComplete();</div>
<div>6927&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6928&emsp;&emsp;</div>
<div>6929&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // modifications by Zerbetto 05-12-2007</div>
<div>6930&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (fileName != null) {</div>
<div>6931&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_knowledgeFlow.loadInitialLayout(fileName);</div>
<div>6932&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6933&emsp;&emsp;</div>
<div>6934&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // end modifications</div>
<div>6935&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6936&emsp;&emsp;</div>
<div>6937&emsp;&emsp;&nbsp;&nbsp;  public static void disposeSingleton() {</div>
<div>6938&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_knowledgeFlow = null;</div>
<div>6939&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6940&emsp;&emsp;</div>
<div>6941&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6942&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Return the singleton instance of the KnowledgeFlow</div>
<div>6943&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6944&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @return the singleton instance</div>
<div>6945&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6946&emsp;&emsp;&nbsp;&nbsp;  public static KnowledgeFlowApp getSingleton() {</div>
<div>6947&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return m_knowledgeFlow;</div>
<div>6948&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6949&emsp;&emsp;</div>
<div>6950&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6951&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Add a listener to be notified when startup is complete</div>
<div>6952&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6953&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param s a listener to add</div>
<div>6954&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6955&emsp;&emsp;&nbsp;&nbsp;  public static void addStartupListener(StartUpListener s) {</div>
<div>6956&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    s_startupListeners.add(s);</div>
<div>6957&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6958&emsp;&emsp;</div>
<div>6959&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>6960&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Loads the specified file at input</div>
<div>6961&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>6962&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Added by Zerbetto</div>
<div>6963&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>6964&emsp;&emsp;&nbsp;&nbsp;  // modifications by Zerbetto 05-12-2007</div>
<div>6965&emsp;&emsp;&nbsp;&nbsp;  private void loadInitialLayout(String fileName) {</div>
<div>6966&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    File oFile = new File(fileName);</div>
<div>6967&emsp;&emsp;</div>
<div>6968&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (oFile.exists() && oFile.isFile()) {</div>
<div>6969&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_FileChooser.setSelectedFile(oFile);</div>
<div>6970&emsp;&emsp;</div>
<div>6971&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      int index = fileName.lastIndexOf('.');</div>
<div>6972&emsp;&emsp;</div>
<div>6973&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (index != -1) {</div>
<div>6974&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        String extension = fileName.substring(index);</div>
<div>6975&emsp;&emsp;</div>
<div>6976&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (FILE_EXTENSION_XML.equalsIgnoreCase(extension)) {</div>
<div>6977&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_FileChooser.setFileFilter(m_knowledgeFlow.m_XMLFilter);</div>
<div>6978&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        } else if (FILE_EXTENSION.equalsIgnoreCase(extension)) {</div>
<div>6979&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          m_FileChooser.setFileFilter(m_knowledgeFlow.m_KfFilter);</div>
<div>6980&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>6981&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6982&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } else {</div>
<div>6983&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      weka.core.logging.Logger.log(weka.core.logging.Logger.Level.WARNING,</div>
<div>6984&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        "[KnowledgeFlow] File '" + fileName</div>
<div>6985&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          + "' does not exists.");</div>
<div>6986&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>6987&emsp;&emsp;</div>
<div>6988&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    loadLayout(oFile, true);</div>
<div>6989&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>6990&emsp;&emsp;</div>
<div>6991&emsp;&emsp;&nbsp;&nbsp;  public void setAllowMultipleTabs(boolean multiple) {</div>
<div>6992&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    m_allowMultipleTabs = multiple;</div>
<div>6993&emsp;&emsp;</div>
<div>6994&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (!multiple) {</div>
<div>6995&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      m_newB.setEnabled(false);</div>
<div>6996&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      if (m_configAndPerspectives != null) {</div>
<div>6997&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        remove(m_configAndPerspectives);</div>
<div>6998&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>6999&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>7000&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>7001&emsp;&emsp;</div>
<div>7002&emsp;&emsp;&nbsp;&nbsp;  public boolean getAllowMultipleTabs() {</div>
<div>7003&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    return m_allowMultipleTabs;</div>
<div>7004&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>7005&emsp;&emsp;</div>
<div>7006&emsp;&emsp;&nbsp;&nbsp;  // end modifications</div>
<div>7007&emsp;&emsp;</div>
<div>7008&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>7009&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Notifies to the parent swt that the layout is dirty</div>
<div>7010&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>7011&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Added by Zerbetto</div>
<div>7012&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>7013&emsp;&emsp;&nbsp;&nbsp;  private void notifyIsDirty() {</div>
<div>7014&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // this.firePropertyChange(new Integer(IEditorPart.PROP_DIRTY).toString(),</div>
<div>7015&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    // null, null);</div>
<div>7016&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    this.firePropertyChange("PROP_DIRTY", null, null);</div>
<div>7017&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>7018&emsp;&emsp;</div>
<div>7019&emsp;&emsp;&nbsp;&nbsp;  /**</div>
<div>7020&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * Main method.</div>
<div>7021&emsp;&emsp;&nbsp;&nbsp;&nbsp;   *</div>
<div>7022&emsp;&emsp;&nbsp;&nbsp;&nbsp;   * @param args a &#60;code>String[]&#60;/code> value</div>
<div>7023&emsp;&emsp;&nbsp;&nbsp;&nbsp;   */</div>
<div>7024&emsp;&emsp;&nbsp;&nbsp;  public static void main(String[] args) {</div>
<div>7025&emsp;&emsp;</div>
<div>7026&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    LookAndFeel.setLookAndFeel();</div>
<div>7027&emsp;&emsp;</div>
<div>7028&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    try {</div>
<div>7029&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // uncomment to disable the memory management:</div>
<div>7030&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_Memory.setEnabled(false);</div>
<div>7031&emsp;&emsp;</div>
<div>7032&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      final javax.swing.JFrame jf = new javax.swing.JFrame();</div>
<div>7033&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.getContentPane().setLayout(new java.awt.BorderLayout());</div>
<div>7034&emsp;&emsp;</div>
<div>7035&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // final KnowledgeFlowApp tm = new KnowledgeFlowApp();</div>
<div>7036&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      // m_knowledgeFlow = new KnowledgeFlowApp(true);</div>
<div>7037&emsp;&emsp;</div>
<div>7038&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      for (int i = 0; i &#60; args.length; i++) {</div>
<div>7039&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        if (args[i].toLowerCase().endsWith(".kf")</div>
<div>7040&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          || args[i].toLowerCase().endsWith(".kfml")) {</div>
<div>7041&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          args[i] = "file=" + args[i];</div>
<div>7042&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>7043&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      }</div>
<div>7044&emsp;&emsp;</div>
<div>7045&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      KnowledgeFlowApp.createSingleton(args);</div>
<div>7046&emsp;&emsp;</div>
<div>7047&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Image icon = Toolkit.getDefaultToolkit().getImage(</div>
<div>7048&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        m_knowledgeFlow.getClass().getClassLoader()</div>
<div>7049&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          .getResource("weka/gui/weka_icon_new_48.png"));</div>
<div>7050&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.setIconImage(icon);</div>
<div>7051&emsp;&emsp;</div>
<div>7052&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.getContentPane().add(m_knowledgeFlow, java.awt.BorderLayout.CENTER);</div>
<div>7053&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</div>
<div>7054&emsp;&emsp;</div>
<div>7055&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.setSize(1024, 768);</div>
<div>7056&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      jf.setVisible(true);</div>
<div>7057&emsp;&emsp;</div>
<div>7058&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Thread memMonitor = new Thread() {</div>
<div>7059&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @SuppressWarnings("static-access")</div>
<div>7060&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        @Override</div>
<div>7061&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        public void run() {</div>
<div>7062&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          while (true) {</div>
<div>7063&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // try {</div>
<div>7064&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // System.out.println("Before sleeping");</div>
<div>7065&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // this.sleep(10);</div>
<div>7066&emsp;&emsp;</div>
<div>7067&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            if (m_Memory.isOutOfMemory()) {</div>
<div>7068&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // clean up</div>
<div>7069&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              jf.dispose();</div>
<div>7070&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_knowledgeFlow = null;</div>
<div>7071&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              System.gc();</div>
<div>7072&emsp;&emsp;</div>
<div>7073&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              // display error</div>
<div>7074&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              System.err.println("\n[KnowledgeFlow] displayed message:");</div>
<div>7075&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              m_Memory.showOutOfMemory();</div>
<div>7076&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              System.err.println("\nexiting");</div>
<div>7077&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              System.exit(-1);</div>
<div>7078&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            }</div>
<div>7079&emsp;&emsp;</div>
<div>7080&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // } catch (InterruptedException ex) {</div>
<div>7081&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // ex.printStackTrace();</div>
<div>7082&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;            // }</div>
<div>7083&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          }</div>
<div>7084&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;        }</div>
<div>7085&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      };</div>
<div>7086&emsp;&emsp;</div>
<div>7087&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      memMonitor.setPriority(Thread.NORM_PRIORITY);</div>
<div>7088&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      memMonitor.start();</div>
<div>7089&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    } catch (Exception ex) {</div>
<div>7090&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      ex.printStackTrace();</div>
<div>7091&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      System.err.println(ex.getMessage());</div>
<div>7092&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;    }</div>
<div>7093&emsp;&emsp;&nbsp;&nbsp;  }</div>
<div>7094&emsp;&emsp;}</div>
</div>
</div>
</body>
</html>